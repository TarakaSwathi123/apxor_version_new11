!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("apxor")):"function"==typeof define&&define.amd?define(["apxor"],t):(e=e||self)["apxor-qe"]=t(e.Apxor)}(this,(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function n(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,l(i.key),i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var d=window.ApxorLogger,c=function(e){return void 0!==e&&!function(e){return null===e}(e)},v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function f(e,t){return Array.from(t).map((function(t,n){return String.fromCharCode(t^function(e,t){return e.charCodeAt(Math.floor(t%e.length))}(e,n))})).join("")}var g=function(e,t){return f(e,t=function(e){var t,n,i,r,o,a,s=0,_=[];if(!e)return e;e+="";do{t=(a=v.indexOf(e.charAt(s++))<<18|v.indexOf(e.charAt(s++))<<12|(r=v.indexOf(e.charAt(s++)))<<6|(o=v.indexOf(e.charAt(s++))))>>16&255,n=a>>8&255,i=255&a,_.push(t),64!==r&&(_.push(n),64!==o&&_.push(i))}while(s<e.length);return _}(t))},p=function(e){switch(e){case"app_event":return"AE";case"client_event":return"CE";case"activity_time":case"activity_event":return"AE"}return"Unknown"},h=function(e){return e.toUpperCase()},m=function(e,t,n){switch(n){case"EQ":return e===t;case"GT":return e>t;case"GTE":return e>=t;case"LT":return e<t;case"LTE":return e<=t;case"NEQ":return e!==t;case"R":return y(t).test(e);default:return!1}},y=function(e){var t=e.replace(/.*\/([gimuy]*)$/,"$1");t===e&&(t="");var n=t?e.replace(new RegExp("^/(.*?)/"+t+"$"),"$1"):e;return new RegExp(n,t)},b=function(){var e=new Date;return e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear()},E=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e||!t||!n)return!1;var r=n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),o=t.replace(new RegExp(r,"g"),"(.+)"),a=i?"^".concat(o):"".concat(o,"$"),s=new RegExp(a);return s.test(e)};function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,o=A(e,t);if(o){var a=function(){if(C(o)){return function(e){return T(e)}(o)}return d.info("Invalid target element. Width and height are 0 for element: ".concat(e,". Can't show tooltip")),!1};return a()}return n?(d.info("Not found yet. Rechecking the DOM."),S(r,i,e,t)):(d.info("Element with selector:".concat(e," not found.")),!1)}function S(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=setInterval((function(){var t=A(n,i);if(t){clearInterval(r);!function(){if(C()){T()}else d.info("Invalid target element. Width and height are 0 for element: ".concat(n,". Can't show tooltip"))}()}else(e-=1)<=0&&(clearInterval(r),console.warn("Element with selector:".concat(n," not found.")))}),t)}var A=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=document.getElementById(e);if(!i)try{i=document.querySelector(e)}catch(e){window.ApxorLogger.error("Error finding element in DOM:"+e)}(i||(i=x(e)),!i&&n.length>0)&&(i=null===(t=document.getElementById(n))||void 0===t||null===(t=t.contentWindow)||void 0===t||null===(t=t.document)||void 0===t?void 0:t.querySelector(e));return i},x=function(e){var t=e.indexOf("svg");-1!==t&&(e=e.substring(0,t)+"svg:svg");try{return document.evaluate(e,document,(function(e){return"svg"===e?"http://www.w3.org/2000/svg":null}),XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(e){window.ApxorLogger.error("Error finding element in DOM:"+e)}return null};function C(e){try{var t=e.getBoundingClientRect();if(0===t.width||0===t.height)return!1}catch(e){return!1}return!0}function T(e){var t,n,i,r;return!!(n=(t=e).offsetHeight,i=t.offsetWidth,(r=t.getBoundingClientRect()).left>=-i&&r.top>=-n&&r.right<=(window.innerWidth||document.documentElement.clientWidth)+i&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)+n)}var L=function(e){var t='\n        <style> \n          .apx-container{\n            padding:10px;\n          }\n        </style>\n        <div id="apx-innerElement" class="apx-container">\n              <div id="close-button" style="cursor: pointer;position:absolute;top:9px;right:9px;"><svg width="11" height="11" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path opacity="0.5" d="M11.0962 9.07071L17.8586 15.8331L15.8331 17.8586L9.0707 11.0962L8.99999 11.0255L8.92928 11.0962L2.16693 17.8586L0.141421 15.8331L6.90379 9.07071L6.9745 9L6.90379 8.92929L0.141421 2.16694L2.16693 0.141422L8.92928 6.9038L8.99999 6.97451L9.0707 6.9038L15.8331 0.141422L17.8586 2.16694L11.0962 8.92929L11.0255 9L11.0962 9.07071Z" fill="white" stroke="#002845" stroke-width="0.2"/>\n                </svg>\n              </div>\n              <div style="font-family: inherit;font-style: normal;font-weight: 600;font-size: 16px;line-height: 22px;\n              color: #FFFFFF; display: flex; gap: 12px;"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-check-filled" width="33" height="33" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">\n  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n  <path d="M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z" stroke-width="0" fill="currentColor" />\n</svg><div style = "align-self: center;padding-right:20px;">'.concat(e,"</div></div>\n        </div>\n      "),n=document.createElement("div");n.style="\n        z-index:99999999;\n        background:#16202f;\n        position:fixed;\n        top:1%;\n        right:1%;\n        border-radius: 12px;\n      ",n.innerHTML=t,n.id="apx-container",document.body.appendChild(n)},I=window.ApxorLogger,O=a((function t(){var n=this;r(this,t),s(this,"_type","ALL"),s(this,"_userAttributes",[]),s(this,"_sessionAttributes",[]),s(this,"userAttributesValidated",!0),s(this,"sessionAttributeValidated",!0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(n._type=e.audience.audience_type,n._userAttributes=e.audience.attributes.user,n._sessionAttributes=e.audience.attributes.session,!Array.isArray(n._userAttributes)||!Array.isArray(n._sessionAttributes))return I.error("No attributes"),!1}catch(e){return I.error(e),!1}return!0})),s(this,"validate",(function(t,i){var r=!0;"FTU"===n._type&&(r=e.getController().getSessionInfo().is_first_session);var o=n._compareAttributes(t,n._userAttributes),a=n._compareAttributes(i,n._sessionAttributes);return o||(n.userAttributesValidated=!1),a||(n.sessionAttributeValidated=!1),r&&o&&a})),s(this,"_compareAttributes",(function(e,t){var n=t.length,i=!0;try{for(var r,o=function(){var n=t[a];if(void 0===e[n.name]||!1===i)return{v:!1};var r=n.operator,o=n.type,s=n.value.map((function(e){if("s"===o)return e;if("l"===o)return parseInt(e);if("f"===o)return parseFloat(e);if("b"===o)switch(e){case"true":return!0;case"false":return!1;default:return e}})),_=(Array.isArray(e[n.name])?e[n.name]:[e[n.name]]).some((function(e){return s.some((function(t){return"s"===o?e="".concat(e):"l"===o?e=parseInt(e):"f"===o?e=parseFloat(e):"b"===o&&(e=!!e),m(e,t,r)}))}));i=i&&_},a=0;a<n;a++)if(r=o())return r.v}catch(e){I.error(e),i=!1}return i}))})),F=window.ApxorLogger,D=a((function t(){var n=this;r(this,t),s(this,"_count",0),s(this,"_timeInterval",0),s(this,"_validity","SESSION"),s(this,"_shownCount",0),s(this,"_sessionCount",0),s(this,"_originalCount",0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{n._uuid=e._id,n._meta=e.meta,n._count=e.frequency.count,-1===n._count&&(n._count=1e3),n._originalCount=n._count,n._timeInterval=e.frequency.time_interval,n._validity=e.frequency.validity,n._sessionCount=e.frequency.ses_lmt,n._dayCount=e.frequency.day_lmt;var t=re.getInstance().getQeState();if(!c(t)||!c(t[e._id]))return!0;if("SESSION"===n._validity){if(n._count=parseInt(n._count)-parseInt(t[e._id].SESSION),n._count<=0)return n.logNonEligibleUserEvent("Session limit reached"),console.warn("Max count limit reached for session:"+e._id),!1}else{if("OVERALL"!==n._validity)return F.info("Invalid config."),!1;if(n._count=parseInt(n._count)-parseInt(t[e._id].OVERALL),n._count<=0)return n.logNonEligibleUserEvent("Overall limit reached"),console.warn("Max count limit reached for overall:"+e._id),!1}}catch(e){return F.error(e),!1}return!0})),s(this,"decrementCampaignCount",(function(){n._count=n._count-1})),s(this,"getFrequencyCount",(function(){return n._count})),s(this,"resetCampaignCount",(function(){"SESSION"===n._validity&&(n._count=n._originalCount,F.info("Campaign Limit reset"))})),s(this,"isFrequencyWithInLimits",(function(e){try{if(n._count<=0)return"OVERALL"===n._validity?n.logNonEligibleUserEvent("Overall limit reached"):"SESSION"===n._validity&&n.logNonEligibleUserEvent("Session limit reached"),!1;var t=re.getInstance().getQeState();if(!c(t)||!c(t[e]))return!0;if(0!==n._sessionCount)if(parseInt(n._sessionCount)-parseInt(t[e].SESSION)<=0)return n.logNonEligibleUserEvent("Session limit reached"),!1;if(0!==n._dayCount){var i,r=b();if(parseInt(n._dayCount)-parseInt((null===(i=t[e])||void 0===i?void 0:i.DATES[r])||0)<=0)return n.logNonEligibleUserEvent("Day limit reached"),!1}}catch(e){n.logNonEligibleUserEvent("Error validating the frequency: ".concat(e)),F.error("Error validating the frequency:"+e)}return!0})),s(this,"logNonEligibleUserEvent",(function(t){var i;null==e||e.logEvent("apx_non_eligible_user",{apx_nudge_type:"SURVEY"===n._meta.type?"survey":"campaign",apx_nudge_id:n._uuid,apx_nudge_name:n._meta.name,apx_variant_code:n._meta.isExperiment||n._meta.only_context?null===(i=n._meta.attr)||void 0===i?void 0:i.apx_variant_code:"TG",apx_failure_type:"warn",apx_reason:t})}))})),N=a((function e(){var t=this;r(this,e),s(this,"_name",""),s(this,"_type",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n,i;t._name=e.meta.name,t._type=e.meta.type,t._only_context=e.meta.only_context,t._attr=(null===(n=e.meta)||void 0===n?void 0:n.attr)||{},t._isExperiment=null===(i=e.meta)||void 0===i?void 0:i.isExperiment}catch(e){return window.ApxorLogger.error(e),!1}return!0}))})),q=window.ApxorLogger,k=a((function e(){var t=this;r(this,e),s(this,"_startDate",-1),s(this,"_endDate",-1),s(this,"_startTime",-1),s(this,"_endTime",-1),s(this,"_timeLimits",!1),s(this,"_nudge_expired",!1),s(this,"_not_yet_active",!1),s(this,"_not_in_specified_time",!1),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(isNaN(Date.parse(e.validity.start_date))||isNaN(Date.parse(e.validity.end_date)))return q.error("Not valid dates"),!1;if(t._startDate=Date.parse(e.validity.start_date),t._endDate=Date.parse(e.validity.end_date),c(e.at_specific_time)&&(t._timeLimits=e.at_specific_time,t._timeLimits&&c(e.time_limits))){var n=(new Date).toISOString().split("T")[0];if(t._startTime=Date.parse(n+"T"+e.time_limits.start_time+":00.000Z"),t._endTime=Date.parse(n+"T"+e.time_limits.end_time+":00.000Z"),isNaN(t._startTime)||isNaN(t._endTime))return q.error("Not valid times"),!1}}catch(e){return q.error(e),!1}return!0})),s(this,"validate",(function(){var e=Date.now();return e>t._startDate&&e<t._endDate?(!t._timeLimits||e>=t._startTime&&e<=t._endTime||(t._not_in_specified_time=!0),!t._timeLimits||e>=t._startTime&&e<=t._endTime):(e<t._startDate?t._not_yet_active=!0:e>t._endDate&&(t._nudge_expired=!0),!1)}))})),R=a((function e(){var t=this;r(this,e),s(this,"_name",""),s(this,"_additionalInfo",{}),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{t._name=e.name,t._additionalInfo=e.additional_info}catch(e){return!1}return!0}))})),V=a((function e(){var t=this;r(this,e),s(this,"_lower",0),s(this,"_upper",0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(t._lower=Number(e.lower),t._upper=Number(e.upper),isNaN(t._lower)||isNaN(t._upper))return!1}catch(e){return!1}return!0}))})),U=a((function e(){var t=this;r(this,e),s(this,"_occurredTime",0),s(this,"_eventType",""),s(this,"_navigation",""),s(this,"_details",new R),s(this,"_timeBounds",new V),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return t._eventType=e.event_type,t._navigation=e.activity,t._details.parse(e.details)&&t._timeBounds.parse(e.time_bounds)}catch(e){return!1}}))})),B=window.ApxorLogger,P=a((function e(){var t=this;r(this,e),s(this,"_occurredTime",0),s(this,"_sequence",-1),s(this,"_count",0),s(this,"_countOperator",""),s(this,"_navigation",""),s(this,"_eventType",""),s(this,"_timeBounds",new V),s(this,"_details",new R),s(this,"_precondition",new U),s(this,"_combineOperator","AND"),s(this,"_canCheckOldData",!1),s(this,"_type",void 0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return t._sequence=e.sequence,t._count=e.count_config.count,t._countOperator=e.count_config.operator,t._navigation=e.activity,t._eventType=e.event_type,t._combineOperator=e.combine_operator,t._type=e.type,t._details.parse(e.details)&&t._precondition.parse(e.trigger)&&t._timeBounds.parse(e.time_bounds)}catch(e){return B.error(e),!1}}))})),j=window.ApxorLogger,M=a((function e(){var t=this;r(this,e),s(this,"_count",0),s(this,"_countOperator",""),s(this,"_eventType",""),s(this,"_timeBounds",new V),s(this,"_details",new R),s(this,"_combineOperator","AND"),s(this,"parse",(function(e){try{return t._count=e.count_config.count,t._countOperator=e.count_config.operator,t._eventType=e.event_type,t._combineOperator=e.combine_operator,t._details.parse(e.details)&&t._timeBounds.parse(e.time_bounds)}catch(e){return j.error(e),!1}}))})),G=window.ApxorLogger,Q=function(){function t(){var n=this;r(this,t),s(this,"_satisfiedCount",0),s(this,"_uuid",""),s(this,"_condition",new P),s(this,"_goalevent",new M),s(this,"_triggered",!1),s(this,"_isSatisfied",!1),s(this,"_index",0),s(this,"_combineOperator","AND"),s(this,"_conbineOperatorForGoalEvent","OR"),s(this,"_oldEventCount",-1),s(this,"_kpi",[]),s(this,"_eventTimes",{}),s(this,"_receivedEventForKpi",!1),s(this,"initialize",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";if(n._uuid=i,n._index=r,n._kpi=a,"termination"===s&&""!==s){n._goalevent.parse(t);return n._conbineOperatorForGoalEvent=n._goalevent._combineOperator,n.registerForTermination(),!0}var _=n._condition.parse(t);if(_){if(n._combineOperator=n._condition._combineOperator,n._condition._canCheckOldData){var u=n._condition._details._name;"APX_PAGE_OPENED"===u&&(u=n._condition._details._additionalInfo.navigation_id,u=c(u)?u:n._condition._details._name),n._oldEventCount=e.getController().getEventCount(u);var l=n._condition._count,d=n._condition._countOperator;if(n._isSatisfied=n._compare(n._oldEventCount-1,l,d,!1),n._triggered=n._isSatisfied,n._isSatisfied&&"APX_PAGE_OPENED"===n._condition._details._name)return!0}return o&&0!==r||n.register(),!0}return!1})),s(this,"register",(function(){var e,t=n._condition,i=t._precondition,r=re.getInstance();"app_start"===i._eventType?(n._triggered=!0,r.registerForEvent(p(t._eventType)+"___"+t._details._name,n._onReceiveEvent)):r.registerForEvent(p(t._eventType)+"___"+i._details._name,n._onReceiveEvent),null!==(e=window.ApxorRTM)&&void 0!==e&&e.badgesLists.includes(n._uuid)&&r.registerForEvent(p(t._eventType)+"___"+"apxor-badge-container-".concat("-".concat(n._uuid).replaceAll(" ","").replace(/[^\w\s]/gi,"")),n._onReceiveEvent)})),s(this,"registerForTermination",(function(){var e=n._goalevent,t=re.getInstance();n._triggered=!0,t.registerForEvent(p(e._eventType)+"___"+e._details._name,n._onReceiveEventForTermination)})),s(this,"_onReceiveEventForKpiForSameEvent",(function(e,t,i,r){var o,a=(Date.now()-n._eventTimes[t])/1e3;(null===(o=n._condition)||void 0===o||null===(o=o._details)||void 0===o||null===(o=o._additionalInfo)||void 0===o?void 0:o.time)/1e3>a&&n._displayCampaign(i)})),s(this,"_onReceiveEventForKpi",(function(e,t,i,r){var o,a;n._receivedEventForKpi=!0;var s=Date.now(),_=null===(o=n._condition)||void 0===o||null===(o=o._precondition)||void 0===o?void 0:o._details._name,u=(s-n._eventTimes[_])/1e3,l=null===(a=n._condition)||void 0===a||null===(a=a._details)||void 0===a||null===(a=a._additionalInfo)||void 0===a?void 0:a.time;(l/=1e3)>u&&n._displayCampaign(i)})),s(this,"_onReceiveEvent",(function(t,i,r,o){var a,s,_=re.getInstance();if(n._triggered){if(null!==(a=window.ApxorRTM)&&void 0!==a&&a.isBadgePresent&&null!==(s=window.ApxorRTM)&&void 0!==s&&s.badgesLists.includes(n._uuid)&&e.getController().isBadgeTriggerSatisfied(n._uuid))return n._isSatisfied=!0,n._condition._occurredTime=r,void _.validate(n._uuid,n._index);p(n._condition._eventType)===t&&n._validateTimeBounds(r-n._condition._precondition._occurredTime,n._condition._timeBounds)&&n._condition._details._name===i&&n._compareAdditionalInfo(n._condition._details._additionalInfo,o)&&(n._satisfiedCount+=1,n._isSatisfied=n._compare(n._satisfiedCount,n._condition._count,n._condition._countOperator),n._isSatisfied&&(n._condition._occurredTime=r,_.validate(n._uuid,n._index)))}else if(n._triggered=n._validatePrecondition(t,i,r,o),n._triggered){var u=n._condition,l=u._precondition;if(l._occurredTime=r,"activity_time"===(null==u?void 0:u._eventType)){var d,c,v,f=null==u||null===(d=u._details)||void 0===d||null===(d=d._additionalInfo)||void 0===d?void 0:d.time;(null==u||null===(c=u._details)||void 0===c||null===(c=c._additionalInfo)||void 0===c?void 0:c.nkpi.length)>0&&(setTimeout((function(){n._receivedEventForKpi||(n._isSatisfied=!0,n._isSatisfied&&(n._satisfiedCount+=1,n._isSatisfied=n._compare(n._satisfiedCount,n._condition._count,n._condition._countOperator),n._isSatisfied&&(n._condition._occurredTime=r,_.validate(n._uuid,n._index)))),u._details._additionalInfo.nkpi.map((function(e){_.unregisterFromEvent(h(u._details._additionalInfo.et)+"___"+e,n)}))}),f),u._details._additionalInfo.nkpi.map((function(e){_.registerForEvent(h(u._details._additionalInfo.et)+"___"+e,n._onReceiveEventForKpi)}))),(null==u||null===(v=u._details)||void 0===v||null===(v=v._additionalInfo)||void 0===v?void 0:v.kpi.length)>0&&(setTimeout((function(){u._details._additionalInfo.kpi.map((function(e){_.unregisterFromEvent(h(u._details._additionalInfo.et)+"___"+e,n)}))}),f),u._details._additionalInfo.kpi.map((function(e){e===u._precondition._details._name?(_.unregisterFromEvent(p(l._eventType)+"___"+l._details._name,n),_.registerForEvent(h(u._details._additionalInfo.et)+"___"+e,n._onReceiveEventForKpiForSameEvent)):_.registerForEvent(h(u._details._additionalInfo.et)+"___"+e,n._onReceiveEventForKpi)})))}else _.unregisterFromEvent(p(l._eventType)+"___"+l._details._name,n),_.registerForEvent(p(u._eventType)+"___"+u._details._name,n);n._eventTimes[i]=Date.now()}})),s(this,"_onReceiveEventForTermination",(function(e,t,i,r){var o=re.getInstance();p(n._goalevent._eventType)===e&&n._validateTimeBounds(i,n._goalevent._timeBounds)&&n._goalevent._details._name===t&&n._compareAdditionalInfo(n._goalevent._details._additionalInfo,r)&&(n._satisfiedCount+=1,n._isSatisfied=n._compare(n._satisfiedCount,n._goalevent._count,n._goalevent._countOperator),n._isSatisfied&&(n._goalevent._occurredTime=i,o.validateForTermination(n._uuid,n._index)))})),s(this,"_validatePrecondition",(function(e,t,i,r){var o=n._condition._precondition;return p(o._eventType)===e&&o._details._name===t&&n._validateTimeBounds(i,o._timeBounds)&&n._compareAdditionalInfo(o._details._additionalInfo,r)})),s(this,"_validateTimeBounds",(function(e,t){var n=Math.ceil(e);return n>t._lower&&n<t._upper})),s(this,"_compare",(function(e,t,i){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];switch(r&&n._condition._canCheckOldData&&(e+=n._oldEventCount),i){case"EQ":return e===t;case"GT":return e>t;case"GTE":return e>=t;case"LT":return e<t;case"LTE":return e<=t;default:return!1}})),s(this,"_compareAdditionalInfo",(function(e,t){var n=!0;try{var r,o=function(){if(!1===n)return{v:!1};if("object"===i(e[a])){var r,o=e[a].op,s=e[a].t;if("s"===s)r=e[a].val;else if("l"===s||"f"===s)r=parseFloat(e[a].val);else if("b"===s)switch(e[a].val){case"true":r=!0;break;case"false":r=!1;break;default:r=e[a].val}var _=(Array.isArray(t[a])?t[a]:[t[a]]).some((function(e){return"s"===s?e="".concat(e):"l"===s?e=parseInt(e):"f"===s?e=parseFloat(e):"b"===s&&(e=!!e),m(e,r,o)}));n=n&&_}else n=n&&m(t[a],e[a],"EQ")};for(var a in e)if(r=o())return r.v}catch(e){G.error(e),n=!1}return n}))}return a(t,[{key:"_displayCampaign",value:function(e){var t=re.getInstance();this._isSatisfied=!0,this._isSatisfied&&(this._satisfiedCount+=1,this._isSatisfied=this._compare(this._satisfiedCount,this._condition._count,this._condition._countOperator),this._isSatisfied&&(this._condition._occurredTime=e,t.validate(this._uuid,this._index)))}}]),t}(),z=window.ApxorLogger,K=a((function t(){var n=this;r(this,t),s(this,"_events",[]),s(this,"_ret_day",{}),s(this,"_session",{}),s(this,"_toggleRetDay",!1),s(this,"_toggleSession",!1),s(this,"retainedDaysValidated",!0),s(this,"retainedSessionValidated",!0),s(this,"eventDoneInLT",!1),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{n._events=e.overall_cfg.events,n._ret_day=e.overall_cfg.ret_day,n._session=e.overall_cfg.session,n._toggleRetDay=e.overall_cfg.toggleRetDay,n._toggleSession=e.overall_cfg.toggleSession}catch(e){return z.error(e),!1}return!0})),s(this,"validate",(function(){var t=parseInt(e.getController().getFromStorage("apx_retained_days")),i=parseInt(e.getController().getFromStorage("apx_retained_session"));if(n._toggleRetDay&&!isNaN(t)&&!(t>=n._ret_day.from&&t<=n._ret_day.to))return n.retainedDaysValidated=!1,!1;if(n._toggleSession&&!isNaN(i)&&!(i>=n._session.from&&i<=n._session.to))return n.retainedSessionValidated=!1,!1;try{for(var r=e.getController().getFromStorage("_apx_lt_count"),o=e.getSiteId(),a=JSON.parse((new TextDecoder).decode(function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return t}(g(o,r)))),s=0;s<n._events.length;s++){if(a[n._events[s].name.replace("'","").replace("’","")])return n.eventDoneInLT=!0,!1}}catch(e){z.error("Failed to validate the lt count:"+e)}return!0}))})),W=window.ApxorLogger,Y=a((function e(){var t=this;r(this,e),s(this,"_userAttributes",[]),s(this,"_sessionAttributes",[]),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(t._userAttributes=e.attributes.user,t._sessionAttributes=e.attributes.session,!Array.isArray(t._userAttributes)||!Array.isArray(t._sessionAttributes))return W.error("No attributes"),!1}catch(e){return W.error(e),!1}return!0})),s(this,"validate",(function(e,n){return t._compareAttributes(e,t._userAttributes)&&t._compareAttributes(n,t._sessionAttributes)})),s(this,"_compareAttributes",(function(e,t){var n=t.length,i=!0;try{for(var r,o=function(){var n=t[a];if(!e[n.name]||!1===i)return{v:!1};var r=n.operator,o=n.type,s=n.value.map((function(e){return"s"===o?e:"l"===o?parseInt(e):"f"===o?parseFloat(e):void 0})),_=(Array.isArray(e[n.name])?e[n.name]:[e[n.name]]).some((function(e){return s.some((function(t){return m(e,t,r)}))}));i=i&&_},a=0;a<n;a++)if(r=o())return r.v}catch(e){W.error(e),i=!1}return i}))})),$=a((function t(){var n=this;r(this,t),s(this,"_controller",e.getController()),s(this,"type",""),s(this,"_duration_seconds",0),s(this,"_days",1),s(this,"parse",(function(e){try{var t,i,r;if(n._type=null===(t=e.terminate_info.time_based)||void 0===t?void 0:t.type,n._duration_seconds=null===(i=e.terminate_info)||void 0===i?void 0:i.time_based.duration_seconds,n._days=null===(r=e.terminate_info.time_based)||void 0===r?void 0:r.days,n.compare(e._id))return n._controller.persistTerminationInfoLocally(e._id),!1}catch(e){return!1}return!0})),s(this,"compare",(function(e){var t,i=JSON.parse(n._controller.getFromStorage("apx_termination_ID"));if(!i[e]||null===(t=i[e])||void 0===t||!t.startDate)return!1;var r,o=new Date(i[e].startDate),a=new Date((r=new Date).getMonth()+"/"+r.getDate()+"/"+r.getFullYear()),s=parseInt((a-o)/864e5,10),_=function(){var e=new Date;return{hours:e.getHours(),mins:e.getMinutes()}}(),u=i[e]._startTime;return s===n._days&&_.hours>=u.hours||s>n._days||i[e].goalAcheived}))})),H=a((function e(){var t=this;r(this,e),s(this,"enable_goal_events",!1),s(this,"attributes",{}),s(this,"_attributes",new Y),s(this,"_timebasedtermination",new $),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n,i,r;if(t.enable_time_based=null==e||null===(n=e.terminate_info)||void 0===n?void 0:n.enable_time_based,t.enable_time_based&&!t._timebasedtermination.parse(e))return!1;if(t.enable_goal_events=null==e||null===(i=e.terminate_info)||void 0===i?void 0:i.enable_goal_events,t.enable_attributes=null==e||null===(r=e.terminate_info)||void 0===r?void 0:r.enable_attributes,t.enable_attributes&&!t._attributes.parse(e.terminate_info))return!1}catch(e){return window.ApxorLogger.error(e),!1}return!0})),s(this,"validate",(function(e,n){return t._attributes.validate(e,n)}))})),J=a((function e(){var t=this;r(this,e),s(this,"_enableScreenBinding",""),s(this,"_bindingUrl",""),s(this,"_bindingVar",""),s(this,"_bindingOperator",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return t._enableScreenBinding=null==e?void 0:e.screen_binding,!t._enableScreenBinding||(t._bindingUrl=null==e?void 0:e.binding.url,t._bindingVar=null==e?void 0:e.binding.var,t._bindingOperator=null==e?void 0:e.binding.operator,!0)}catch(e){return window.ApxorLogger.error(e),!1}})),s(this,"validate",(function(){var e=t._bindingUrl,n=t._bindingVar,i=t._bindingOperator,r=window.location.href;return!t._enableScreenBinding||("EQ"===i?e.includes(n)?!!E(r,e,n,!1):r===e:"SW"===i?e.includes(n)?!!E(r,e,n,!0):!!r.startsWith(e):void 0)}))})),X=window.ApxorLogger,Z=a((function t(){var i=this;r(this,t),s(this,"_conditionValidators",[]),s(this,"_terminationGoalEventValidators",[]),s(this,"_uuid",""),s(this,"_meta",new N),s(this,"_audience",new O),s(this,"_validity",new k),s(this,"_frequency",new D),s(this,"_overallconfig",new K),s(this,"_terminationconfig",new H),s(this,"_screenbinding",new J),s(this,"_respectSequence",!1),s(this,"_noKpiArray",[]),s(this,"_variant_code",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t;if(!c(e._id))return X.error("No Id"),!1;if(!c(e.enabled)||!e.enabled)return X.error("Not enabled"),!1;if(!(i._meta.parse(e)&&i._validity.parse(e)&&i._frequency.parse(e)&&i._audience.parse(e)&&i._overallconfig.parse(e)&&i._terminationconfig.parse(e)&&i._screenbinding.parse(e)))return!1;if(i._variant_code=i._meta._isExperiment||i._meta._only_context?null===(t=i._meta._attr)||void 0===t?void 0:t.apx_variant_code:"TG",!c(e.conditions)||!Array.isArray(e.conditions))return X.error("No valid conditions",e.conditions),!1;i._uuid=e._id,i._respectSequence=!!c(e.sequence_enabled)&&e.sequence_enabled,i._respectSequence&&e.conditions.sort((function(e,t){return e.sequence<t.sequence}));var n=e.conditions,r=n.length,o=null==e?void 0:e.no_context_enabled;0===r&&o&&i._validateAllConditions();for(var a=function(){i._noKpiArray=[];var e=n[s];if("didn't"===e.type){var t,r={trigger_key:e.trigger.details.name,no_kpi_array:null==e||null===(t=e.details)||void 0===t||null===(t=t.additional_info)||void 0===t?void 0:t.nkpi,condition_id:null==e?void 0:e._id,time_bounds:e.time_bounds.upper};i._noKpiArray=[].concat(_(i._noKpiArray),[r])}var o=new Q;if(o.initialize(e,i._uuid,s,i._respectSequence,i._noKpiArray)){i._conditionValidators.push(o);var a=(null==e?void 0:e.timeout)/(null==e?void 0:e.findinterval),u=(null==e?void 0:e.frameid)||"",l=null==e?void 0:e.url;window.location.href===l&&"view_visibility"===e.event_type&&!0===w(e.view_id,u,null==e?void 0:e.enable_retry,null==e?void 0:e.findinterval,a)&&i._validateAllConditions(!0),window.addEventListener("navigate",(function(t){var n=null==e?void 0:e.url;window.location.href===n&&"view_visibility"===e.event_type&&!0===w(e.view_id,u,null==e?void 0:e.enable_retry,null==e?void 0:e.findinterval,a)&&i._validateAllConditions(!0)}))}},s=0;s<r;s++)a();if(i._terminationconfig.enable_goal_events)for(var u=e.terminate_info.goal_events.events,l=u.length,d=0;d<l;d++){var v=new Q;v.initialize(u[d],i._uuid,d,!0,[],"termination")&&i._terminationGoalEventValidators.push(v)}return i._conditionValidators.length>0}catch(e){return X.error(e),!1}})),s(this,"evaluate",(function(e){if(!(e<0))if(i._respectSequence){var t=i._conditionValidators[e];if(c(t)&&t._isSatisfied){var n=i._conditionValidators[e-1];if(c(n)&&!n._isSatisfied)return;var r=i._conditionValidators[e+1];c(r)?r.register():i._validateAllConditions()}}else i._validateAllConditions()})),s(this,"terminationEvaluate",(function(e){e<0||i._validateAllGoalEvents()})),s(this,"_validateAllConditions",(function(){var t,r,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.getController().getUserAttributes(),s=e.getController().getSessionAttributes();if(null!==(t=window.ApxorRTM)&&void 0!==t&&t.isBadgePresent&&null!==(r=window.ApxorRTM)&&void 0!==r&&r.badgesLists.includes(i._uuid)&&e.getController().isBadgeTriggerSatisfied(i._uuid)||null==e||e.logEvent("apx_trigger_satisfied",{apx_nudge_type:"SURVEY"===i._meta._type?"survey":"campaign",apx_nudge_id:i._uuid,apx_nudge_name:i._meta._name,apx_variant_code:i._meta._isExperiment||i._meta._only_context?i._meta._attr.apx_variant_code:"TG"}),!(i._validity.validate()&&i._audience.validate(a,s)&&i._overallconfig.validate()&&i._screenbinding.validate()))return i._overallconfig.retainedDaysValidated?i._overallconfig.retainedSessionValidated?i._overallconfig.eventDoneInLT?void i.logNonEligibleUserEvent("Event done in life time"):i._audience.userAttributesValidated?i._audience.sessionAttributeValidated?i._validity._not_in_specified_time?void i.logNonEligibleUserEvent("Time limits check failed"):i._validity._not_yet_active?void i.logNonEligibleUserEvent("not in the scheduled time"):i._validity._nudge_expired?void i.logNonEligibleUserEvent("nudge expired"):void 0:void i.logNonEligibleUserEvent("Session property filter not met"):void i.logNonEligibleUserEvent("User property filter not met"):void i.logNonEligibleUserEvent("User session criteria not met"):void i.logNonEligibleUserEvent("Retained day criteria not met");var _=i._conditionValidators.length,u=_<1,l="";0===_&&(u=!0);for(var d=0;d<_;d++){var c=i._conditionValidators[d],v=c._isSatisfied;if(""===l.trim())u=v;else switch(l){case"AND":u=u&&v;break;case"OR":u=u||v}l=c._combineOperator}if(!0===o&&(u=!0),u){if(console.debug("onCondition satisfied"),!i._frequency.isFrequencyWithInLimits(i._uuid)){if(console.warn("Maximum limit reached",i._uuid),e.getController().isTestDevice()){L("Maximum limit reached for campaign name ".concat(i._meta._name));var f=document.getElementById("close-button"),g=function(){var e=document.getElementById("apx-container");null==e||e.remove()};null==f||f.addEventListener("click",g),window.setTimeout(g,2e4)}return}console.log("Dispatching event",i._meta._type),e.logEvent("apx_context_evaluated",n(n({apx_nudge_type:"SURVEY"===i._meta._type?"survey":"campaign",apx_nudge_id:i._uuid,apx_nudge_name:i._meta._name,apx_variant_code:i._meta._isExperiment||i._meta._only_context?i._meta._attr.apx_variant_code:"TG"},i._meta._attr),{},{message_name:i._meta._name,id:i._uuid})),e.getController().dispatchEvent(i._meta._type,{name:i._meta._type,additional_info:{uuid:i._uuid,name:i._meta._name}})}})),s(this,"_validateAllGoalEvents",(function(){for(var t=i._terminationGoalEventValidators.length,r=t<1,o="",a=0;a<t;a++){var s=i._terminationGoalEventValidators[a],_=s._isSatisfied;if(""===o.trim())r=_;else switch(o){case"AND":r=r&&_;break;case"OR":r=r||_}o=s._conbineOperatorForGoalEvent}r&&(console.log("Dispatching event",i._meta._type),e.getController().persistTerminationInfoLocally(i._uuid),!0===i._meta._only_context&&e.logEvent("apx_context_evaluated",n(n({},i._meta._attr),{},{message_name:i._meta._name,id:i._uuid})),e.getController().dispatchEvent(i._meta._type,{name:i._meta._type,additional_info:{uuid:i._uuid,name:i._meta._name}}))})),s(this,"validateForTerminationAttributes",(function(){var t=e.getController().getUserAttributes(),n=e.getController().getSessionAttributes();return i._terminationconfig.validate(t,n)})),s(this,"decrementCampaignCount",(function(){i._frequency.decrementCampaignCount()})),s(this,"getFrequencyCount",(function(){return i._frequency.getFrequencyCount()})),s(this,"resetFrequencyCount",(function(){return i._frequency.resetCampaignCount()})),s(this,"logNonEligibleUserEvent",(function(t){var n;null==e||e.logEvent("apx_non_eligible_user",{apx_nudge_type:"SURVEY"===i._meta._type?"survey":"campaign",apx_nudge_id:i._uuid,apx_nudge_name:i._meta._name,apx_variant_code:i._meta._isExperiment||i._meta._only_context?null===(n=i._meta._attr)||void 0===n?void 0:n.apx_variant_code:"TG",apx_failure_type:"warn",apx_reason:t})}))})),ee=a((function e(){var t=this;r(this,e),s(this,"_configs",{}),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{configs:[]};if(c(e)&&c(e.configs)){var n=e.configs;if(!Array.isArray(n))return;n.sort((function(e,t){var n,i;return(null!==(n=e.prio)&&void 0!==n?n:-1)-(null!==(i=t.prio)&&void 0!==i?i:-1)}));for(var i=0;i<n.length;i++){var r=n[i],o=r._id,a=new Z;a.parse(r)?t._configs[o]=a:console.warn("Failed to parse cfg",o)}}})),s(this,"validate",(function(e,n){t._configs[e]&&t._configs[e].evaluate(n)})),s(this,"getVariantCode",(function(e){return t._configs[e]?t._configs[e]._variant_code:""})),s(this,"validateForTermination",(function(e,n){t._configs[e]&&t._configs[e].terminationEvaluate(n)})),s(this,"validateForTerminationAttributes",(function(e){return!!t._configs[e]&&t._configs[e].validateForTerminationAttributes()})),s(this,"decrementCampaignCount",(function(e){t._configs[e].decrementCampaignCount()})),s(this,"getFrequencyCount",(function(e){var n=t._configs[e];if(null!=n)return n.getFrequencyCount()})),s(this,"resetFrequencyCounts",(function(){var e=t._configs;for(var n in e)e[n].resetFrequencyCount()})),s(this,"getCampaignMeta",(function(e){try{if(t._configs){var n=t._configs[e];if(n&&n._meta)return n._meta}}catch(e){console.log("Error in getting the campaign meta ".concat(e))}return{}}))})),te=window.ApxorLogger,ne=a((function t(){var n=this;r(this,t),s(this,"_listeners",{}),s(this,"_buffer",[]),s(this,"_isEnabled",!1),s(this,"initialize",(function(){var t=e.getController();t.registerForEvent("APP_EVENT",(function(e){return n._onEvent(e,"AE")})),t.registerForEvent("CLIENT_EVENT",(function(e){return n._onEvent(e,"CE")}))})),s(this,"enable",(function(){for(var e in n._buffer)n._notifyListeners(e.event,e.key,e.type);n._isEnabled=!0})),s(this,"registerToEvent",(function(e,t){var i;"function"==typeof t&&((i=n._listeners[e]?n._listeners[e]:[]).push(t),n._listeners[e]=i,te.debug("Listeners list: ",n._listeners))})),s(this,"unregisterFromEvent",(function(e,t){if(n._listeners[e]){for(var i=n._listeners[e],r=[],o=0;o<i.length;o++){var a=i[o];a!==t&&r.push(a)}n._listeners[e]=r}})),s(this,"_onEvent",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AE",i=t+"___"+e.name;n._notifyListeners(e,i,t)})),s(this,"_notifyListeners",(function(t,i,r){if(n._isEnabled){if(te.debug("Notifying listeners for event: "+t+", "+i,n._listeners),n._listeners[i])for(var o=n._listeners[i],a=e.getController().getSDKRunningTimeInSec(),s=0;s<o.length;s++){(0,o[s])(r,t.name,a,t.additional_info)}}else n._buffer.push({event:t,key:i,type:r})}))})),ie=window.ApxorLogger,re=function(){function t(){var n=this;return r(this,t),s(this,"_isInitialized",!1),s(this,"_configLookup",null),s(this,"_date",b()),s(this,"_eventsListener",new ne),s(this,"_siteId",e.getSiteId()),s(this,"_qeState",{}),s(this,"getQeState",(function(){try{var t=e.getController().getFromStorage("qe_state");return t?JSON.parse(g(n._siteId,t)):(n._qeState={},n.setQeState())}catch(e){return n._qeState={},n.setQeState()}})),s(this,"setQeState",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{e.getController().persistToStorage("qe_state",n._qeState,!0)}catch(i){""===t?n._qeState={}:n._qeState[t]={SESSION:0,OVERALL:0,DATES:{}},e.getController().persistToStorage("qe_state",n._qeState,!0)}return n._qeState})),s(this,"initialize",(function(){n._isInitialized||(n._isInitialized=!0,n._configLookup=new ee,n._eventsListener.initialize(),n._qeState=n.getQeState(),ie.info("QE Initialized.."))})),s(this,"parse",(function(e){n._check()?(n._configLookup.parse(e),n._eventsListener.enable()):ie.warn("Must call init first. Unable to proceed")})),s(this,"validate",(function(e,t){n._check()&&n._configLookup.validate(e,t)})),s(this,"getVariantCode",(function(e){return n._configLookup.getVariantCode(e)})),s(this,"validateForTermination",(function(e,t){n._check()&&n._configLookup.validateForTermination(e,t)})),s(this,"validateForTerminationAttributes",(function(e,t){return n._configLookup.validateForTerminationAttributes(e,t)})),s(this,"updateCount",(function(e){try{c(n._qeState[e])||n.createObjConfig(e),n.incrementFrequencies(e),n.setQeState(e),n._configLookup.decrementCampaignCount(e)}catch(e){console.log("Could not update the count config:".concat(e))}})),s(this,"resetFrequencyCounts",(function(){n._configLookup.resetFrequencyCounts()})),s(this,"getFrequencyCount",(function(e){return n._configLookup.getFrequencyCount(e)})),s(this,"registerForEvent",(function(e,t){n._eventsListener.registerToEvent(e,t)})),s(this,"unregisterFromEvent",(function(e,t){n._eventsListener.unregisterFromEvent(e,t)})),s(this,"notifyEventListener",(function(e){n._eventsListener._onEvent(e)})),s(this,"fetch",(function(t,n,i,r){e.getController().fetchConfiguration(t,n,i,r)})),s(this,"_check",(function(){return n._isInitialized})),s(this,"getCampaignMetaFromQueryEngine",(function(e){return n._configLookup.getCampaignMeta(e)})),s(this,"getCEStartDate",(function(){return n._date})),t.instance||(t.instance=this),t.instance}return a(t,[{key:"createObjConfig",value:function(e){try{this._qeState=this.getQeState(),c(this._qeState[e])||(this._qeState[e]={SESSION:0,OVERALL:0,DATES:{}},this._date&&(this._qeState[e].DATES[this._date]=0),this.setQeState(e))}catch(e){ie.error("Can not create the frequency count object:"+e)}}},{key:"incrementFrequencies",value:function(e){this._qeState=this.getQeState();var t=this._qeState[e];t.SESSION=t.SESSION+1,t.OVERALL=t.OVERALL+1;var n=b();n===this._date&&t.DATES&&t.DATES[n]||(this._date=n,t.DATES={},t.DATES[this._date]=0),t.DATES[this._date]=t.DATES[this._date]+1}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}]),t}();s(re,"instance",void 0),window.ceVersion=160;try{void 0===exports&&null===exports||(exports.default=re,module.exports=exports.default)}catch(e){}return re}));
