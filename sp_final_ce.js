!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("apxor")):"function"==typeof define&&define.amd?define(["apxor"],t):(e=e||self)["apxor-qe"]=t(e.Apxor)}(this,(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function n(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,g(i.key),i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=g(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,a,s=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(s.push(i.value),s.length!==t);l=!0);}catch(e){u=!0,r=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=d(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function g(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var f=window.ApxorLogger,h=function(e){return void 0===e},_=function(e){return null===e},p=function(e){return void 0!==e&&!_(e)},m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function y(e,t){return Array.from(t).map((function(t,n){return String.fromCharCode(t^function(e,t){return e.charCodeAt(Math.floor(t%e.length))}(e,n))})).join("")}var z=function(e,t){return y(e,t=function(e){var t,n,i,r,o,a,s=0,l=[];if(!e)return e;e+="";do{t=(a=m.indexOf(e.charAt(s++))<<18|m.indexOf(e.charAt(s++))<<12|(r=m.indexOf(e.charAt(s++)))<<6|(o=m.indexOf(e.charAt(s++))))>>16&255,n=a>>8&255,i=255&a,l.push(t),64!==r&&(l.push(n),64!==o&&l.push(i))}while(s<e.length);return l}(t))},S=function(e){return p(e)&&!_(e)&&!isNaN(e)},b=function(e){switch(e){case"app_event":return"AE";case"client_event":return"CE";case"activity_time":case"activity_event":return"AE";case"apxor_event":return"AEV";case"customer_event":return"CEV";case"any_event":return"ANV";case"campaign_event":return"CNV";case"survey_event":return"SVE"}return"Unknown"},N=function(e){return e.toUpperCase()},D=function(e,t,n){switch(n){case"EQ":return e===t;case"GT":return e>t;case"GTE":return e>=t;case"LT":return e<t;case"LTE":return e<=t;case"NEQ":return e!==t;case"R":return w(t).test(e);default:return!1}},w=function(e){var t=e.replace(/.*\/([gimuy]*)$/,"$1");t===e&&(t="");var n=t?e.replace(new RegExp("^/(.*?)/"+t+"$"),"$1"):e;return new RegExp(n,t)},x=function(){var e=new Date;return e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear()},E=function(e,t,n){if("GT"===n){var i=e.split(":"),r=t.split(":");if(!(i[0]>=r[0]))return!1;if(i[0]>r[0])return!0;if(i[0]!=r[0])return!1;if(i[1]>=r[1])return!0}else if("LT"===n){var o=e.split(":"),a=t.split(":");if(!(o[0]<=a[0]))return!1;if(o[0]<a[0])return!0;if(o[0]!=a[0])return!1;if(o[1]<=a[1])return!0}},C=function(e,t){switch(e){case"second":return 1e3*t;case"minute":return 60*t*1e3;case"hour":return 60*t*60*1e3;case"day":return 24*t*60*60*1e3;default:return 1}},F=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e||!t||!n)return!1;var r=n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),o=t.replace(new RegExp(r,"g"),"(.+)"),a=i?"^".concat(o):"".concat(o,"$"),s=new RegExp(a);return s.test(e)};function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,o=P(e,t);if(o){var a=function(){if(I(o)){return function(e){return O(e)}(o)}return f.info("Invalid target element. Width and height are 0 for element: ".concat(e,". Can't show tooltip")),!1};return a()}return n?(f.info("Not found yet. Rechecking the DOM."),B(r,i,e,t)):(f.info("Element with selector:".concat(e," not found.")),!1)}function B(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=setInterval((function(){var t=P(n,i);if(t){clearInterval(r);!function(){if(I()){O()}else f.info("Invalid target element. Width and height are 0 for element: ".concat(n,". Can't show tooltip"))}()}else(e-=1)<=0&&(clearInterval(r),console.warn("Element with selector:".concat(n," not found.")))}),t)}var P=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=document.getElementById(e);if(!i)try{i=document.querySelector(e)}catch(e){window.ApxorLogger.error("Error finding element in DOM:"+e)}(i||(i=T(e)),!i&&n.length>0)&&(i=null===(t=document.getElementById(n))||void 0===t||null===(t=t.contentWindow)||void 0===t||null===(t=t.document)||void 0===t?void 0:t.querySelector(e));return i},T=function(e){var t=e.indexOf("svg");-1!==t&&(e=e.substring(0,t)+"svg:svg");try{return document.OUOz(e,document,(function(e){return"svg"===e?"http://www.w3.org/2000/svg":null}),XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(e){window.ApxorLogger.error("Error finding element in DOM:"+e)}return null};function I(e){try{var t=e.getBoundingClientRect();if(0===t.width||0===t.height)return!1}catch(e){return!1}return!0}function X(e,t){for(var n=0;n<e.length;n++)if(e[n].hasOwnProperty(t))return e[n];return null}function O(e){var t,n,i,r;return!!(n=(t=e).offsetHeight,i=t.offsetWidth,(r=t.getBoundingClientRect()).left>=-i&&r.top>=-n&&r.right<=(window.innerWidth||document.documentElement.clientWidth)+i&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)+n)}var G=function(e){!function(e){var t='\n        <style> \n          .apx-container{\n            padding:10px;\n          }\n        </style>\n        <div id="apx-innerElement" class="apx-container">\n              <div id="close-button" style="cursor: pointer;position:absolute;top:9px;right:9px;"><svg width="11" height="11" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path opacity="0.5" d="M11.0962 9.07071L17.8586 15.8331L15.8331 17.8586L9.0707 11.0962L8.99999 11.0255L8.92928 11.0962L2.16693 17.8586L0.141421 15.8331L6.90379 9.07071L6.9745 9L6.90379 8.92929L0.141421 2.16694L2.16693 0.141422L8.92928 6.9038L8.99999 6.97451L9.0707 6.9038L15.8331 0.141422L17.8586 2.16694L11.0962 8.92929L11.0255 9L11.0962 9.07071Z" fill="white" stroke="#002845" stroke-width="0.2"/>\n                </svg>\n              </div>\n              <div style="font-family: inherit;font-style: normal;font-weight: 600;font-size: 16px;line-height: 22px;\n              color: #FFFFFF; display: flex; gap: 12px;"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-check-filled" width="33" height="33" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">\n  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n  <path d="M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z" stroke-width="0" fill="currentColor" />\n</svg><div style = "align-self: center;padding-right:20px;">'.concat(e,"</div></div>\n        </div>\n      "),n=document.createElement("div");n.style="\n        z-index:99999999;\n        background:#16202f;\n        position:fixed;\n        top:1%;\n        right:1%;\n        border-radius: 12px;\n      ",n.innerHTML=t,n.id="apx-container",document.body.appendChild(n)}(e);var t=document.getElementById("close-button"),n=function(){var e=document.getElementById("apx-container");null==e||e.remove()};null==t||t.addEventListener("click",n),window.setTimeout(n,2e4)},L=window.ApxorLogger,Y=a((function t(){var n=this;r(this,t),s(this,"BXPw","ALL"),s(this,"hLlB",[]),s(this,"rrTT",[]),s(this,"userAttributesValidated",!0),s(this,"sessionAttributeValidated",!0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(n.BXPw=e.audience.audience_type,n.hLlB=e.audience.attributes.user,n.rrTT=e.audience.attributes.session,!Array.isArray(n.hLlB)||!Array.isArray(n.rrTT))return L.error("No attributes"),!1}catch(e){return L.error(e),!1}return!0})),s(this,"validate",(function(t,i){var r=!0;"FTU"===n.BXPw&&(r=e.getController().getSessionInfo().is_first_session);var o=n.LDmT(t,n.hLlB),a=n.LDmT(i,n.rrTT);return o||(n.userAttributesValidated=!1),a||(n.sessionAttributeValidated=!1),r&&o&&a})),s(this,"LDmT",(function(e,t){var n=t.length,i=!0;try{for(var r,o=function(){var n=t[a];if(h(e[n.name])||!1===i)return{v:!1};var r=n.operator,o=n.type,s=n.value.map((function(e){if("s"===o)return e;if("l"===o)return parseInt(e);if("f"===o)return parseFloat(e);if("b"===o)switch(e){case"true":return!0;case"false":return!1;default:return e}})),l=(Array.isArray(e[n.name])?e[n.name]:[e[n.name]]).some((function(e){return s.some((function(t){return"s"===o?e="".concat(e):"l"===o?e=parseInt(e):"f"===o?e=parseFloat(e):"b"===o&&(e=!!e),D(e,t,r)}))}));i=i&&l},a=0;a<n;a++)if(r=o())return r.v}catch(e){L.error(e),i=!1}return i}))})),q=a((function e(){var t=this;r(this,e),s(this,"IDYQ",""),s(this,"rAgK",{}),s(this,"vuco",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{t.IDYQ=e.name,t.rAgK=e.additional_info,t.vuco=null==e?void 0:e.path}catch(e){return!1}return!0}))})),V=a((function e(){var t=this;r(this,e),s(this,"hvfT",0),s(this,"hDOA",0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(t.hvfT=Number(e.lower),t.hDOA=Number(e.upper),isNaN(t.hvfT)||isNaN(t.hDOA))return!1}catch(e){return!1}return!0}))})),M=a((function e(){var t=this;r(this,e),s(this,"PBnM",0),s(this,"XsXn",""),s(this,"HXHk",""),s(this,"BFoD",new q),s(this,"LSub",new V),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return t.XsXn=e.event_type,t.HXHk=e.activity,t.BFoD.parse(e.details)&&t.LSub.parse(e.time_bounds)}catch(e){return!1}}))})),H=window.ApxorLogger,R=a((function e(){var t=this;r(this,e),s(this,"PBnM",0),s(this,"iNqL",-1),s(this,"xdxj",0),s(this,"bNmx",""),s(this,"HXHk",""),s(this,"XsXn",""),s(this,"LSub",new V),s(this,"BFoD",new q),s(this,"oXAN",new M),s(this,"QuLr","AND"),s(this,"xeaL",!1),s(this,"BXPw",void 0),s(this,"LNeY",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n,i;return t.iNqL=null==e?void 0:e.sequence,t._conditionType=null==e?void 0:e.condition_type,t._id=null==e?void 0:e._id,t._eventCategory=null!=e&&e.event_category?null==e?void 0:e.event_category:"specific_event",t.xdxj=null==e||null===(n=e.count_config)||void 0===n?void 0:n.count,t.bNmx=null==e||null===(i=e.count_config)||void 0===i?void 0:i.operator,t.HXHk=null==e?void 0:e.activity,t.XsXn=null==e?void 0:e.event_type,t.QuLr=e.combine_operator,t._timeEnabled=null==e?void 0:e.time_enabled,t._time=null==e?void 0:e.time,t.BXPw=null==e?void 0:e.type,t.LNeY=null==e?void 0:e.route,t.BFoD.parse(null==e?void 0:e.details)&&t.oXAN.parse(e.trigger)&&t.LSub.parse(e.time_bounds)}catch(e){return H.error(e),!1}}))})),j=window.ApxorLogger,Q=a((function e(){var t=this;r(this,e),s(this,"xdxj",0),s(this,"bNmx",""),s(this,"XsXn",""),s(this,"LSub",new V),s(this,"BFoD",new q),s(this,"QuLr","AND"),s(this,"parse",(function(e){try{return t.xdxj=e.count_config.count,t.bNmx=e.count_config.operator,t.XsXn=e.event_type,t.QuLr=e.combine_operator,t.BFoD.parse(e.details)&&t.LSub.parse(e.time_bounds)}catch(e){return j.error(e),!1}}))})),U=window.ApxorLogger,K=function(){function t(){var n=this;r(this,t),s(this,"OKRM",0),s(this,"VUbd",""),s(this,"zSNz",new R),s(this,"GfbK",new Q),s(this,"DEgU",!1),s(this,"HiCs",!1),s(this,"DpzN",0),s(this,"QuLr","AND"),s(this,"Hnya","OR"),s(this,"jsvm",-1),s(this,"CPmQ",[]),s(this,"yYUQ",{}),s(this,"AYCB",!1),s(this,"qhyM",void 0),s(this,"axwN",void 0),s(this,"jeeR",void 0),s(this,"DYdQ",void 0),s(this,"no_KPI_TriggerDetails",[]),s(this,"HHVC",!1),s(this,"timerDidnt",void 0),s(this,"timerDid",void 0),s(this,"initialize",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1,d=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];if(n.VUbd=i,n.DpzN=r,n.CPmQ=a,n.qhyM=o,n.childConditionIndex=u,n.across_sessions=s||!1,"termination"===l&&""!==l){n.GfbK.parse(t);return n.Hnya=n.GfbK.QuLr,n.PEYc(),!0}var v=n.zSNz.parse(t);if(v){if(n.QuLr=n.zSNz.QuLr,n.zSNz.xeaL){var c=n.zSNz.BFoD.IDYQ;"APX_PAGE_OPENED"===c&&(c=n.zSNz.BFoD.rAgK.navigation_id,c=p(c)?c:n.zSNz.BFoD.IDYQ),n.jsvm=e.getController().getEventCount(c);var g=n.zSNz.xdxj,f=n.zSNz.bNmx;if(n.HiCs=n.Awux(n.jsvm-1,g,f,!1),n.DEgU=n.HiCs,n.HiCs&&"APX_PAGE_OPENED"===n.zSNz.BFoD.IDYQ)return!0}return!0===d&&(o&&0!==r&&"unordered"!==o||n.SuzN()),!0}return!1})),s(this,"SuzN",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;-1!=t&&(n.axwN=t);var i=n.zSNz,r=null!=i&&i._eventCategory?null==i?void 0:i._eventCategory:"specific_event",o=i.oXAN,a=he.getInstance();if("app_start"===o.XsXn)if(n.DEgU=!0,null!=i&&i._timeEnabled){if("session"!=(null==i?void 0:i._time.unit)){var s=C(i._time.unit,i._time.value);if("didn't"==(null==i?void 0:i.BXPw)){if(n.AYCB=!1,n.timerDidnt=setTimeout((function(){n.AYCB||(n.HiCs=!0,n.HiCs&&(n.OKRM+=1,n.HiCs=n.Awux(n.OKRM,n.zSNz.xdxj,n.zSNz.bNmx),n.HiCs&&(n.zSNz.PBnM=Date.now(),n.AYCB=!1,a.validate(n.VUbd,n.DpzN,n.axwN))),"specific_event"===r?a.unregisterFromEvent(b(n.zSNz.XsXn)+"___"+n.zSNz.BFoD.IDYQ,n.tdSG):n.mhOX(r),n.DEgU=!1)}),s),n.across_sessions){var l=C(i._time.unit,i._time.value),u=i._timeEnabled,d=i._id;n.doGY(i.BXPw,i.BFoD.IDYQ,Date.now(),i.BFoD.rAgK,l,u,d)}"specific_event"===r?(a.registerForEvent(b(n.zSNz.XsXn)+"___"+n.zSNz.BFoD.IDYQ,n.tdSG),n.DYdQ=n.zSNz):n.VeZE(r)}else if("did"==(null==i?void 0:i.BXPw)){if(n.timerDid=setTimeout((function(){n.HHVC||("specific_event"===r?a.unregisterFromEvent(b(n.zSNz.XsXn)+"___"+n.zSNz.BFoD.IDYQ,n.rZOj):n.FrEG(r))}),s),n.across_sessions){var v=C(i._time.unit,i._time.value),c=i._timeEnabled,g=i._id;n.doGY(i.BXPw,i.BFoD.IDYQ,Date.now(),i.BFoD.rAgK,v,c,g)}"specific_event"===r?(a.registerForEvent(b(n.zSNz.XsXn)+"___"+n.zSNz.BFoD.IDYQ,n.rZOj),n.jeeR=n.zSNz):n.tedl(r)}}}else"specific_event"===r?a.registerForEvent(b(i.XsXn)+"___"+i.BFoD.IDYQ,n.ZdAf):n.vZlA(r);else if(null!=i&&i._timeEnabled){if("session"!=(null==i?void 0:i._time.unit)){var f=C(i._time.unit,i._time.value);"didn't"==(null==i?void 0:i.BXPw)?(n.AYCB=!1,n.timerDidnt=setTimeout((function(){n.AYCB||(n.HiCs=!0,n.HiCs&&(n.OKRM+=1,n.HiCs=n.Awux(n.OKRM,n.zSNz.xdxj,n.zSNz.bNmx),n.HiCs&&(n.zSNz.PBnM=Date.now(),n.AYCB=!1,a.validate(n.VUbd,n.DpzN)))),"specific_event"===r&&a.unregisterFromEvent(b(n.zSNz.XsXn)+"___"+n.zSNz.BFoD.IDYQ,n.tdSG),n.DEgU=!1}),f),"specific_event"===r?(a.registerForEvent(b(n.zSNz.XsXn)+"___"+n.zSNz.BFoD.IDYQ,n.tdSG),n.DYdQ=n.zSNz):n.VeZE()):"did"==(null==i?void 0:i.BXPw)&&(n.timerDid=setTimeout((function(){n.HHVC||"specific_event"===r&&a.unregisterFromEvent(b(n.zSNz.XsXn)+"___"+n.zSNz.BFoD.IDYQ,n.rZOj)}),f),"specific_event"===r&&a.registerForEvent(b(n.zSNz.XsXn)+"___"+n.zSNz.BFoD.IDYQ,n.rZOj))}}else"specific_event"===r&&a.registerForEvent(b(i.XsXn)+"___"+o.BFoD.IDYQ,n.ZdAf);null!==(e=window.ApxorRTM)&&void 0!==e&&e.badgesLists.includes(n.VUbd)&&a.registerForEvent(b(i.XsXn)+"___"+"apxor-badge-container-".concat("-".concat(n.VUbd).replaceAll(" ","").replace(/[^\w\s]/gi,"")),n.ZdAf)})),s(this,"vZlA",(function(e){var t=new he;"apxor_event"===e?t.registerForEvent("apxor_event",(function(e,t,i,r){n.ZdAf(b(n.zSNz.XsXn),n.zSNz.BFoD.IDYQ,i,n.zSNz.BFoD.rAgK)})):"customer_event"===e?t.registerForEvent("customer_event",(function(e,t,i,r){n.ZdAf(b(n.zSNz.XsXn),n.zSNz.BFoD.IDYQ,i,n.zSNz.BFoD.rAgK)})):"any_event"===e?t.registerForEvent("any_event",(function(e,t,i,r){n.ZdAf(b(n.zSNz.XsXn),n.zSNz.BFoD.IDYQ,i,n.zSNz.BFoD.rAgK)})):"campaign_event"===e?t.registerForEvent("campaign_event",(function(e,t,i,r){n.ZdAf(b(n.zSNz.XsXn),n.zSNz.BFoD.IDYQ,i,n.zSNz.BFoD.rAgK)})):"survey_event"===e&&t.registerForEvent("survey_event",(function(e,t,i,r){n.ZdAf(b(n.zSNz.XsXn),n.zSNz.BFoD.IDYQ,i,n.zSNz.BFoD.rAgK)}))})),s(this,"mhOX",(function(e){var t=new he,i=n.zSNz._eventCategory;"apxor_event"===i?t.unregisterFromEvent("apxor_event",n.tdSG):"customer_event"===i?t.unregisterFromEvent("customer_event",n.tdSG):"any_event"===i?t.unregisterFromEvent("any_event",n.tdSG):"campaign_event"===i?t.unregisterFromEvent("campaign_event",n.tdSG):"survey_event"===i&&t.unregisterFromEvent("survey_event",n.tdSG)})),s(this,"VeZE",(function(){var e=new he,t=n.zSNz._eventCategory;"apxor_event"===t?e.registerForEvent("apxor_event",n.tdSG):"customer_event"===t?e.registerForEvent("customer_event",n.tdSG):"any_event"===t?e.registerForEvent("any_event",n.tdSG):"campaign_event"===t?e.registerForEvent("campaign_event",n.tdSG):"survey_event"===t&&e.registerForEvent("survey_event",n.tdSG)})),s(this,"tedl",(function(){var e=new he,t=n.zSNz._eventCategory;"apxor_event"===t?e.registerForEvent("apxor_event",n.rZOj):"customer_event"===t?e.registerForEvent("customer_event",n.rZOj):"any_event"===t?e.registerForEvent("any_event",n.rZOj):"campaign_event"===t?e.registerForEvent("campaign_event",n.rZOj):"survey_event"===t&&e.registerForEvent("survey_event",n.rZOj)})),s(this,"FrEG",(function(){var e=new he,t=n.zSNz._eventCategory;"apxor_event"===t?e.unregisterFromEvent("apxor_event",n.rZOj):"customer_event"===t?e.unregisterFromEvent("customer_event",n.rZOj):"any_event"===t?e.unregisterFromEvent("any_event",n.rZOj):"campaign_event"===t?e.unregisterFromEvent("campaign_event",n.rZOj):"survey_event"===t&&e.unregisterFromEvent("survey_event",n.rZOj)})),s(this,"PEYc",(function(){var e=n.GfbK,t=he.getInstance();n.DEgU=!0,t.registerForEvent(b(e.XsXn)+"___"+e.BFoD.IDYQ,n.aXIJ)})),s(this,"yGWs",(function(e,t,i,r){var o,a=(Date.now()-n.yYUQ[t])/1e3;(null===(o=n.zSNz)||void 0===o||null===(o=o.BFoD)||void 0===o||null===(o=o.rAgK)||void 0===o?void 0:o.time)/1e3>a&&n._displayCampaign(i)})),s(this,"OrXT",(function(e,t,i,r){var o,a;n.AYCB=!0;var s=Date.now(),l=null===(o=n.zSNz)||void 0===o||null===(o=o.oXAN)||void 0===o?void 0:o.BFoD.IDYQ,u=(s-n.yYUQ[l])/1e3,d=null===(a=n.zSNz)||void 0===a||null===(a=a.BFoD)||void 0===a||null===(a=a.rAgK)||void 0===a?void 0:a.time;(d/=1e3)>u&&n._displayCampaign(i)})),s(this,"rZOj",(function(){n.HHVC=!0;var e=new he;clearTimeout(n.timerDid),n.OKRM+=1,n.HiCs=n.Awux(n.OKRM,n.zSNz.xdxj,n.zSNz.bNmx),n.HiCs&&(e.unregisterFromEvent(b(n.jeeR.XsXn)+"___"+n.jeeR.BFoD.IDYQ,n.rZOj),n.HHVC=!1,e.validate(n.VUbd,n.DpzN,n.axwN))})),s(this,"tdSG",(function(e,t,i,r){n.AYCB=!0,clearTimeout(n.timerDidnt),(new he).unregisterFromEvent(b(n.DYdQ.XsXn)+"___"+n.DYdQ.BFoD.IDYQ,n.tdSG)})),s(this,"ZdAf",(function(t,i,r,o){var a,s,l=he.getInstance();if(n.DEgU){if(null!==(a=window.ApxorRTM)&&void 0!==a&&a.isBadgePresent&&null!==(s=window.ApxorRTM)&&void 0!==s&&s.badgesLists.includes(n.VUbd)&&e.getController().isBadgeTriggerSatisfied(n.VUbd))return n.HiCs=!0,n.zSNz.PBnM=r,void l.validate(n.VUbd,n.DpzN);if(b(n.zSNz.XsXn)===t&&n.GJgu(r-n.zSNz.oXAN.PBnM,n.zSNz.LSub)&&n.zSNz.BFoD.IDYQ===i&&n.uCEn(n.zSNz.BFoD.rAgK,o)&&(n.OKRM+=1,n.HiCs=n.Awux(n.OKRM,n.zSNz.xdxj,n.zSNz.bNmx),n.HiCs)){if(n.zSNz.PBnM=r,n.across_sessions){var u=C(n.zSNz._time.unit,n.zSNz._time.value),d=n.zSNz._timeEnabled,v=n.zSNz._id,c=n.OKRM;n.doGY(n.zSNz.BXPw,i,r,o,u,d,v,c)}l.validate(n.VUbd,n.DpzN,n.axwN)}}else if(n.DEgU=n.OmsD(t,i,r,o),n.DEgU){var g=n.zSNz,f=g.oXAN;if(f.PBnM=r,"activity_time"===(null==g?void 0:g.XsXn)){var h,_,p,m,y=null==g||null===(h=g.BFoD)||void 0===h||null===(h=h.rAgK)||void 0===h?void 0:h.time;(null==g||null===(_=g.LNeY)||void 0===_?void 0:_.length)>0?setTimeout((function(){var t;(null===(t=e.getController())||void 0===t?void 0:t._appEventsNoKpi).length<=2&&g.LNeY===location.pathname&&n._displayCampaign(r)}),y):(null==g||null===(p=g.BFoD)||void 0===p||null===(p=p.rAgK)||void 0===p?void 0:p.nkpi.length)>0?(setTimeout((function(){n.AYCB||(n.HiCs=!0,n.HiCs&&(n.OKRM+=1,n.HiCs=n.Awux(n.OKRM,n.zSNz.xdxj,n.zSNz.bNmx),n.HiCs&&(n.zSNz.PBnM=r,n.AYCB=!1,l.validate(n.VUbd,n.DpzN)))),g.BFoD.rAgK.nkpi.map((function(e){l.unregisterFromEvent(N(g.BFoD.rAgK.et)+"___"+e,n),n.DEgU=!1}))}),y),g.BFoD.rAgK.nkpi.map((function(e){l.registerForEvent(N(g.BFoD.rAgK.et)+"___"+e,n.tdSG)}))):(null==g||null===(m=g.BFoD)||void 0===m||null===(m=m.rAgK)||void 0===m?void 0:m.kpi.length)>0&&(setTimeout((function(){g.BFoD.rAgK.kpi.map((function(e){l.unregisterFromEvent(N(g.BFoD.rAgK.et)+"___"+e,n)}))}),y),g.BFoD.rAgK.kpi.map((function(e){e===g.oXAN.BFoD.IDYQ?(l.unregisterFromEvent(b(f.XsXn)+"___"+f.BFoD.IDYQ,n),l.registerForEvent(N(g.BFoD.rAgK.et)+"___"+e,n.yGWs)):l.registerForEvent(N(g.BFoD.rAgK.et)+"___"+e,n.OrXT)})))}else l.unregisterFromEvent(b(f.XsXn)+"___"+f.BFoD.IDYQ,n),l.registerForEvent(b(g.XsXn)+"___"+g.BFoD.IDYQ,n);n.yYUQ[i]=Date.now()}})),s(this,"aXIJ",(function(e,t,i,r){var o=he.getInstance();b(n.GfbK.XsXn)===e&&n.GJgu(i,n.GfbK.LSub)&&n.GfbK.BFoD.IDYQ===t&&n.uCEn(n.GfbK.BFoD.rAgK,r)&&(n.OKRM+=1,n.HiCs=n.Awux(n.OKRM,n.GfbK.xdxj,n.GfbK.bNmx),n.HiCs&&(n.GfbK.PBnM=i,o.validateForTermination(n.VUbd,n.DpzN)))})),s(this,"OmsD",(function(e,t,i,r){var o=n.zSNz.oXAN,a=b(o.XsXn)===e&&o.BFoD.IDYQ===t&&n.GJgu(i,o.LSub)&&n.uCEn(o.BFoD.rAgK,r);return a="APX_PAGE_OPENED"===t?a&&location.pathname===o.BFoD.vuco:a})),s(this,"GJgu",(function(e,t){var n=Math.ceil(e);return n>t.hvfT&&n<t.hDOA})),s(this,"Awux",(function(e,t,i){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];switch(r&&n.zSNz.xeaL&&(e+=n.jsvm),i){case"EQ":return e===t;case"GT":return e>t;case"GTE":return e>=t;case"LT":return e<t;case"LTE":return e<=t;default:return!1}})),s(this,"uCEn",(function(e,t){var n=!0;try{var r,o=function(){if(!1===n)return{v:!1};if("object"===i(e[a])){var r,o,s,l=e[a].op,u=e[a].t;if("s"===u)s=e[a].val;else if("l"===u||"f"===u)s=parseFloat(e[a].val);else if("b"===u)switch(e[a].val){case"true":s=!0;break;case"false":s=!1;break;default:s=e[a].val}var d,v=(Array.isArray(t[a])?t[a]:[t[a]]).some((function(e){return"s"===u?e="".concat(e):"l"===u?e=parseInt(e):"f"===u?e=parseFloat(e):"b"===u&&(e=!!e),D(e,s,l)}));if(!(null===(r=e[a])||void 0===r||!r.present)&&(null===(o=e[a])||void 0===o?void 0:o.present))d=!!t.hasOwn(t,a),n=n&&d;n=n&&v}else n=n&&D(t[a],e[a],"EQ")};for(var a in e)if(r=o())return r.v}catch(e){U.error(e),n=!1}return n})),s(this,"doGY",(function(t,i,r,o,a,s,l,u){var d,v=!1;n.no_KPI_TriggerDetails=e.getController().getFromStorage("apx_nokpi_triggerdetails"),null===n.no_KPI_TriggerDetails||void 0===n.no_KPI_TriggerDetails?n.no_KPI_TriggerDetails=[]:n.no_KPI_TriggerDetails=JSON.parse(n.no_KPI_TriggerDetails);var c,g=0;s&&(g=Date.now()+a);for(var f=0;f<n.no_KPI_TriggerDetails.length;f++)if(n.no_KPI_TriggerDetails[f].id===l){v=!0,d=n.no_KPI_TriggerDetails[f];break}v?d.satisfiedCount+=1:(c={id:l,type:t,time:r,name:i,additionalInfo:o,satisfiedCount:u,timeBased:s,finishTime:g},n.no_KPI_TriggerDetails.push(c)),e.getController().persistToStorage("apx_nokpi_triggerdetails",JSON.stringify(n.no_KPI_TriggerDetails))})),s(this,"zDFd",(function(e){var t,i=new he,r=c(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(1===(null==o?void 0:o.length)||void 0===(null==o?void 0:o.length))i.unregisterFromEvent(b(null==o?void 0:o.zSNz.XsXn)+"___"+(null==o?void 0:o.zSNz.BFoD.IDYQ),n.ZdAf);else{var a,s=c(o);try{for(s.s();!(a=s.n()).done;){var l,u=a.value;i.unregisterFromEvent(b(null==u?void 0:u.zSNz.XsXn)+"___"+(null==u||null===(l=u.zSNz)||void 0===l?void 0:l.BFoD.IDYQ),n.ZdAf)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){r.e(e)}finally{r.f()}}))}return a(t,[{key:"_displayCampaign",value:function(e){var t=he.getInstance();this.HiCs=!0,this.HiCs&&(this.OKRM+=1,this.HiCs=this.Awux(this.OKRM,this.zSNz.xdxj,this.zSNz.bNmx),this.HiCs&&(this.zSNz.PBnM=e,t.validate(this.VUbd,this.DpzN)))}}]),t}(),k=window.ApxorLogger,J=a((function t(){var n=this;r(this,t),s(this,"xdxj",0),s(this,"NGQL",0),s(this,"Lvcl","SESSION"),s(this,"ngIG",0),s(this,"vAdC",0),s(this,"lvsX",0),s(this,"_enable_repetition_gap",void 0),s(this,"_enable_days_limit",void 0),s(this,"_enable_session_limit",void 0),s(this,"ZNaR",void 0),s(this,"BIRR",void 0),s(this,"HWvb",void 0),s(this,"DSLimits",void 0),s(this,"parse",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var i,r,o,a,s,l,u,d;if(n.VUbd=t._id,n.pGci=t.meta,n.xdxj=t.frequency.count,-1===n.xdxj&&(n.xdxj=9999999),n.lvsX=n.xdxj,n.NGQL=t.frequency.time_interval,n.Lvcl=t.frequency.validity,n.DSLimits=t.frequency.DSLimits,n.vAdC=t.frequency.ses_lmt,n._enable_session_limit=null===(i=t.frequency)||void 0===i?void 0:i.enable_session_limit,n._enable_session_limit)n.ZNaR=null===(l=t.frequency)||void 0===l?void 0:l.session_count;if(n._dayCount=null!==(r=t.frequency)&&void 0!==r&&r.day_lmt?null===(o=t.frequency)||void 0===o?void 0:o.day_lmt:0,n._enable_repetition_gap=!!t.frequency.enable_repetition_gap&&t.frequency.enable_repetition_gap,n._enable_repetition_gap)n._repetitionValue=null===(u=t.frequency)||void 0===u?void 0:u.repetition_gap.val,n._repetitionUnit=null===(d=t.frequency)||void 0===d?void 0:d.repetition_gap.unit;n._enable_days_limit=!(null===(a=t.frequency)||void 0===a||!a.enable_days_limit)&&(null===(s=t.frequency)||void 0===s?void 0:s.enable_days_limit),n._enable_days_limit&&(n.HWvb=t.frequency.days_limit.days?t.frequency.days_limit.days:1,n.BIRR=t.frequency.days_limit.limit);var v=he.getInstance().getQeState();if(!p(v)||!p(v[t._id]))return!0;if("SESSION"===n.Lvcl){if(n.xdxj=parseInt(n.xdxj)-parseInt(v[t._id].SESSION),n.xdxj<=0)return n.wqvJ("Session limit reached"),console.warn("Max count limit reached for session:"+t._id),e.getController().isTestDevice()&&G("Maximum overall limit reached for campaign name ".concat(n.pGci.name)),!1}else{if("OVERALL"!==n.Lvcl)return k.info("Invalid config."),!1;if(n.xdxj=parseInt(n.xdxj)-parseInt(v[t._id].OVERALL),n.xdxj<=0)return n.wqvJ("Overall limit reached"),console.warn("Max count limit reached for overall:"+t._id),e.getController().isTestDevice()&&G("Maximum overall limit reached for campaign name ".concat(n.pGci.name)),!1}}catch(e){return k.error(e),!1}return!0})),s(this,"NByB",(function(){n.xdxj=n.xdxj-1})),s(this,"getFrequencyCount",(function(){return n.xdxj})),s(this,"gTCR",(function(){"SESSION"===n.Lvcl&&(n.xdxj=n.lvsX,k.info("Campaign Limit reset"))})),s(this,"RfHJ",(function(t){try{if(n.xdxj<=0)return"OVERALL"===n.Lvcl?(n.wqvJ("Overall limit reached"),e.getController().isTestDevice()&&G("Maximum overall limit reached for campaign name ".concat(n.pGci.name))):"SESSION"===n.Lvcl&&(e.getController().isTestDevice()&&G("Maximum session limit reached for campaign name ".concat(n.pGci.name)),n.wqvJ("Session limit reached")),!1;var i=he.getInstance().getQeState();if(!p(i)||!p(i[t]))return!0;if(n._enable_session_limit)if(parseInt(n.ZNaR)-parseInt(i[t].SESSION)<=0)return n.wqvJ("Session limit reached"),e.getController().isTestDevice()&&G("Maximum session limit reached for campaign name ".concat(n.pGci.name)),!1;if(n._enable_repetition_gap)if("session"!=n._repetitionUnit){var r=e.getController().getFromStorage("apx-last-shown-times");if(r=JSON.parse(r),!_(X(r,n.VUbd))){var o=X(r,n.VUbd)[n.VUbd];if(Date.now()-o<C(n._repetitionUnit,n._repetitionValue))return n.wqvJ("Config does not satisfy time difference              "),e.getController().isTestDevice()&&G("Config does not satisfy time difference for campaign name ".concat(n.pGci.name)),!1}}else{var a=e.getController().getFromStorage("apx-last-shown-session");if(a=JSON.parse(a),!_(X(a,n.VUbd))){var s=X(a,n.VUbd)[n.VUbd];if(e.getController().getFromStorage("apx_retained_session")-s<parseInt(n._repetitionValue))return n.wqvJ("Config does not satisfy session difference              "),e.getController().isTestDevice()&&G("Config does not satisfy session difference for campaign name ".concat(n.pGci.name)),!1}}if(0!==n.vAdC&&n.DSLimits)if(parseInt(n.vAdC)-parseInt(i[t].SESSION)<=0)return n.wqvJ("Session limit reached"),e.getController().isTestDevice()&&G("Session limit reached for campaign name ".concat(n.pGci.name)),!1;if(0!==n._dayCount){var l,u=x();if(parseInt(n._dayCount)-parseInt((null===(l=i[t])||void 0===l?void 0:l.DATES[u])||0)<=0)return n.wqvJ("Day limit reached"),e.getController().isTestDevice()&&G("Day limit reached for campaign name ".concat(n.pGci.name)),!1}if(n.HWvb>0&&n._enable_days_limit){var d=n.HWvb,v=0;if(function(e){for(var t=[],n=new Date,i=0;i<e;i++){var r=new Date(n);r.setDate(n.getDate()-i);var o=String(r.getDate()),a=String(r.getMonth()),s=r.getFullYear();t.push(o+"/"+a+"/"+s)}return t}(d).forEach((function(e){var n;v+=parseInt((null===(n=i[t])||void 0===n?void 0:n.DATES[e])||0)})),v>n.BIRR)return k.info("Shown Limit Crossed"),e.getController().isTestDevice()&&G("Days limit reached for campaign name ".concat(n.pGci.name)),!1}}catch(e){n.wqvJ("Error validating the frequency: ".concat(e)),k.error("Error validating the frequency:"+e)}return!0})),s(this,"wqvJ",(function(t){var i;null==e||e.logEvent("apx_non_eligible_user",{apx_nudge_type:"SURVEY"===n.pGci.type?"survey":"campaign",apx_nudge_id:n.VUbd,apx_nudge_name:n.pGci.name,apx_variant_code:n.pGci.isExperiment||n.pGci.only_context?null===(i=n.pGci.attr)||void 0===i?void 0:i.apx_variant_code:"TG",apx_failure_type:"warn",apx_reason:t})}))})),Z=window.ApxorLogger,W=a((function e(){var t=this;r(this,e),s(this,"dmrc",[]),s(this,"BXiK",0),s(this,"NeOo",!1),s(this,"Rwmg",void 0),s(this,"initialize",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unordered",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];t.VUbd=n,t.DpzN=i,t.CPmQ=o,t.qhyM=r,t.across_sessions=s;var l=[];t.BXiK=e.length;try{if(null!=l)return r=null==e?void 0:e.sequence_type,l=t.aPIx(e,t.BXiK),"unordered"!==a&&0!==t.DpzN||t.SuzN(),t.dmrc}catch(e){return Z.error(e),!1}})),s(this,"aPIx",(function(e,n){for(var i=0;i<n;i++){t.Rwmg=new K;try{t.Rwmg.initialize(e[i],t.VUbd,t.DpzN,t.qhyM,t.qgYS,t.across_sessions,"",-1,!1)&&(t.dmrc.push(t.Rwmg),t.dmrc.sequence_type=t.qhyM)}catch(e){Z.error(e)}}return t.dmrc})),s(this,"SuzN",(function(){if("ordered"===t.qhyM||"strictly_ordered"===t.qhyM)t.dmrc[0].SuzN(0);else{var e,n=c(t.dmrc);try{for(n.s();!(e=n.n()).done;){e.value.SuzN()}}catch(e){n.e(e)}finally{n.f()}}})),s(this,"zDFd",(function(e){t.Rwmg.zDFd(e)}))})),$=a((function e(){var t=this;r(this,e),s(this,"IDYQ",""),s(this,"BXPw",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n,i;t.IDYQ=e.meta.name,t.BXPw=e.meta.type,t._only_context=e.meta.only_context,t._attr=(null===(n=e.meta)||void 0===n?void 0:n.attr)||{},t._isExperiment=null===(i=e.meta)||void 0===i?void 0:i.isExperiment}catch(e){return window.ApxorLogger.error(e),!1}return!0}))})),ee=window.ApxorLogger,te=a((function t(){var n=this;r(this,t),s(this,"Fkuu",[]),s(this,"_ret_day",{}),s(this,"vUgC",{}),s(this,"QiWW",!1),s(this,"HyUB",!1),s(this,"retainedDaysValidated",!0),s(this,"retainedSessionValidated",!0),s(this,"eventDoneInLT",!1),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{n.Fkuu=e.overall_cfg.events,n._ret_day=e.overall_cfg.ret_day,n.vUgC=e.overall_cfg.session,n.QiWW=e.overall_cfg.toggleRetDay,n.HyUB=e.overall_cfg.toggleSession}catch(e){return ee.error(e),!1}return!0})),s(this,"validate",(function(){var t=parseInt(e.getController().getFromStorage("apx_retained_days")),i=parseInt(e.getController().getFromStorage("apx_retained_session"));if(n.QiWW&&!isNaN(t)&&!(t>=n._ret_day.from&&t<=n._ret_day.to))return n.retainedDaysValidated=!1,!1;if(n.HyUB&&!isNaN(i)&&!(i>=n.vUgC.from&&i<=n.vUgC.to))return n.retainedSessionValidated=!1,!1;try{for(var r=e.getController().getFromStorage("_apx_lt_count"),o=e.getSiteId(),a=JSON.parse((new TextDecoder).decode(function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return t}(z(o,r)))),s=0;s<n.Fkuu.length;s++){if(a[n.Fkuu[s].name.replace("'","").replace("’","")])return n.eventDoneInLT=!0,!1}}catch(e){ee.error("Failed to validate the lt count:"+e)}return!0}))})),ne=window.ApxorLogger,ie=a((function e(){var t=this;r(this,e),s(this,"hLlB",[]),s(this,"rrTT",[]),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(t.hLlB=e.attributes.user,t.rrTT=e.attributes.session,!Array.isArray(t.hLlB)||!Array.isArray(t.rrTT))return ne.error("No attributes"),!1}catch(e){return ne.error(e),!1}return!0})),s(this,"validate",(function(e,n){return t.LDmT(e,t.hLlB)&&t.LDmT(n,t.rrTT)})),s(this,"LDmT",(function(e,t){var n=t.length,i=!0;try{for(var r,o=function(){var n=t[a];if(!e[n.name]||!1===i)return{v:!1};var r=n.operator,o=n.type,s=n.value.map((function(e){return"s"===o?e:"l"===o?parseInt(e):"f"===o?parseFloat(e):void 0})),l=(Array.isArray(e[n.name])?e[n.name]:[e[n.name]]).some((function(e){return s.some((function(t){return D(e,t,r)}))}));i=i&&l},a=0;a<n;a++)if(r=o())return r.v}catch(e){ne.error(e),i=!1}return i}))})),re=a((function t(){var n=this;r(this,t),s(this,"HlGB",e.getController()),s(this,"type",""),s(this,"_duration_seconds",0),s(this,"ylEy",1),s(this,"parse",(function(e){try{var t,i,r;if(n.BXPw=null===(t=e.terminate_info.time_based)||void 0===t?void 0:t.type,n._duration_seconds=null===(i=e.terminate_info)||void 0===i?void 0:i.time_based.duration_seconds,n.ylEy=null===(r=e.terminate_info.time_based)||void 0===r?void 0:r.days,n.xosm(e._id))return n.HlGB.persistTerminationInfoLocally(e._id),!1}catch(e){return!1}return!0})),s(this,"xosm",(function(e){var t,i=JSON.parse(n.HlGB.getFromStorage("apx_termination_ID"));if(!i[e]||null===(t=i[e])||void 0===t||!t.startDate)return!1;var r,o=new Date(i[e].startDate),a=new Date((r=new Date).getMonth()+"/"+r.getDate()+"/"+r.getFullYear()),s=parseInt((a-o)/864e5,10),l=function(){var e=new Date;return{hours:e.getHours(),mins:e.getMinutes()}}(),u=i[e].BwSc;return s===n.ylEy&&l.hours>=u.hours||s>n.ylEy||i[e].goalAcheived}))})),oe=a((function e(){var t=this;r(this,e),s(this,"enable_goal_events",!1),s(this,"attributes",{}),s(this,"lSMS",new ie),s(this,"SiRT",new re),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n,i,r;if(t.enable_time_based=null==e||null===(n=e.terminate_info)||void 0===n?void 0:n.enable_time_based,t.enable_time_based&&!t.SiRT.parse(e))return!1;if(t.enable_goal_events=null==e||null===(i=e.terminate_info)||void 0===i?void 0:i.enable_goal_events,t.enable_attributes=null==e||null===(r=e.terminate_info)||void 0===r?void 0:r.enable_attributes,t.enable_attributes&&!t.lSMS.parse(e.terminate_info))return!1}catch(e){return window.ApxorLogger.error(e),!1}return!0})),s(this,"validate",(function(e,n){return t.lSMS.validate(e,n)}))})),ae=window.ApxorLogger,se=a((function t(){var n=this;r(this,t),s(this,"bCiz",-1),s(this,"DFpd",-1),s(this,"BwSc",-1),s(this,"quAh",-1),s(this,"fdsK",-1),s(this,"gxya",-1),s(this,"_is_user_timezone",void 0),s(this,"cmHD",!1),s(this,"Oacu",!1),s(this,"_nudge_expired",!1),s(this,"_not_yet_active",!1),s(this,"_not_in_specified_time",!1),s(this,"_days_in_week",[]),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t,i;if(n.VUbd=e._id,n.pGci=e.meta,isNaN(Date.parse(e.validity.start_date))||isNaN(Date.parse(e.validity.end_date))||!Array.isArray(e.validity.days_in_week))return ae.error("Not valid dates"),!1;if(n.bCiz=Date.parse(e.validity.start_date),n.DFpd=Date.parse(e.validity.end_date),n._days_in_week=null!==(t=e.validity)&&void 0!==t&&t.days_in_week?null===(i=e.validity)||void 0===i?void 0:i.days_in_week:[1,2,3,4,5,6,7],n._is_user_timezone=!e.is_user_timezone||e.is_user_timezone,p(e.at_specific_time)&&(n.cmHD=e.at_specific_time,n.cmHD&&p(e.time_limits)&&(n.BwSc=e.time_limits.start_time,n.quAh=e.time_limits.end_time,S(n.BwSc)||S(n.quAh))))return ae.error("Not valid times"),!1;if(p(e.time_excludes_in_day)&&(n.Oacu=e.time_excludes_in_day,n.Oacu&&p(e.time_excludes)&&(n.fdsK=e.time_excludes.start_time,n.gxya=e.time_excludes.end_time,S(n.fdsK)||S(n.gxya))))return ae.error("Not valid exclude times"),!1}catch(e){return ae.error(e),!1}return!0})),s(this,"validate",(function(){var t=Date.now(),i=(new Date).getDay()+1,r=function(e){var t=new Date,n=t.getHours(),i=t.getMinutes(),r=(n=(n<10?"0":"")+n)+":"+(i=(i<10?"0":"")+i);if(!e){var o=t.getUTCHours(),a=t.getUTCMinutes();r=(o=(o<10?"0":"")+o)+":"+(a=(a<10?"0":"")+a)}return r}(n._is_user_timezone);if(t>n.bCiz&&t<n.DFpd&&n._days_in_week.includes(i))return!n.cmHD||E(r,n.BwSc,"GT")&&E(r,n.quAh,"LT")||(n._not_in_specified_time=!0),n.Oacu&&function(e,t,n){var i=l(e.split(":").map(Number),2),r=i[0],o=i[1],a=l(t.split(":").map(Number),2),s=a[0],u=a[1],d=l(n.split(":").map(Number),2),v=60*d[0]+d[1];return v>=60*r+o&&v<=60*s+u}(n.fdsK,n.gxya,r)?(n.wqvJ("Exclude Time limits check failed"),e.getController().isTestDevice()&&G("Exclude Time Limits check failed for campaign name ".concat(n.pGci.name)),!1):!n.cmHD||E(r,n.BwSc,"GT")&&E(r,n.quAh,"LT");if(t<n.bCiz)n._not_yet_active=!0;else if(t>n.DFpd)n._nudge_expired=!0;else if(!n._days_in_week.includes(i))return n.wqvJ("Current week day did not match with Configured Week day"),e.getController().isTestDevice()&&G("Current week day did not match with Configured Week day for campaign name ".concat(n.pGci.name)),!1;return!1})),s(this,"wqvJ",(function(t){var i;null==e||e.logEvent("apx_non_eligible_user",{apx_nudge_type:"SURVEY"===n.pGci.type?"survey":"campaign",apx_nudge_id:n.VUbd,apx_nudge_name:n.pGci.name,apx_variant_code:n.pGci.isExperiment||n.pGci.only_context?null===(i=n.pGci.attr)||void 0===i?void 0:i.apx_variant_code:"TG",apx_failure_type:"warn",apx_reason:t})}))})),le=a((function e(){var t=this;r(this,e),s(this,"uEKE",""),s(this,"LdNl",""),s(this,"aJZw",""),s(this,"gWIw",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return t.uEKE=null==e?void 0:e.screen_binding,!t.uEKE||(t.LdNl=null==e?void 0:e.binding.url,t.aJZw=null==e?void 0:e.binding.var,t.gWIw=null==e?void 0:e.binding.operator,!0)}catch(e){return window.ApxorLogger.error(e),!1}})),s(this,"validate",(function(){var e=t.LdNl,n=t.aJZw,i=t.gWIw,r=window.location.href;return!t.uEKE||("EQ"===i?e.includes(n)?!!F(r,e,n,!1):r===e:"SW"===i?e.includes(n)?!!F(r,e,n,!0):!!r.startsWith(e):void 0)}))})),ue=window.ApxorLogger,de=a((function t(){var i=this;r(this,t),s(this,"hgPb",[]),s(this,"uxJj",[]),s(this,"VUbd",""),s(this,"pGci",new $),s(this,"VYuU",new Y),s(this,"Lvcl",new se),s(this,"qQkV",new J),s(this,"BMkZ",new te),s(this,"qlpq",new oe),s(this,"KmtX",new le),s(this,"qhyM",!1),s(this,"qgYS",[]),s(this,"_variant_code",""),s(this,"NeOo",!1),s(this,"groupCombineOperator","OR"),s(this,"AYCB",!1),s(this,"nLxg",!1),s(this,"UOhg",void 0),s(this,"timeForKPI",void 0),s(this,"kpiIndex",0),s(this,"IrNj",void 0),s(this,"_across_sessions",!1),s(this,"PxEO",void 0),s(this,"mlpv",!1),s(this,"MjIw",void 0),s(this,"NnJV",void 0),s(this,"beXW",void 0),s(this,"VRMT",void 0),s(this,"Dyyn",void 0),s(this,"fstJ",void 0),s(this,"xnvh",void 0),s(this,"mZLV",void 0),s(this,"mTug",void 0),s(this,"oMWr",void 0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t,n;if(!p(e._id))return ue.error("No Id"),!1;if(!p(e.enabled)||!e.enabled)return ue.error("Not enabled"),!1;if(!(i.pGci.parse(e)&&i.Lvcl.parse(e)&&i.qQkV.parse(e)&&i.VYuU.parse(e)&&i.BMkZ.parse(e)&&i.qlpq.parse(e)&&i.KmtX.parse(e)))return!1;if(i._variant_code=i.pGci._isExperiment||i.pGci._only_context?null===(t=i.pGci._attr)||void 0===t?void 0:t.apx_variant_code:"TG",i._across_sessions=!(null==e||!e.across_sessions)&&(null==e?void 0:e.across_sessions),i.enable_conditions=null==e?void 0:e.enable_conditions,i.enable_conditions_v2=null==e?void 0:e.enable_conditions_v2,!p(e.conditions)||!Array.isArray(e.conditions))return ue.error("No valid conditions",e.conditions),!1;i.VUbd=e._id,i.qhyM=!!p(e.sequence_enabled)&&e.sequence_enabled,p(e.conditions_v2)&&i.enable_conditions_v2&&(i.qhyM=null==e?void 0:e.sequence_type),!0===i.qhyM&&e.conditions.sort((function(e,t){return e.sequence<t.sequence})),p(e.conditions_v2)&&i.enable_conditions_v2?(n=e.conditions_v2,i.mlpv=!0):n=e.conditions,i.PxEO=n;var r=n.length,o=null==e?void 0:e.no_context_enabled;if(0===r&&o&&setTimeout((function(){i.TiBh()}),10),i.oMWr=r,i.wYhI(n,r),i.spDq(),i.qlpq.enable_goal_events)for(var a=e.terminate_info.goal_events.events,s=a.length,l=0;l<s;l++){var u=new K;u.initialize(a[l],i.VUbd,l,!0,[],i._across_sessions,"termination")&&i.uxJj.push(u)}return i.hgPb.length>0}catch(e){return ue.error(e),!1}})),s(this,"wYhI",(function(e,t){for(var n=function(){i.qgYS=[];var t=e[r];if("group"===(null!=t&&t.condition_type?null==t?void 0:t.condition_type:"single")){var n=t.conditions_v2;i.groupCombineOperator=t.combine_operator;var o=null==t?void 0:t.sequence_type;i.mTug=new W;var a=i.mTug.initialize(n,i.VUbd,r,o,i.qgYS,i.qhyM,i._across_sessions);i.hgPb.push(a)}else{if("didn't"===t.type){var s,l={trigger_key:t.trigger.details.name,no_kpi_array:null==t||null===(s=t.details)||void 0===s||null===(s=s.additional_info)||void 0===s?void 0:s.nkpi,condition_id:null==t?void 0:t._id,time_bounds:t.time_bounds.upper};i.qgYS=[].concat(u(i.qgYS),[l])}if(i.mTug=new K,i.mTug.initialize(t,i.VUbd,r,i.qhyM,i.qgYS,i._across_sessions)){i.hgPb.push(i.mTug);var d=(null==t?void 0:t.timeout)/(null==t?void 0:t.findinterval),v=(null==t?void 0:t.frameid)||"",c=null==t?void 0:t.url;window.location.href===c&&"view_visibility"===t.event_type&&!0===A(t.view_id,v,null==t?void 0:t.enable_retry,null==t?void 0:t.findinterval,d)&&i.TiBh(!0),window.addEventListener("navigate",(function(e){var n=null==t?void 0:t.url;window.location.href===n&&"view_visibility"===t.event_type&&!0===A(t.view_id,v,null==t?void 0:t.enable_retry,null==t?void 0:t.findinterval,d)&&i.TiBh(!0)}))}}},r=0;r<t;r++)n()})),s(this,"spDq",(function(){if(i._across_sessions&&"ordered"===i.qhyM){var t=!1,n=e.getController().getFromStorage("apx_nokpi_triggerdetails");if(null!=(n=JSON.parse(n))&&null!=n)for(var r=function(e){var r,o,a;if(null!==(r=i.hgPb[e])&&void 0!==r&&null!==(r=r.zSNz)&&void 0!==r&&r._timeEnabled&&void 0===i.hgPb[e].length){if("didn't"===i.hgPb[e].zSNz.BXPw){var s=i.hgPb[e].zSNz._id,l=i.FRXA(s,n);if(l)if(Date.now()>l.finishTime)i.hgPb[e].HiCs=!0,i.hgPb[e].OKRM=l.satisfiedCount,t=!0;else{var u=l.finishTime-Date.now(),d=i.hgPb[e].zSNz._eventCategory?i.hgPb[e].zSNz._eventCategory:"specific_event",v=new he;"specific_event"===d?(v.registerForEvent(b(i.hgPb[e].zSNz.XsXn)+"___"+i.hgPb[e].zSNz.BFoD.IDYQ,i.tdSG),i.Dyyn=i.hgPb[e]):i.VeZE(d),setTimeout((function(){e!==i.hgPb.length-1||i.AYCB||(i.hgPb[e].HiCs=!0,i.hgPb[e].OKRM=l.satisfiedCount,t=!0,"specific_event"===d?v.unregisterFromEvent(b(i.hgPb[e].zSNz.XsXn)+"___"+i.hgPb[e].zSNz.BFoD.IDYQ,i.tdSG):i.aALC(i.hgPb[e]),i.TiBh())}),u)}}if("did"===i.hgPb[e].zSNz.BXPw){var c=i.hgPb[e].zSNz._id,g=i.FRXA(c,n);if(g)if(null==g.satisfiedCount){if(Date.now()<g.finishTime){i.beXW=g,i.NnJV=e;var f=g.finishTime-Date.now(),h=i.hgPb[e].zSNz._eventCategory?i.hgPb[e].zSNz._eventCategory:"specific_event",_=new he;"specific_event"===h?_.registerForEvent(b(i.hgPb[e].zSNz.XsXn)+"___"+i.hgPb[e].zSNz.BFoD.IDYQ,i.FQzY):i.VeZE(h),setTimeout((function(){"specific_event"===h?_.unregisterFromEvent(b(i.hgPb[e].zSNz.XsXn)+"___"+i.hgPb[e].zSNz.BFoD.IDYQ,i.FQzY):i.aALC(i.hgPb[e])}),f)}}else i.hgPb[e].OKRM=g.satisfiedCount,i.hgPb[e].HiCs=!0}}else t=i.FRiY(e,n);t&&(null===(o=i.hgPb[e])||void 0===o||null===(o=o.zSNz)||void 0===o||!o._timeEnabled||(null===(a=i.hgPb[e])||void 0===a?void 0:a.length)>1)?e===i.hgPb.length-1&&i.TiBh():t||void 0===!i.hgPb[e].length&&i.hgPb[e].SuzN()},o=0;o<i.hgPb.length;o++)r(o)}else if(i._across_sessions&&"unordered"===i.qhyM){var a=e.getController().getFromStorage("apx_nokpi_triggerdetails");if(null!=(a=JSON.parse(a))&&null!=a)for(var s=0;s<i.hgPb.length;s++)i.FRiY(s,a)}})),s(this,"FRiY",(function(e,t){if(void 0===i.hgPb[e].length||1===i.hgPb[e].length){var n=i.hgPb[e].zSNz._id,r=!1,o=i.FRXA(n,t);if(o)i.MjIw=o,r=(new K).Awux(o.satisfiedCount,i.hgPb[e].zSNz.xdxj,i.hgPb[e].zSNz.bNmx),o&&(r?i.hgPb[e].HiCs=!0:i.hgPb[e].OKRM=o.satisfiedCount);else i.hgPb[e].SuzN();return r}if(i.hgPb[e].length>=1){var a,s,l;if("ordered"===(s=null===(a=i.hgPb[e])||void 0===a?void 0:a.sequence_type)||"strictly_ordered"===s){for(var u=0;u<i.hgPb[e].length;u++){var d=i.hgPb[e][u],v=d.zSNz._id;l=!1;var c=i.FRXA(v,t);if(c){if(l=(new K).Awux(c.satisfiedCount,d.zSNz.xdxj,d.zSNz.bNmx),c)if(l){i.hgPb[e][u].HiCs=!0;var g=u+1,f=i.hgPb[e][u+1];void 0===f&&p(i.hgPb[e+1])&&(i.hgPb[e+1].SuzN(),l=!0),null!=f&&i.hgPb[e][u+1].SuzN(g)}else i.hgPb[e][u].OKRM=c.satisfiedCount}else(p(i.hgPb[e][u-1])&&!0===i.hgPb[e][u].HiCs||h(i.hgPb[e][u-1]))&&i.hgPb[e][u].SuzN()}return l}for(var _,m=0;m<i.hgPb[e].length;m++){var y=i.hgPb[e][0].zSNz.QuLr;_="OR"!==y;var z=i.hgPb[e][m],S=z.zSNz._id;l=!1;var b=i.FRXA(S,t);if(b)l=(new K).Awux(b.satisfiedCount,z.zSNz.xdxj,z.zSNz.bNmx),b&&(l?i.hgPb[e][m].HiCs=!0:i.hgPb[e][m].OKRM=b.satisfiedCount);else z.SuzN();_="AND"===y?_&&l:_||l}return _}})),s(this,"FRXA",(function(e,t){return t.find((function(t){return t.id===e}))})),s(this,"OUOz",(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=he.getInstance();if(!(t<0)){var o=i.hgPb[t],a="unordered";if((null==o?void 0:o.length)>1&&(a=null==o?void 0:o.sequence_type),!0===i.qhyM||"ordered"===i.qhyM||"strictly_ordered"===i.qhyM||"ordered"===a||"strictly_ordered"===a){i.kpiIndex=t+1;var s=i.hgPb[t];if((null==s?void 0:s.length)>0){if(p(s))if("unordered"===i.qhyM&&"ordered"===a){var l=o[n-1];if(p(l))if(void 0===l.length||1==l.length){if(!l.HiCs)return}else if(l.length>1&&!i.TRZe(l))return;var u,d=o[n+1];if(p(d)){if(d.SuzN(n+1),"strictly_ordered"===i.qhyM){i._currentEventname=s[n].zSNz.BFoD.IDYQ;var v=e.getController();v.registerForEvent("APP_EVENT",i.Uwvr),v.registerForEvent("CLIENT_EVENT",i.Uwvr)}}else if("strictly_ordered"===a)1!=i.NeOo&&i.TiBh();else(null===(u=o[n])||void 0===u?void 0:u.length)>0?i.TRZe(o)&&i.TiBh():i.TiBh()}else{var g,f=i.hgPb[t-1];if(p(f))if(void 0===f.length||1==f.length){if(!f.HiCs)return}else if(f.length>1&&!i.TRZe(f))return;if(void 0===s.length||1===s.length?g=i.hgPb[t+1]:s.length>1&&("ordered"===a||"strictly_ordered"===a?g=n===s.length-1?i.hgPb[t+1]:i.hgPb[t][n+1]:i.TRZe(s)&&(g=i.hgPb[t+1])),p(g)){if(void 0===g.length||1===g.length)g.SuzN(n+1);else if(i.TRZe(s))if(void 0===g.length)g.SuzN();else if(g.length>1)if("unordered"===g.sequence_type)for(var h=0;h<g.length;h++)g[h].SuzN(h);else"ordered"!==g.sequence_type&&"strictly_ordered"!==g.sequence_type||g[0].SuzN(0);if("strictly_ordered"===i.qhyM){i._currentEventname=s[n].zSNz.BFoD.IDYQ;var _=e.getController();_.registerForEvent("APP_EVENT",i.Uwvr),_.registerForEvent("CLIENT_EVENT",i.Uwvr)}}else"strictly_ordered"===i.qhyM?1!=i.NeOo&&i.TiBh():i.TRZe(s)&&i.TiBh()}}else if(p(s)&&s.HiCs){s.yYUQ[s.zSNz.BFoD.IDYQ]=Date.now();var m=i.hgPb[t-1];if(p(m))if(void 0===m.length||1==m.length){if(!m.HiCs)return}else if(m.length>1&&!i.TRZe(m))return;var y=i.hgPb[t+1];if(p(y)){var z,S;if(null!=y&&null!==(z=y.zSNz)&&void 0!==z&&z._timeEnabled){if("session"!=(null===(S=y.zSNz)||void 0===S?void 0:S._time.unit)){var N,D,w=C(y.zSNz._time.unit,y.zSNz._time.value);if("didn't"==(null===(N=y.zSNz)||void 0===N?void 0:N.BXPw)){if(i.xnvh=setTimeout((function(){if(i.AYCB)i.AYCB=!1;else{if(i.AYCB=!1,y.HiCs=!0,y.HiCs){y.OKRM+=1;var e=new K;if(y.HiCs=e.Awux(y.OKRM,y.zSNz.xdxj,y.zSNz.bNmx),y.HiCs){y.zSNz.PBnM=Date.now();var n=t+1,o=i.hgPb[n+1];p(o)?o.SuzN():i.TiBh()}}r.unregisterFromEvent(b(y.zSNz.XsXn)+"___"+y.zSNz.BFoD.IDYQ,i.tdSG),y.DEgU=!1}}),w),i._across_sessions){var x=C(y.zSNz._time.unit,y.zSNz._time.value),E=y.zSNz._timeEnabled,F=y.zSNz._id,A=new K;A.doGY(y.zSNz.BXPw,y.zSNz.BFoD.IDYQ,Date.now(),y.zSNz.BFoD.rAgK,x,E,F)}"specific_event"===y.zSNz._eventCategory?(r.registerForEvent(b(y.zSNz.XsXn)+"___"+y.zSNz.BFoD.IDYQ,i.tdSG),i.Dyyn=y):i.VeZE(y)}else if("did"==(null===(D=y.zSNz)||void 0===D?void 0:D.BXPw)&&(i.AYCB=!1,i.IrNj=y,p(i.hgPb[t+2])&&i._across_sessions&&(i.VRMT=i.hgPb[t+2]),i.mZLV=setTimeout((function(){i.AYCB?i.AYCB=!1:(i.AYCB=!1,r.unregisterFromEvent(b(y.zSNz.XsXn)+"___"+y.zSNz.BFoD.IDYQ,i.OrXT))}),w),i.UOhg=s,i.timeForKPI=w,r.registerForEvent(b(y.zSNz.XsXn)+"___"+y.zSNz.BFoD.IDYQ,i.OrXT),i.fstJ=y,i._across_sessions)){var B=C(y.zSNz._time.unit,y.zSNz._time.value),P=y.zSNz._timeEnabled,T=y.zSNz._id,I=new K;I.doGY(y.zSNz.BXPw,y.zSNz.BFoD.IDYQ,Date.now(),y.zSNz.BFoD.rAgK,B,P,T)}}}else if(y.length>0)if("ordered"===y.sequence_type||"strictly_ordered"===y.sequence_type)y[0].SuzN(n+1);else{var X,O=c(y);try{for(O.s();!(X=O.n()).done;){var G=X.value;G.SuzN()}}catch(e){O.e(e)}finally{O.f()}}else y.SuzN();if("strictly_ordered"===i.qhyM){i._currentEventname=s.zSNz.BFoD.IDYQ;var L=e.getController();L.registerForEvent("APP_EVENT",i.Uwvr),L.registerForEvent("CLIENT_EVENT",i.Uwvr)}}else"strictly_ordered"===i.qhyM?1!=i.NeOo&&i.TiBh():i.TiBh()}}else i.uAFB(),i.TiBh()}})),s(this,"Uwvr",(function(e){e&&e.name!=i._currentEventname&&(i.NeOo=!0)})),s(this,"VeZE",(function(e){var t=new he,n=e.zSNz._eventCategory;"apxor_event"===n?t.registerForEvent("apxor_event",i.tdSG):"customer_event"===n?t.registerForEvent("customer_event",i.tdSG):"any_event"===n?t.registerForEvent("any_event",i.tdSG):"campaign_event"===n?t.registerForEvent("campaign_event",i.tdSG):"survey_event"===n&&t.registerForEvent("survey_event",i.tdSG)})),s(this,"aALC",(function(e){var t=new he,n=e.zSNz._eventCategory;"apxor_event"===n?t.unregisterFromEvent("apxor_event",i.tdSG):"customer_event"===n?t.unregisterFromEvent("customer_event",i.tdSG):"any_event"===n?t.unregisterFromEvent("any_event",i.tdSG):"campaign_event"===n?t.unregisterFromEvent("campaign_event",i.tdSG):"survey_event"===n&&t.unregisterFromEvent("survey_event",i.tdSG)})),s(this,"tdSG",(function(){var e,t;i.xnvh&&(i.AYCB=!1,clearTimeout(i.xnvh));var n=new he;i.AYCB=!0,i._across_sessions&&null!==localStorage.getItem("apx_nokpi_triggerdetails")&&localStorage.removeItem("apx_nokpi_triggerdetails"),n.unregisterFromEvent(b(null===(e=i.Dyyn)||void 0===e||null===(e=e.zSNz)||void 0===e?void 0:e.XsXn)+"___"+(null===(t=i.Dyyn)||void 0===t||null===(t=t.zSNz)||void 0===t||null===(t=t.BFoD)||void 0===t?void 0:t.IDYQ),i.tdSG)})),s(this,"OrXT",(function(){var t,n,r,o=new he;i.AYCB=!0,i.mZLV&&clearTimeout(i.mZLV);var a=new K;if(i.IrNj.OKRM+=1,i.IrNj.HiCs=a.Awux(i.IrNj.OKRM,i.IrNj.zSNz.xdxj,i.IrNj.zSNz.bNmx),o.unregisterFromEvent(b(null===(t=i.fstJ)||void 0===t||null===(t=t.zSNz)||void 0===t?void 0:t.XsXn)+"___"+(null===(n=i.fstJ)||void 0===n||null===(n=n.zSNz)||void 0===n?void 0:n.BFoD.IDYQ),i.OrXT),i._across_sessions&&null!==(r=i.VRMT)&&void 0!==r&&r.zSNz._timeBased){var s,l,u,d=e.getController().getFromStorage("apx_nokpi_triggerdetails");d=null==d?[]:JSON.parse(d);for(var v=0;v<d.length;v++)if(i.no_KPI_TriggerDetails[v].id===i.VRMT.zSNz._id){s=!0,l=d[v];break}if(s)l.satisfiedCount+=1;else{var c=i.IrNj.zSNz._id,g=i.IrNj.zSNz.BXPw,f=i.IrNj.zSNz.BFoD.IDYQ,h=i.IrNj.zSNz.BFoD.rAgK;u={id:c,type:g,time:Date.now(),name:f,additionalInfo:h,satisfiedCount:i.IrNj.zSNz._timeEnabled,timeBased:i.IrNj.zSNz._timeEnabled},i.no_KPI_TriggerDetails.push(u)}}if(i.IrNj.HiCs){var _=i.hgPb[i.kpiIndex+1];p(_)?_.SuzN():i.TiBh()}})),s(this,"FQzY",(function(){if(i.NnJV===i.hgPb.length-1){i.nLxg=!0;i.hgPb[i.NnJV]&&(i.hgPb[i.NnJV].OKRM=i.beXW.satisfiedCount,i.hgPb[i.NnJV].HiCs=!0,i.TiBh())}else{var t,n,r=e.getController().getFromStorage("apx_nokpi_triggerdetails");r=null==r?[]:JSON.parse(r);for(var o=0;o<r.length;o++)if(r[o].id===i.NnJV){n=!0,t=r[o];break}if(n&&(t.satisfiedCount=1),e.getController().persistToStorage("apx_nokpi_triggerdetails",JSON.stringify(r)),i.hgPb[i.NnJV].OKRM=i.beXW.satisfiedCount,i.hgPb[i.NnJV].HiCs=!0,i.hgPb[i.NnJV+1].zSNz._timeEnabled){var a=C(i.hgPb[i.NnJV+1].zSNz._time.unit,i.hgPb[i.NnJV+1].zSNz._time.value),s=i.hgPb[i.NnJV+1].zSNz._timeEnabled,l=i.hgPb[i.NnJV+1].zSNz._id,u=i.hgPb[i.NnJV+1].OKRM,d=i.hgPb[i.NnJV+1].zSNz.BFoD.IDYQ,v=i.hgPb[i.NnJV+1].BFoD.rAgK;(new K).doGY(i.zSNz.BXPw,d,Date.now(),v,a,s,l,u)}}})),s(this,"uAFB",(function(){if(i._across_sessions&&i.mlpv){var t,n,r,o="single",a=!1,s=e.getController().getFromStorage("apx_nokpi_triggerdetails");if((s=JSON.parse(s)).length>0){var l,u=c(s);try{var d=function(){var e=l.value,s=e.id,u=e.satisfiedCount;if(t=i.hgPb.find((function(e,t){if(1===(null==e?void 0:e.length)||void 0===(null==e?void 0:e.length)){if(e.zSNz._id===s)return o="single",n=t,!0}else if(e.length>0){var i=e.findIndex((function(e){return e.zSNz._id===s}));if(-1!==i)return n=t,r=i,o="group",!0}return!1})),"single"===o&&t){var d=new K;a=d.Awux(u,t.zSNz.xdxj,t.zSNz.bNmx);var v=i.hgPb.findIndex((function(e){var t;return(null==e||null===(t=e.zSNz)||void 0===t?void 0:t._id)===s}));void 0===v&&(v=n),a&&(i.hgPb[v].HiCs=!0)}else if("group"===o&&t){var c=new K;(a=c.Awux(u,t[r].zSNz.xdxj,t[r].zSNz.bNmx))&&(i.hgPb[n][r].HiCs=!0)}};for(u.s();!(l=u.n()).done;)d()}catch(e){u.e(e)}finally{u.f()}}}})),s(this,"vTSs",(function(e){e<0||i.DXkZ()})),s(this,"TiBh",(function(){var t,r,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.getController().getUserAttributes(),s=e.getController().getSessionAttributes();if(null!==(t=window.ApxorRTM)&&void 0!==t&&t.isBadgePresent&&null!==(r=window.ApxorRTM)&&void 0!==r&&r.badgesLists.includes(i.VUbd)&&e.getController().isBadgeTriggerSatisfied(i.VUbd)||null==e||e.logEvent("apx_trigger_satisfied",{apx_nudge_type:"SURVEY"===i.pGci.BXPw?"survey":"campaign",apx_nudge_id:i.VUbd,apx_nudge_name:i.pGci.IDYQ,apx_variant_code:i.pGci._isExperiment||i.pGci._only_context?i.pGci._attr.apx_variant_code:"TG"}),!(i.Lvcl.validate()&&i.VYuU.validate(a,s)&&i.BMkZ.validate()&&i.KmtX.validate())){i.pGci.BXPw;return i.BMkZ.retainedDaysValidated?i.BMkZ.retainedSessionValidated?i.BMkZ.eventDoneInLT?void i.wqvJ("Event done in life time"):i.VYuU.userAttributesValidated?i.VYuU.sessionAttributeValidated?i.Lvcl._not_in_specified_time?void i.wqvJ("Time limits check failed"):i.Lvcl._not_yet_active?void i.wqvJ("not in the scheduled time"):i.Lvcl._nudge_expired?void i.wqvJ("nudge expired"):void 0:void i.wqvJ("Session property filter not met"):void i.wqvJ("User property filter not met"):void i.wqvJ("User session criteria not met"):void i.wqvJ("Retained day criteria not met")}var l=i.hgPb.length,u=l<1,d="";0===l&&(u=!0);for(var v=0;v<l;v++){var g=void 0,f=i.hgPb[v];if(f.length>1){var h=f[0].zSNz.QuLr;g="AND"===h;for(var _=0;_<f.length;_++){var p=f[0].zSNz.QuLr;g="AND"===p?g&&f[_].HiCs:g||f[_].HiCs}}else g=f.HiCs;if(""===d.trim())u=g;else switch(d){case"AND":u=u&&g;break;case"OR":u=u||g}d=f.length>1?i.groupCombineOperator:f.QuLr}if(!0===o&&(u=!0),u){var m,y;if(console.debug("onCondition satisfied"),!i.qQkV.RfHJ(i.VUbd))return void console.warn("Maximum limit reached",i.VUbd);if(!(null!==(m=window.ApxorRTM)&&void 0!==m&&m.isBadgePresent&&null!==(y=window.ApxorRTM)&&void 0!==y&&y.badgesLists.includes(i.VUbd)&&e.getController().isBadgeTriggerSatisfied(i.VUbd))){var z="SURVEY"===i.pGci.BXPw?"survey":"campaign";null==e||e.logEvent("apx_trigger_satisfied",{apx_nudge_type:"SURVEY"===i.pGci.BXPw?"survey":"campaign",apx_nudge_id:i.VUbd,apx_nudge_name:i.pGci.IDYQ,apx_variant_code:i.pGci._isExperiment||i.pGci._only_context?i.pGci._attr.apx_variant_code:"TG"},!1,"",z)}i._across_sessions&&localStorage.removeItem("apx_nokpi_triggerdetails");var S,b=c(i.hgPb);try{for(b.s();!(S=b.n()).done;){var N=S.value;if(1===(null==N?void 0:N.length)||void 0===(null==N?void 0:N.length))N.HiCs=!1,N.OKRM=0;else{var D,w=c(N);try{for(w.s();!(D=w.n()).done;){var x=D.value;x.HiCs=!1,x.OKRM=0}}catch(e){w.e(e)}finally{w.f()}}}}catch(e){b.e(e)}finally{b.f()}if(i.mTug.zDFd(i.hgPb),i.hgPb=[],i.wYhI(i.PxEO,i.oMWr),!0===i.pGci._only_context){var E="SURVEY"===i.pGci.BXPw?"survey":"campaign";e.logEvent("apx_context_evaluated",n(n({},i.pGci._attr),{},{message_name:i.pGci.IDYQ,id:i.VUbd}),!1,"",E)}e.getController().dispatchEvent(i.pGci.BXPw,{name:i.pGci.BXPw,additional_info:{uuid:i.VUbd,name:i.pGci.IDYQ}})}})),s(this,"DXkZ",(function(){for(var t=i.uxJj.length,r=t<1,o="",a=0;a<t;a++){var s=i.uxJj[a],l=s.HiCs;if(""===o.trim())r=l;else switch(o){case"AND":r=r&&l;break;case"OR":r=r||l}o=s.Hnya}if(r){if(e.getController().persistTerminationInfoLocally(i.VUbd),!0===i.pGci._only_context){var u="SURVEY"===i.pGci.BXPw?"survey":"campaign";e.logEvent("apx_context_evaluated",n(n({},i.pGci._attr),{},{message_name:i.pGci.IDYQ,id:i.VUbd}),!1,"apxor",u)}e.getController().dispatchEvent(i.pGci.BXPw,{name:i.pGci.BXPw,additional_info:{uuid:i.VUbd,name:i.pGci.IDYQ}})}})),s(this,"validateForTerminationAttributes",(function(){var t=e.getController().getUserAttributes(),n=e.getController().getSessionAttributes();return i.qlpq.validate(t,n)})),s(this,"NByB",(function(){i.qQkV.NByB()})),s(this,"getFrequencyCount",(function(){return i.qQkV.getFrequencyCount()})),s(this,"JMuT",(function(){return i.qQkV.gTCR()})),s(this,"TRZe",(function(e){var t;t="AND"===e[0].zSNz.QuLr;for(var n=0;n<e.length;n++){t="AND"===e[0].zSNz.QuLr?t&&e[n].HiCs:t||e[n].HiCs}return t})),s(this,"wqvJ",(function(t){var n;null==e||e.logEvent("apx_non_eligible_user",{apx_nudge_type:"SURVEY"===i.pGci.BXPw?"survey":"campaign",apx_nudge_id:i.VUbd,apx_nudge_name:i.pGci.IDYQ,apx_variant_code:i.pGci._isExperiment||i.pGci._only_context?null===(n=i.pGci._attr)||void 0===n?void 0:n.apx_variant_code:"TG",apx_failure_type:"warn",apx_reason:t})}))})),ve=a((function e(){var t=this;r(this,e),s(this,"pgDH",{}),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{configs:[]};if(p(e)&&p(e.configs)){var n=e.configs;if(!Array.isArray(n))return;n.sort((function(e,t){var n,i;return(null!==(n=e.prio)&&void 0!==n?n:-1)-(null!==(i=t.prio)&&void 0!==i?i:-1)}));for(var i=0;i<n.length;i++){var r=n[i],o=r._id,a=new de;a.parse(r)?t.pgDH[o]=a:console.warn("Failed to parse cfg",o)}}})),s(this,"validate",(function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t.pgDH[e]){var r=t.pgDH[e];r.OUOz(n,i)}})),s(this,"getVariantCode",(function(e){return t.pgDH[e]?t.pgDH[e]._variant_code:""})),s(this,"validateForTermination",(function(e,n){t.pgDH[e]&&t.pgDH[e].vTSs(n)})),s(this,"validateForTerminationAttributes",(function(e){return!!t.pgDH[e]&&t.pgDH[e].validateForTerminationAttributes()})),s(this,"NByB",(function(e){t.pgDH[e].NByB()})),s(this,"getFrequencyCount",(function(e){var n=t.pgDH[e];if(null!=n)return n.getFrequencyCount()})),s(this,"resetFrequencyCounts",(function(){var e=t.pgDH;for(var n in e)e[n].JMuT()})),s(this,"Eoth",(function(e){try{if(t.pgDH){var n=t.pgDH[e];if(n&&n.pGci)return n.pGci}}catch(e){console.log("Error in getting the campaign meta ".concat(e))}return{}}))})),ce=window.ApxorLogger,ge=a((function t(){var n=this;r(this,t),s(this,"qPjw",{}),s(this,"bKOn",[]),s(this,"IRXu",!1),s(this,"initialize",(function(){var t=e.getController();t.registerForEvent("APP_EVENT",(function(e){return n.cocc(e,"AE")})),t.registerForEvent("CLIENT_EVENT",(function(e){return n.cocc(e,"CE")}))})),s(this,"HirX",(function(){for(var e in n.bKOn)n.PHoD(e.event,e.key,e.type);n.IRXu=!0})),s(this,"uzco",(function(e,t){var i;"function"==typeof t&&((i=n.qPjw[e]?n.qPjw[e]:[]).push(t),n.qPjw[e]=i,ce.debug("Listeners list: ",n.qPjw))})),s(this,"unregisterFromEvent",(function(e,t){if(n.qPjw[e]){for(var i=n.qPjw[e],r=[],o=0;o<i.length;o++){var a=i[o];a!==t&&r.push(a)}n.qPjw[e]=r}})),s(this,"cocc",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AE";n.PHoD(e,"any_event",t),"apxor"===(null==e?void 0:e.loggedBy)?n.PHoD(e,"apxor_event",t):"customer"===(null==e?void 0:e.loggedBy)&&n.PHoD(e,"customer_event",t),"campaign"===(null==e?void 0:e.apx_nudge_type)?n.PHoD(e,"campaign_event",t):"survey"===(null==e?void 0:e.apx_nudge_type)&&n.PHoD(e,"survey_event",t);var i=t+"___"+e.name;n.PHoD(e,i,t)})),s(this,"PHoD",(function(t,i,r){if(n.IRXu){if(ce.debug("Notifying listeners for event: "+t+", "+i,n.qPjw),n.qPjw[i])for(var o=n.qPjw[i],a=e.getController().getSDKRunningTimeInSec(),s=0;s<o.length;s++){(0,o[s])(r,t.name,a,t.additional_info)}}else n.bKOn.push({event:t,key:i,type:r})}))})),fe=window.ApxorLogger,he=function(){function t(){var n=this;return r(this,t),s(this,"Ymha",!1),s(this,"udvP",null),s(this,"Ufwz",x()),s(this,"gRyI",new ge),s(this,"sZvB",e.getSiteId()),s(this,"TGMD",{}),s(this,"getQeState",(function(){try{var t=e.getController().getFromStorage("qe_state");return t?JSON.parse(z(n.sZvB,t)):(n.TGMD={},n.setQeState())}catch(e){return n.TGMD={},n.setQeState()}})),s(this,"setQeState",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{e.getController().persistToStorage("qe_state",n.TGMD,!0)}catch(i){""===t?n.TGMD={}:n.TGMD[t]={SESSION:0,OVERALL:0,DATES:{}},e.getController().persistToStorage("qe_state",n.TGMD,!0)}return n.TGMD})),s(this,"initialize",(function(){n.Ymha||(n.Ymha=!0,n.udvP=new ve,n.gRyI.initialize(),n.TGMD=n.getQeState(),fe.info("QE Initialized.."))})),s(this,"parse",(function(e){n.HshW()?(n.udvP.parse(e),n.gRyI.HirX()):fe.warn("Must call init first. Unable to proceed")})),s(this,"validate",(function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;n.HshW()&&n.udvP.validate(e,t,i)})),s(this,"getVariantCode",(function(e){return n.udvP.getVariantCode(e)})),s(this,"validateForTermination",(function(e,t){n.HshW()&&n.udvP.validateForTermination(e,t)})),s(this,"validateForTerminationAttributes",(function(e,t){return n.udvP.validateForTerminationAttributes(e,t)})),s(this,"updateCount",(function(e){try{p(n.TGMD[e])||n.createObjConfig(e),n.incrementFrequencies(e),n.setQeState(e),n.udvP.NByB(e)}catch(e){console.log("Could not update the count config:".concat(e))}})),s(this,"resetFrequencyCounts",(function(){n.udvP.resetFrequencyCounts()})),s(this,"getFrequencyCount",(function(e){return n.udvP.getFrequencyCount(e)})),s(this,"registerForEvent",(function(e,t){n.gRyI.uzco(e,t)})),s(this,"unregisterFromEvent",(function(e,t){n.gRyI.unregisterFromEvent(e,t)})),s(this,"notifyEventListener",(function(e){n.gRyI.cocc(e)})),s(this,"fetch",(function(t,n,i,r){e.getController().fetchConfiguration(t,n,i,r)})),s(this,"HshW",(function(){return n.Ymha})),s(this,"getCampaignMetaFromQueryEngine",(function(e){return n.udvP.Eoth(e)})),s(this,"Gils",(function(){return n.Ufwz})),t.instance||(t.instance=this),t.instance}return a(t,[{key:"createObjConfig",value:function(e){try{this.TGMD=this.getQeState(),p(this.TGMD[e])||(this.TGMD[e]={SESSION:0,OVERALL:0,DATES:{}},this.Ufwz&&(this.TGMD[e].DATES[this.Ufwz]=0),this.setQeState(e))}catch(e){fe.error("Can not create the frequency count object:"+e)}}},{key:"incrementFrequencies",value:function(e){this.TGMD=this.getQeState();var t=this.TGMD[e];t.SESSION=t.SESSION+1,t.OVERALL=t.OVERALL+1;var n=x();n===this.Ufwz&&t.DATES&&t.DATES[n]||(this.Ufwz=n,t.DATES={},t.DATES[this.Ufwz]=0),t.DATES[this.Ufwz]=t.DATES[this.Ufwz]+1}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}]),t}();s(he,"instance",void 0),window.ceVersion=180;try{void 0===exports&&null===exports||(exports.default=he,module.exports=exports.default)}catch(e){}return he}));
