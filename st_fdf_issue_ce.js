!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("apxor")):"function"==typeof define&&define.amd?define(["apxor"],t):(e=e||self)["apxor-qe"]=t(e.Apxor)}(this,(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function n(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,d(i.key),i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function d(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var h=window.ApxorLogger,g=function(e){return void 0===e},f=function(e){return void 0!==e&&!function(e){return null===e}(e)},_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function m(e,t){return Array.from(t).map((function(t,n){return String.fromCharCode(t^function(e,t){return e.charCodeAt(Math.floor(t%e.length))}(e,n))})).join("")}var p=function(e,t){return m(e,t=function(e){var t,n,i,r,o,a,s=0,l=[];if(!e)return e;e+="";do{t=(a=_.indexOf(e.charAt(s++))<<18|_.indexOf(e.charAt(s++))<<12|(r=_.indexOf(e.charAt(s++)))<<6|(o=_.indexOf(e.charAt(s++))))>>16&255,n=a>>8&255,i=255&a,l.push(t),64!==r&&(l.push(n),64!==o&&l.push(i))}while(s<e.length);return l}(t))},y=function(e){switch(e){case"app_event":return"AE";case"client_event":return"CE";case"activity_time":case"activity_event":return"AE";case"apxor_event":return"AEV";case"customer_event":return"CEV";case"any_event":return"ANV";case"campaign_event":return"CNV";case"survey_event":return"SVE"}return"Unknown"},F=function(e){return e.toUpperCase()},S=function(e,t,n){switch(n){case"EQ":return e===t;case"GT":return e>t;case"GTE":return e>=t;case"LT":return e<t;case"LTE":return e<=t;case"NEQ":return e!==t;case"R":return N(t).test(e);default:return!1}},T=function(e,t){switch(e){case"second":return 1e3*t;case"minute":return 60*t*1e3;case"hour":return 60*t*60*1e3;case"day":return 24*t*60*60*1e3;default:return 1}},N=function(e){var t=e.replace(/.*\/([gimuy]*)$/,"$1");t===e&&(t="");var n=t?e.replace(new RegExp("^/(.*?)/"+t+"$"),"$1"):e;return new RegExp(n,t)},E=function(){var e=new Date;return e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear()},L=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e||!t||!n)return!1;var r=n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),o=t.replace(new RegExp(r,"g"),"(.+)"),a=i?"^".concat(o):"".concat(o,"$"),s=new RegExp(a);return s.test(e)};function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,o=C(e,t);if(o){var a=function(){if(I(o)){return function(e){return O(e)}(o)}return h.info("Invalid target element. Width and height are 0 for element: ".concat(e,". Can't show tooltip")),!1};return a()}return n?(h.info("Not found yet. Rechecking the DOM."),b(r,i,e,t)):(h.info("Element with selector:".concat(e," not found.")),!1)}function b(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=setInterval((function(){var t=C(n,i);if(t){clearInterval(r);!function(){if(I()){O()}else h.info("Invalid target element. Width and height are 0 for element: ".concat(n,". Can't show tooltip"))}()}else(e-=1)<=0&&(clearInterval(r),console.warn("Element with selector:".concat(n," not found.")))}),t)}var C=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=document.getElementById(e);if(!i)try{i=document.querySelector(e)}catch(e){window.ApxorLogger.error("Error finding element in DOM:"+e)}(i||(i=w(e)),!i&&n.length>0)&&(i=null===(t=document.getElementById(n))||void 0===t||null===(t=t.contentWindow)||void 0===t||null===(t=t.document)||void 0===t?void 0:t.querySelector(e));return i},w=function(e){var t=e.indexOf("svg");-1!==t&&(e=e.substring(0,t)+"svg:svg");try{return document.TkUE(e,document,(function(e){return"svg"===e?"http://www.w3.org/2000/svg":null}),XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(e){window.ApxorLogger.error("Error finding element in DOM:"+e)}return null};function I(e){try{var t=e.getBoundingClientRect();if(0===t.width||0===t.height)return!1}catch(e){return!1}return!0}function O(e){var t,n,i,r;return!!(n=(t=e).offsetHeight,i=t.offsetWidth,(r=t.getBoundingClientRect()).left>=-i&&r.top>=-n&&r.right<=(window.innerWidth||document.documentElement.clientWidth)+i&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)+n)}var Y=function(e){var t='\n        <style> \n          .apx-container{\n            padding:10px;\n          }\n        </style>\n        <div id="apx-innerElement" class="apx-container">\n              <div id="close-button" style="cursor: pointer;position:absolute;top:9px;right:9px;"><svg width="11" height="11" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path opacity="0.5" d="M11.0962 9.07071L17.8586 15.8331L15.8331 17.8586L9.0707 11.0962L8.99999 11.0255L8.92928 11.0962L2.16693 17.8586L0.141421 15.8331L6.90379 9.07071L6.9745 9L6.90379 8.92929L0.141421 2.16694L2.16693 0.141422L8.92928 6.9038L8.99999 6.97451L9.0707 6.9038L15.8331 0.141422L17.8586 2.16694L11.0962 8.92929L11.0255 9L11.0962 9.07071Z" fill="white" stroke="#002845" stroke-width="0.2"/>\n                </svg>\n              </div>\n              <div style="font-family: inherit;font-style: normal;font-weight: 600;font-size: 16px;line-height: 22px;\n              color: #FFFFFF; display: flex; gap: 12px;"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-check-filled" width="33" height="33" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">\n  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n  <path d="M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z" stroke-width="0" fill="currentColor" />\n</svg><div style = "align-self: center;padding-right:20px;">'.concat(e,"</div></div>\n        </div>\n      "),n=document.createElement("div");n.style="\n        z-index:99999999;\n        background:#16202f;\n        position:fixed;\n        top:1%;\n        right:1%;\n        border-radius: 12px;\n      ",n.innerHTML=t,n.id="apx-container",document.body.appendChild(n)},x=window.ApxorLogger,A=a((function t(){var n=this;r(this,t),s(this,"MlBK","ALL"),s(this,"HIcn",[]),s(this,"obYu",[]),s(this,"userAttributesValidated",!0),s(this,"sessionAttributeValidated",!0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(n.MlBK=e.audience.audience_type,n.HIcn=e.audience.attributes.user,n.obYu=e.audience.attributes.session,!Array.isArray(n.HIcn)||!Array.isArray(n.obYu))return x.error("No attributes"),!1}catch(e){return x.error(e),!1}return!0})),s(this,"validate",(function(t,i){var r=!0;"FTU"===n.MlBK&&(r=e.getController().getSessionInfo().is_first_session);var o=n.idGO(t,n.HIcn),a=n.idGO(i,n.obYu);return o||(n.userAttributesValidated=!1),a||(n.sessionAttributeValidated=!1),r&&o&&a})),s(this,"idGO",(function(e,t){var n=t.length,i=!0;try{for(var r,o=function(){var n=t[a];if(g(e[n.name])||!1===i)return{v:!1};var r=n.operator,o=n.type,s=n.value.map((function(e){if("s"===o)return e;if("l"===o)return parseInt(e);if("f"===o)return parseFloat(e);if("b"===o)switch(e){case"true":return!0;case"false":return!1;default:return e}})),l=(Array.isArray(e[n.name])?e[n.name]:[e[n.name]]).some((function(e){return s.some((function(t){return"s"===o?e="".concat(e):"l"===o?e=parseInt(e):"f"===o?e=parseFloat(e):"b"===o&&(e=!!e),S(e,t,r)}))}));i=i&&l},a=0;a<n;a++)if(r=o())return r.v}catch(e){x.error(e),i=!1}return i}))})),D=a((function e(){var t=this;r(this,e),s(this,"qlFS",""),s(this,"ZCve",{}),s(this,"nOHK",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{t.qlFS=e.name,t.ZCve=e.additional_info,t.nOHK=null==e?void 0:e.path}catch(e){return!1}return!0}))})),q=a((function e(){var t=this;r(this,e),s(this,"metp",0),s(this,"ILFC",0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(t.metp=Number(e.lower),t.ILFC=Number(e.upper),isNaN(t.metp)||isNaN(t.ILFC))return!1}catch(e){return!1}return!0}))})),B=a((function e(){var t=this;r(this,e),s(this,"VYYC",0),s(this,"ULQC",""),s(this,"DnYj",""),s(this,"nhYn",new D),s(this,"QkGS",new q),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return t.ULQC=e.event_type,t.DnYj=e.activity,t.nhYn.parse(e.details)&&t.QkGS.parse(e.time_bounds)}catch(e){return!1}}))})),K=window.ApxorLogger,M=a((function e(){var t=this;r(this,e),s(this,"VYYC",0),s(this,"vENn",-1),s(this,"ODMj",0),s(this,"GCXI",""),s(this,"DnYj",""),s(this,"ULQC",""),s(this,"QkGS",new q),s(this,"nhYn",new D),s(this,"IQAs",new B),s(this,"mhaL","AND"),s(this,"xrup",!1),s(this,"MlBK",void 0),s(this,"tMYp",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n,i;return t.vENn=null==e?void 0:e.sequence,t._conditionType=null==e?void 0:e.condition_type,t._id=null==e?void 0:e._id,t._eventCategory=null!=e&&e.event_category?null==e?void 0:e.event_category:"specific_event",t.ODMj=null==e||null===(n=e.count_config)||void 0===n?void 0:n.count,t.GCXI=null==e||null===(i=e.count_config)||void 0===i?void 0:i.operator,t.DnYj=null==e?void 0:e.activity,t.ULQC=null==e?void 0:e.event_type,t.mhaL=e.combine_operator,t._timeEnabled=null==e?void 0:e.time_enabled,t._time=null==e?void 0:e.time,t.MlBK=null==e?void 0:e.type,t.tMYp=null==e?void 0:e.route,t.nhYn.parse(null==e?void 0:e.details)&&t.IQAs.parse(e.trigger)&&t.QkGS.parse(e.time_bounds)}catch(e){return K.error(e),!1}}))})),W=window.ApxorLogger,H=a((function e(){var t=this;r(this,e),s(this,"ODMj",0),s(this,"GCXI",""),s(this,"ULQC",""),s(this,"QkGS",new q),s(this,"nhYn",new D),s(this,"mhaL","AND"),s(this,"parse",(function(e){try{return t.ODMj=e.count_config.count,t.GCXI=e.count_config.operator,t.ULQC=e.event_type,t.mhaL=e.combine_operator,t.nhYn.parse(e.details)&&t.QkGS.parse(e.time_bounds)}catch(e){return W.error(e),!1}}))})),j=window.ApxorLogger,k=function(){function t(){var n=this;r(this,t),s(this,"QyhA",0),s(this,"BeKI",""),s(this,"TFNm",new M),s(this,"GjJi",new H),s(this,"VXMj",!1),s(this,"acHb",!1),s(this,"GnfW",0),s(this,"mhaL","AND"),s(this,"dUev","OR"),s(this,"UBzm",-1),s(this,"xbwz",[]),s(this,"CXCt",{}),s(this,"JQHh",!1),s(this,"guGz",void 0),s(this,"jVat",void 0),s(this,"DhBw",void 0),s(this,"ncIf",void 0),s(this,"no_KPI_TriggerDetails",[]),s(this,"kkKa",!1),s(this,"timerDidnt",void 0),s(this,"timerDid",void 0),s(this,"initialize",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1,v=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];if(n.BeKI=i,n.GnfW=r,n.xbwz=a,n.guGz=o,n.childConditionIndex=u,n.across_sessions=s||!1,"termination"===l&&""!==l){n.GjJi.parse(t);return n.dUev=n.GjJi.mhaL,n.KpDk(),!0}var c=n.TFNm.parse(t);if(c){if(n.mhaL=n.TFNm.mhaL,n.TFNm.xrup){var d=n.TFNm.nhYn.qlFS;"APX_PAGE_OPENED"===d&&(d=n.TFNm.nhYn.ZCve.navigation_id,d=f(d)?d:n.TFNm.nhYn.qlFS),n.UBzm=e.getController().getEventCount(d);var h=n.TFNm.ODMj,g=n.TFNm.GCXI;if(n.acHb=n.Yyah(n.UBzm-1,h,g,!1),n.VXMj=n.acHb,n.acHb&&"APX_PAGE_OPENED"===n.TFNm.nhYn.qlFS)return!0}return!0===v&&(o&&0!==r&&"unordered"!==o||n.BSyW()),!0}return!1})),s(this,"BSyW",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;-1!=t&&(n.jVat=t);var i=n.TFNm,r=null!=i&&i._eventCategory?null==i?void 0:i._eventCategory:"specific_event",o=i.IQAs,a=ve.getInstance();if("app_start"===o.ULQC)if(n.VXMj=!0,null!=i&&i._timeEnabled){if("session"!=(null==i?void 0:i._time.unit)){var s=T(i._time.unit,i._time.value);if("didn't"==(null==i?void 0:i.MlBK)){if(n.JQHh=!1,console.log("in didnt"),console.log("in BSyW didn't"),n.timerDidnt=setTimeout((function(){console.log("setTimeout timer compleetd"),n.JQHh||(n.acHb=!0,n.acHb&&(n.QyhA+=1,n.acHb=n.Yyah(n.QyhA,n.TFNm.ODMj,n.TFNm.GCXI),n.acHb&&(n.TFNm.VYYC=Date.now(),a.validate(n.BeKI,n.GnfW,n.jVat))),"specific_event"===r?a.unregisterFromEvent(y(n.TFNm.ULQC)+"___"+n.TFNm.nhYn.qlFS,n.iquQ):n.pVce(r),n.VXMj=!1)}),s),n.across_sessions){var l=T(i._time.unit,i._time.value),u=i._timeEnabled,v=i._id;n.aagZ(i.MlBK,i.nhYn.qlFS,Date.now(),i.nhYn.ZCve,l,u,v)}"specific_event"===r?(a.registerForEvent(y(n.TFNm.ULQC)+"___"+n.TFNm.nhYn.qlFS,n.iquQ),n.ncIf=n.TFNm):n.SiVA(r)}else if("did"==(null==i?void 0:i.MlBK)){if(console.log("did condition"),n.timerDid=setTimeout((function(){n.kkKa||("specific_event"===r?a.unregisterFromEvent(y(n.TFNm.ULQC)+"___"+n.TFNm.nhYn.qlFS,n.gUqX):n.cWfj(r))}),s),n.across_sessions){var c=T(i._time.unit,i._time.value),d=i._timeEnabled,h=i._id;n.aagZ(i.MlBK,i.nhYn.qlFS,Date.now(),i.nhYn.ZCve,c,d,h)}"specific_event"===r?(a.registerForEvent(y(n.TFNm.ULQC)+"___"+n.TFNm.nhYn.qlFS,n.gUqX),n.DhBw=n.TFNm):n.tRPQ(r)}}}else console.log("on receive event1"),"specific_event"===r?a.registerForEvent(y(i.ULQC)+"___"+i.nhYn.qlFS,n.yLKo):n.APHb(r);else if(null!=i&&i._timeEnabled){if("session"!=(null==i?void 0:i._time.unit)){var g=T(i._time.unit,i._time.value);"didn't"==(null==i?void 0:i.MlBK)?(n.JQHh=!1,n.timerDidnt=setTimeout((function(){n.JQHh||(n.acHb=!0,n.acHb&&(n.QyhA+=1,n.acHb=n.Yyah(n.QyhA,n.TFNm.ODMj,n.TFNm.GCXI),n.acHb&&(n.TFNm.VYYC=Date.now(),a.validate(n.BeKI,n.GnfW)))),"specific_event"===r&&a.unregisterFromEvent(y(n.TFNm.ULQC)+"___"+n.TFNm.nhYn.qlFS,n.iquQ),n.VXMj=!1}),g),"specific_event"===r?(a.registerForEvent(y(n.TFNm.ULQC)+"___"+n.TFNm.nhYn.qlFS,n.iquQ),n.ncIf=n.TFNm):n.SiVA()):"did"==(null==i?void 0:i.MlBK)&&(console.log("did condition"),n.timerDid=setTimeout((function(){n.kkKa||"specific_event"===r&&a.unregisterFromEvent(y(n.TFNm.ULQC)+"___"+n.TFNm.nhYn.qlFS,n.gUqX)}),g),"specific_event"===r&&a.registerForEvent(y(n.TFNm.ULQC)+"___"+n.TFNm.nhYn.qlFS,n.gUqX))}}else"specific_event"===r&&a.registerForEvent(y(i.ULQC)+"___"+o.nhYn.qlFS,n.yLKo);null!==(e=window.ApxorRTM)&&void 0!==e&&e.badgesLists.includes(n.BeKI)&&(console.log("on receive event3"),a.registerForEvent(y(i.ULQC)+"___"+"apxor-badge-container-".concat("-".concat(n.BeKI).replaceAll(" ","").replace(/[^\w\s]/gi,"")),n.yLKo))})),s(this,"APHb",(function(e){var t=new ve;"apxor_event"===e?t.registerForEvent("apxor_event",(function(e,t,i,r){n.yLKo(y(n.TFNm.ULQC),n.TFNm.nhYn.qlFS,i,n.TFNm.nhYn.ZCve)})):"customer_event"===e?t.registerForEvent("customer_event",(function(e,t,i,r){n.yLKo(y(n.TFNm.ULQC),n.TFNm.nhYn.qlFS,i,n.TFNm.nhYn.ZCve)})):"any_event"===e?t.registerForEvent("any_event",(function(e,t,i,r){n.yLKo(y(n.TFNm.ULQC),n.TFNm.nhYn.qlFS,i,n.TFNm.nhYn.ZCve)})):"campaign_event"===e?t.registerForEvent("campaign_event",(function(e,t,i,r){n.yLKo(y(n.TFNm.ULQC),n.TFNm.nhYn.qlFS,i,n.TFNm.nhYn.ZCve)})):"survey_event"===e&&t.registerForEvent("survey_event",(function(e,t,i,r){n.yLKo(y(n.TFNm.ULQC),n.TFNm.nhYn.qlFS,i,n.TFNm.nhYn.ZCve)}))})),s(this,"pVce",(function(e){console.log("in new BSyW");var t=new ve,i=n.TFNm._eventCategory;"apxor_event"===i?t.unregisterFromEvent("apxor_event",n.iquQ):"customer_event"===i?t.unregisterFromEvent("customer_event",n.iquQ):"any_event"===i?t.unregisterFromEvent("any_event",n.iquQ):"campaign_event"===i?t.unregisterFromEvent("campaign_event",n.iquQ):"survey_event"===i&&t.unregisterFromEvent("survey_event",n.iquQ)})),s(this,"SiVA",(function(){console.log("in new BSyW");var e=new ve,t=n.TFNm._eventCategory;"apxor_event"===t?e.registerForEvent("apxor_event",n.iquQ):"customer_event"===t?e.registerForEvent("customer_event",n.iquQ):"any_event"===t?e.registerForEvent("any_event",n.iquQ):"campaign_event"===t?e.registerForEvent("campaign_event",n.iquQ):"survey_event"===t&&e.registerForEvent("survey_event",n.iquQ)})),s(this,"tRPQ",(function(){var e=new ve,t=n.TFNm._eventCategory;"apxor_event"===t?e.registerForEvent("apxor_event",n.gUqX):"customer_event"===t?e.registerForEvent("customer_event",n.gUqX):"any_event"===t?e.registerForEvent("any_event",n.gUqX):"campaign_event"===t?e.registerForEvent("campaign_event",n.gUqX):"survey_event"===t&&e.registerForEvent("survey_event",n.gUqX)})),s(this,"cWfj",(function(){var e=new ve,t=n.TFNm._eventCategory;"apxor_event"===t?e.unregisterFromEvent("apxor_event",n.gUqX):"customer_event"===t?e.unregisterFromEvent("customer_event",n.gUqX):"any_event"===t?e.unregisterFromEvent("any_event",n.gUqX):"campaign_event"===t?e.unregisterFromEvent("campaign_event",n.gUqX):"survey_event"===t&&e.unregisterFromEvent("survey_event",n.gUqX)})),s(this,"KpDk",(function(){var e=n.GjJi,t=ve.getInstance();n.VXMj=!0,t.registerForEvent(y(e.ULQC)+"___"+e.nhYn.qlFS,n.WLbV)})),s(this,"IAJQ",(function(e,t,i,r){var o,a=(Date.now()-n.CXCt[t])/1e3;(null===(o=n.TFNm)||void 0===o||null===(o=o.nhYn)||void 0===o||null===(o=o.ZCve)||void 0===o?void 0:o.time)/1e3>a&&n._displayCampaign(i)})),s(this,"PYOW",(function(e,t,i,r){var o,a;n.JQHh=!0;var s=Date.now(),l=null===(o=n.TFNm)||void 0===o||null===(o=o.IQAs)||void 0===o?void 0:o.nhYn.qlFS,u=(s-n.CXCt[l])/1e3,v=null===(a=n.TFNm)||void 0===a||null===(a=a.nhYn)||void 0===a||null===(a=a.ZCve)||void 0===a?void 0:a.time;(v/=1e3)>u&&n._displayCampaign(i)})),s(this,"gUqX",(function(){n.kkKa=!0,console.log("configitem kpi check2");var e=new ve;clearTimeout(n.timerDid),n.QyhA+=1,n.acHb=n.Yyah(n.QyhA,n.TFNm.ODMj,n.TFNm.GCXI),n.acHb&&(e.unregisterFromEvent(y(n.DhBw.ULQC)+"___"+n.DhBw.nhYn.qlFS,n.gUqX),e.validate(n.BeKI,n.GnfW,n.jVat))})),s(this,"iquQ",(function(e,t,i,r){n.JQHh=!0,clearTimeout(n.timerDidnt),console.log("received event for nkpi"),(new ve).unregisterFromEvent(y(n.ncIf.ULQC)+"___"+n.ncIf.nhYn.qlFS,n.iquQ)})),s(this,"yLKo",(function(t,i,r,o){var a,s;console.log("in onreceive event"),console.log("across session value is ",n.across_sessions);var l=ve.getInstance();if(n.VXMj){if(null!==(a=window.ApxorRTM)&&void 0!==a&&a.isBadgePresent&&null!==(s=window.ApxorRTM)&&void 0!==s&&s.badgesLists.includes(n.BeKI)&&e.getController().isBadgeTriggerSatisfied(n.BeKI))return n.acHb=!0,n.TFNm.VYYC=r,void l.validate(n.BeKI,n.GnfW);if(y(n.TFNm.ULQC)===t&&n.leUV(r-n.TFNm.IQAs.VYYC,n.TFNm.QkGS)&&n.TFNm.nhYn.qlFS===i&&n.rPEX(n.TFNm.nhYn.ZCve,o)&&(console.log("increasing satisfaction count for",n.TFNm.nhYn.qlFS),n.QyhA+=1,n.acHb=n.Yyah(n.QyhA,n.TFNm.ODMj,n.TFNm.GCXI),n.acHb)){if(n.TFNm.VYYC=r,n.across_sessions){var u=T(n.TFNm._time.unit,n.TFNm._time.value),v=n.TFNm._timeEnabled,c=n.TFNm._id,d=n.QyhA;n.aagZ(n.TFNm.MlBK,i,r,o,u,v,c,d)}l.validate(n.BeKI,n.GnfW,n.jVat)}}else if(n.VXMj=n.TgVW(t,i,r,o),n.VXMj){var h=n.TFNm,g=h.IQAs;if(g.VYYC=r,"activity_time"===(null==h?void 0:h.ULQC)){var f,_,m,p,S=null==h||null===(f=h.nhYn)||void 0===f||null===(f=f.ZCve)||void 0===f?void 0:f.time;(null==h||null===(_=h.tMYp)||void 0===_?void 0:_.length)>0?setTimeout((function(){var t;(null===(t=e.getController())||void 0===t?void 0:t._appEventsNoKpi).length<=2&&h.tMYp===location.pathname&&n._displayCampaign(r)}),S):(null==h||null===(m=h.nhYn)||void 0===m||null===(m=m.ZCve)||void 0===m?void 0:m.nkpi.length)>0?(setTimeout((function(){n.JQHh||(n.acHb=!0,n.acHb&&(n.QyhA+=1,n.acHb=n.Yyah(n.QyhA,n.TFNm.ODMj,n.TFNm.GCXI),n.acHb&&(n.TFNm.VYYC=r,l.validate(n.BeKI,n.GnfW)))),h.nhYn.ZCve.nkpi.map((function(e){l.unregisterFromEvent(F(h.nhYn.ZCve.et)+"___"+e,n),n.VXMj=!1}))}),S),h.nhYn.ZCve.nkpi.map((function(e){l.registerForEvent(F(h.nhYn.ZCve.et)+"___"+e,n.iquQ)}))):(null==h||null===(p=h.nhYn)||void 0===p||null===(p=p.ZCve)||void 0===p?void 0:p.kpi.length)>0&&(setTimeout((function(){h.nhYn.ZCve.kpi.map((function(e){l.unregisterFromEvent(F(h.nhYn.ZCve.et)+"___"+e,n)}))}),S),h.nhYn.ZCve.kpi.map((function(e){e===h.IQAs.nhYn.qlFS?(l.unregisterFromEvent(y(g.ULQC)+"___"+g.nhYn.qlFS,n),l.registerForEvent(F(h.nhYn.ZCve.et)+"___"+e,n.IAJQ)):l.registerForEvent(F(h.nhYn.ZCve.et)+"___"+e,n.PYOW)})))}else l.unregisterFromEvent(y(g.ULQC)+"___"+g.nhYn.qlFS,n),l.registerForEvent(y(h.ULQC)+"___"+h.nhYn.qlFS,n);n.CXCt[i]=Date.now()}})),s(this,"WLbV",(function(e,t,i,r){var o=ve.getInstance();y(n.GjJi.ULQC)===e&&n.leUV(i,n.GjJi.QkGS)&&n.GjJi.nhYn.qlFS===t&&n.rPEX(n.GjJi.nhYn.ZCve,r)&&(console.log("increasing satisfaction count for termination",n.TFNm.nhYn.qlFS),n.QyhA+=1,n.acHb=n.Yyah(n.QyhA,n.GjJi.ODMj,n.GjJi.GCXI),n.acHb&&(n.GjJi.VYYC=i,o.validateForTermination(n.BeKI,n.GnfW)))})),s(this,"TgVW",(function(e,t,i,r){var o=n.TFNm.IQAs,a=y(o.ULQC)===e&&o.nhYn.qlFS===t&&n.leUV(i,o.QkGS)&&n.rPEX(o.nhYn.ZCve,r);return a="APX_PAGE_OPENED"===t?a&&location.pathname===o.nhYn.nOHK:a})),s(this,"leUV",(function(e,t){var n=Math.ceil(e);return n>t.metp&&n<t.ILFC})),s(this,"Yyah",(function(e,t,i){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];switch(r&&n.TFNm.xrup&&(e+=n.UBzm),i){case"EQ":return e===t;case"GT":return e>t;case"GTE":return e>=t;case"LT":return e<t;case"LTE":return e<=t;default:return!1}})),s(this,"rPEX",(function(e,t){var n=!0;try{var r,o=function(){if(!1===n)return{v:!1};if("object"===i(e[a])){var r,o,s,l=e[a].op,u=e[a].t;if("s"===u)s=e[a].val;else if("l"===u||"f"===u)s=parseFloat(e[a].val);else if("b"===u)switch(e[a].val){case"true":s=!0;break;case"false":s=!1;break;default:s=e[a].val}var v,c=(Array.isArray(t[a])?t[a]:[t[a]]).some((function(e){return"s"===u?e="".concat(e):"l"===u?e=parseInt(e):"f"===u?e=parseFloat(e):"b"===u&&(e=!!e),S(e,s,l)}));if(!(null===(r=e[a])||void 0===r||!r.present)&&(null===(o=e[a])||void 0===o?void 0:o.present))v=!!t.hasOwn(t,a),n=n&&v;n=n&&c}else n=n&&S(t[a],e[a],"EQ")};for(var a in e)if(r=o())return r.v}catch(e){j.error(e),n=!1}return n})),s(this,"aagZ",(function(t,i,r,o,a,s,l,u){console.log("persisting satisfied conditions");var v,c=!1;n.no_KPI_TriggerDetails=e.getController().getFromStorage("apx_nokpi_triggerdetails"),null===n.no_KPI_TriggerDetails||void 0===n.no_KPI_TriggerDetails?n.no_KPI_TriggerDetails=[]:n.no_KPI_TriggerDetails=JSON.parse(n.no_KPI_TriggerDetails);var d,h=0;s&&(h=Date.now()+a);for(var g=0;g<n.no_KPI_TriggerDetails.length;g++)if(n.no_KPI_TriggerDetails[g].id===l){c=!0,v=n.no_KPI_TriggerDetails[g];break}c?v.satisfiedCount+=1:(d={id:l,type:t,time:r,name:i,additionalInfo:o,satisfiedCount:u,timeBased:s,finishTime:h},n.no_KPI_TriggerDetails.push(d)),e.getController().persistToStorage("apx_nokpi_triggerdetails",JSON.stringify(n.no_KPI_TriggerDetails))})),s(this,"HjEQ",(function(e){console.log("unregister all conditions");var t,i=new ve,r=c(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(1===(null==o?void 0:o.length)||void 0===(null==o?void 0:o.length))i.unregisterFromEvent(y(null==o?void 0:o.TFNm.ULQC)+"___"+(null==o?void 0:o.TFNm.nhYn.qlFS),n.yLKo);else{var a,s=c(o);try{for(s.s();!(a=s.n()).done;){var l,u=a.value;i.unregisterFromEvent(y(null==u?void 0:u.TFNm.ULQC)+"___"+(null==u||null===(l=u.TFNm)||void 0===l?void 0:l.nhYn.qlFS),n.yLKo)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){r.e(e)}finally{r.f()}}))}return a(t,[{key:"_displayCampaign",value:function(e){console.log("in display campaign");var t=ve.getInstance();this.acHb=!0,this.acHb&&(this.QyhA+=1,this.acHb=this.Yyah(this.QyhA,this.TFNm.ODMj,this.TFNm.GCXI),this.acHb&&(this.TFNm.VYYC=e,t.validate(this.BeKI,this.GnfW)))}}]),t}(),U=window.ApxorLogger,V=a((function t(){var n=this;r(this,t),s(this,"ODMj",0),s(this,"ENYK",0),s(this,"LJTe","SESSION"),s(this,"bnzV",0),s(this,"GLgO",0),s(this,"iccS",0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{n.BeKI=e._id,n.vWdp=e.meta,n.ODMj=e.frequency.count,-1===n.ODMj&&(n.ODMj=1e3),n.iccS=n.ODMj,n.ENYK=e.frequency.time_interval,n.LJTe=e.frequency.validity,n.GLgO=e.frequency.ses_lmt,n._dayCount=e.frequency.day_lmt;var t=ve.getInstance().getQeState();if(!f(t)||!f(t[e._id]))return!0;if("SESSION"===n.LJTe){if(n.ODMj=parseInt(n.ODMj)-parseInt(t[e._id].SESSION),n.ODMj<=0)return n.HDNO("Session limit reached"),console.warn("Max count limit reached for session:"+e._id),!1}else{if("OVERALL"!==n.LJTe)return U.info("Invalid config."),!1;if(n.ODMj=parseInt(n.ODMj)-parseInt(t[e._id].OVERALL),n.ODMj<=0)return n.HDNO("Overall limit reached"),console.warn("Max count limit reached for overall:"+e._id),!1}}catch(e){return U.error(e),!1}return!0})),s(this,"cuGd",(function(){n.ODMj=n.ODMj-1})),s(this,"getFrequencyCount",(function(){return n.ODMj})),s(this,"axUA",(function(){"SESSION"===n.LJTe&&(n.ODMj=n.iccS,U.info("Campaign Limit reset"))})),s(this,"dPlE",(function(e){try{if(n.ODMj<=0)return"OVERALL"===n.LJTe?n.HDNO("Overall limit reached"):"SESSION"===n.LJTe&&n.HDNO("Session limit reached"),!1;var t=ve.getInstance().getQeState();if(!f(t)||!f(t[e]))return!0;if(0!==n.GLgO)if(parseInt(n.GLgO)-parseInt(t[e].SESSION)<=0)return n.HDNO("Session limit reached"),!1;if(0!==n._dayCount){var i,r=E();if(parseInt(n._dayCount)-parseInt((null===(i=t[e])||void 0===i?void 0:i.DATES[r])||0)<=0)return n.HDNO("Day limit reached"),!1}}catch(e){n.HDNO("Error validating the frequency: ".concat(e)),U.error("Error validating the frequency:"+e)}return!0})),s(this,"HDNO",(function(t){var i;null==e||e.logEvent("apx_non_eligible_user",{apx_nudge_type:"SURVEY"===n.vWdp.type?"survey":"campaign",apx_nudge_id:n.BeKI,apx_nudge_name:n.vWdp.name,apx_variant_code:n.vWdp.isExperiment||n.vWdp.only_context?null===(i=n.vWdp.attr)||void 0===i?void 0:i.apx_variant_code:"TG",apx_failure_type:"warn",apx_reason:t})}))})),G=window.ApxorLogger,P=a((function e(){var t=this;r(this,e),s(this,"ptcN",[]),s(this,"Buvo",0),s(this,"pBsI",!1),s(this,"rTvi",void 0),s(this,"initialize",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unordered",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];t.BeKI=n,t.GnfW=i,t.xbwz=o,t.guGz=r,t.across_sessions=s;var l=[];t.Buvo=e.length;try{if(null!=l)return r=null==e?void 0:e.sequence_type,l=t.tqId(e,t.Buvo),"unordered"!==a&&0!==t.GnfW||t.BSyW(),t.ptcN}catch(e){return G.error(e),!1}})),s(this,"tqId",(function(e,n){for(var i=0;i<n;i++){t.rTvi=new k;try{t.rTvi.initialize(e[i],t.BeKI,t.GnfW,t.guGz,t.fUOK,t.across_sessions,"",-1,!1)&&(t.ptcN.push(t.rTvi),t.ptcN.sequence_type=t.guGz)}catch(e){G.error(e)}}return t.ptcN})),s(this,"BSyW",(function(){if("ordered"===t.guGz||"strictly_ordered"===t.guGz)t.ptcN[0].BSyW(0);else{var e,n=c(t.ptcN);try{for(n.s();!(e=n.n()).done;){e.value.BSyW()}}catch(e){n.e(e)}finally{n.f()}}})),s(this,"HjEQ",(function(e){console.log("unregister all conditions group"),t.rTvi.HjEQ(e)}))})),R=a((function e(){var t=this;r(this,e),s(this,"qlFS",""),s(this,"MlBK",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n,i;t.qlFS=e.meta.name,t.MlBK=e.meta.type,t._only_context=e.meta.only_context,t._attr=(null===(n=e.meta)||void 0===n?void 0:n.attr)||{},t._isExperiment=null===(i=e.meta)||void 0===i?void 0:i.isExperiment}catch(e){return window.ApxorLogger.error(e),!1}return!0}))})),X=window.ApxorLogger,z=a((function t(){var n=this;r(this,t),s(this,"PeaS",[]),s(this,"_ret_day",{}),s(this,"akaw",{}),s(this,"zmiw",!1),s(this,"JtOw",!1),s(this,"retainedDaysValidated",!0),s(this,"retainedSessionValidated",!0),s(this,"eventDoneInLT",!1),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{n.PeaS=e.overall_cfg.events,n._ret_day=e.overall_cfg.ret_day,n.akaw=e.overall_cfg.session,n.zmiw=e.overall_cfg.toggleRetDay,n.JtOw=e.overall_cfg.toggleSession}catch(e){return X.error(e),!1}return!0})),s(this,"validate",(function(){var t=parseInt(e.getController().getFromStorage("apx_retained_days")),i=parseInt(e.getController().getFromStorage("apx_retained_session"));if(n.zmiw&&!isNaN(t)&&!(t>=n._ret_day.from&&t<=n._ret_day.to))return n.retainedDaysValidated=!1,!1;if(n.JtOw&&!isNaN(i)&&!(i>=n.akaw.from&&i<=n.akaw.to))return n.retainedSessionValidated=!1,!1;try{for(var r=e.getController().getFromStorage("_apx_lt_count"),o=e.getSiteId(),a=JSON.parse((new TextDecoder).decode(function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return t}(p(o,r)))),s=0;s<n.PeaS.length;s++){if(a[n.PeaS[s].name.replace("'","").replace("â€™","")])return n.eventDoneInLT=!0,!1}}catch(e){X.error("Failed to validate the lt count:"+e)}return!0}))})),J=window.ApxorLogger,Z=a((function e(){var t=this;r(this,e),s(this,"HIcn",[]),s(this,"obYu",[]),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(t.HIcn=e.attributes.user,t.obYu=e.attributes.session,!Array.isArray(t.HIcn)||!Array.isArray(t.obYu))return J.error("No attributes"),!1}catch(e){return J.error(e),!1}return!0})),s(this,"validate",(function(e,n){return t.idGO(e,t.HIcn)&&t.idGO(n,t.obYu)})),s(this,"idGO",(function(e,t){var n=t.length,i=!0;try{for(var r,o=function(){var n=t[a];if(!e[n.name]||!1===i)return{v:!1};var r=n.operator,o=n.type,s=n.value.map((function(e){return"s"===o?e:"l"===o?parseInt(e):"f"===o?parseFloat(e):void 0})),l=(Array.isArray(e[n.name])?e[n.name]:[e[n.name]]).some((function(e){return s.some((function(t){return S(e,t,r)}))}));i=i&&l},a=0;a<n;a++)if(r=o())return r.v}catch(e){J.error(e),i=!1}return i}))})),$=a((function t(){var n=this;r(this,t),s(this,"YGRZ",e.getController()),s(this,"type",""),s(this,"_duration_seconds",0),s(this,"QYun",1),s(this,"parse",(function(e){try{var t,i,r;if(n.MlBK=null===(t=e.terminate_info.time_based)||void 0===t?void 0:t.type,n._duration_seconds=null===(i=e.terminate_info)||void 0===i?void 0:i.time_based.duration_seconds,n.QYun=null===(r=e.terminate_info.time_based)||void 0===r?void 0:r.days,n.tlPK(e._id))return n.YGRZ.persistTerminationInfoLocally(e._id),!1}catch(e){return!1}return!0})),s(this,"tlPK",(function(e){var t,i=JSON.parse(n.YGRZ.getFromStorage("apx_termination_ID"));if(!i[e]||null===(t=i[e])||void 0===t||!t.startDate)return!1;var r,o=new Date(i[e].startDate),a=new Date((r=new Date).getMonth()+"/"+r.getDate()+"/"+r.getFullYear()),s=parseInt((a-o)/864e5,10),l=function(){var e=new Date;return{hours:e.getHours(),mins:e.getMinutes()}}(),u=i[e].upMn;return s===n.QYun&&l.hours>=u.hours||s>n.QYun||i[e].goalAcheived}))})),ee=a((function e(){var t=this;r(this,e),s(this,"enable_goal_events",!1),s(this,"attributes",{}),s(this,"CwRY",new Z),s(this,"znkE",new $),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n,i,r;if(t.enable_time_based=null==e||null===(n=e.terminate_info)||void 0===n?void 0:n.enable_time_based,t.enable_time_based&&!t.znkE.parse(e))return!1;if(t.enable_goal_events=null==e||null===(i=e.terminate_info)||void 0===i?void 0:i.enable_goal_events,t.enable_attributes=null==e||null===(r=e.terminate_info)||void 0===r?void 0:r.enable_attributes,t.enable_attributes&&!t.CwRY.parse(e.terminate_info))return!1}catch(e){return window.ApxorLogger.error(e),!1}return!0})),s(this,"validate",(function(e,n){return t.CwRY.validate(e,n)}))})),te=window.ApxorLogger,ne=a((function e(){var t=this;r(this,e),s(this,"tXav",-1),s(this,"YTeX",-1),s(this,"upMn",-1),s(this,"Snnd",-1),s(this,"Arcy",!1),s(this,"_nudge_expired",!1),s(this,"_not_yet_active",!1),s(this,"_not_in_specified_time",!1),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(isNaN(Date.parse(e.validity.start_date))||isNaN(Date.parse(e.validity.end_date)))return te.error("Not valid dates"),!1;if(t.tXav=Date.parse(e.validity.start_date),t.YTeX=Date.parse(e.validity.end_date),f(e.at_specific_time)&&(t.Arcy=e.at_specific_time,t.Arcy&&f(e.time_limits))){var n=(new Date).toISOString().split("T")[0];if(t.upMn=Date.parse(n+"T"+e.time_limits.start_time+":00.000Z"),t.Snnd=Date.parse(n+"T"+e.time_limits.end_time+":00.000Z"),isNaN(t.upMn)||isNaN(t.Snnd))return te.error("Not valid times"),!1}}catch(e){return te.error(e),!1}return!0})),s(this,"validate",(function(){var e=Date.now();return e>t.tXav&&e<t.YTeX?(!t.Arcy||e>=t.upMn&&e<=t.Snnd||(t._not_in_specified_time=!0),!t.Arcy||e>=t.upMn&&e<=t.Snnd):(e<t.tXav?t._not_yet_active=!0:e>t.YTeX&&(t._nudge_expired=!0),!1)}))})),ie=a((function e(){var t=this;r(this,e),s(this,"xNmp",""),s(this,"FNSN",""),s(this,"EHhP",""),s(this,"VBMc",""),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return t.xNmp=null==e?void 0:e.screen_binding,!t.xNmp||(t.FNSN=null==e?void 0:e.binding.url,t.EHhP=null==e?void 0:e.binding.var,t.VBMc=null==e?void 0:e.binding.operator,!0)}catch(e){return window.ApxorLogger.error(e),!1}})),s(this,"validate",(function(){var e=t.FNSN,n=t.EHhP,i=t.VBMc,r=window.location.href;return!t.xNmp||("EQ"===i?e.includes(n)?!!L(r,e,n,!1):r===e:"SW"===i?e.includes(n)?!!L(r,e,n,!0):!!r.startsWith(e):void 0)}))})),re=window.ApxorLogger,oe=a((function t(){var i=this;r(this,t),s(this,"QSiL",[]),s(this,"qzOV",[]),s(this,"BeKI",""),s(this,"vWdp",new R),s(this,"yZRE",new A),s(this,"LJTe",new ne),s(this,"kmjt",new V),s(this,"ouJY",new z),s(this,"OSVc",new ee),s(this,"yYHQ",new ie),s(this,"guGz",!1),s(this,"fUOK",[]),s(this,"_variant_code",""),s(this,"pBsI",!1),s(this,"groupCombineOperator","OR"),s(this,"JQHh",!1),s(this,"KruR",!1),s(this,"FLeE",void 0),s(this,"timeForKPI",void 0),s(this,"kpiIndex",0),s(this,"cBEe",void 0),s(this,"_across_sessions",!1),s(this,"hsYf",void 0),s(this,"utLZ",!1),s(this,"TeVR",void 0),s(this,"CzWe",void 0),s(this,"TWIc",void 0),s(this,"Qpjh",void 0),s(this,"kKei",void 0),s(this,"mDBU",void 0),s(this,"EHqb",void 0),s(this,"pCXV",void 0),s(this,"xWbD",void 0),s(this,"Wbir",void 0),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t,n;if(!f(e._id))return re.error("No Id"),!1;if(!f(e.enabled)||!e.enabled)return re.error("Not enabled"),!1;if(!(i.vWdp.parse(e)&&i.LJTe.parse(e)&&i.kmjt.parse(e)&&i.yZRE.parse(e)&&i.ouJY.parse(e)&&i.OSVc.parse(e)&&i.yYHQ.parse(e)))return!1;if(i._variant_code=i.vWdp._isExperiment||i.vWdp._only_context?null===(t=i.vWdp._attr)||void 0===t?void 0:t.apx_variant_code:"TG",i._across_sessions=!(null==e||!e.across_sessions)&&(null==e?void 0:e.across_sessions),!f(e.conditions)||!Array.isArray(e.conditions))return re.error("No valid conditions",e.conditions),!1;i.BeKI=e._id,i.guGz=!!f(e.sequence_enabled)&&e.sequence_enabled,f(e.conditions_v2)&&(i.guGz=null==e?void 0:e.sequence_type),!0===i.guGz&&e.conditions.sort((function(e,t){return e.sequence<t.sequence})),f(e.conditions_v2)?(n=e.conditions_v2,i.utLZ=!0):n=e.conditions,i.hsYf=n;var r=n.length,o=null==e?void 0:e.no_context_enabled;if(0===r&&o&&setTimeout((function(){i.bRgM()}),10),i.Wbir=r,i.jzsK(n,r),console.log(i.QSiL),i.bIky(),console.log(i.QSiL),i.OSVc.enable_goal_events)for(var a=e.terminate_info.goal_events.events,s=a.length,l=0;l<s;l++){var u=new k;u.initialize(a[l],i.BeKI,l,!0,[],i._across_sessions,"termination")&&i.qzOV.push(u)}return console.log("conditional validator parse"),i.QSiL.length>0}catch(e){return re.error(e),!1}})),s(this,"jzsK",(function(e,t){for(var n=function(){i.fUOK=[];var t=e[r];if("group"===(null!=t&&t.condition_type?null==t?void 0:t.condition_type:"single")){var n=t.conditions_v2;i.groupCombineOperator=t.combine_operator;var o=null==t?void 0:t.sequence_type;i.xWbD=new P;var a=i.xWbD.initialize(n,i.BeKI,r,o,i.fUOK,i.guGz,i._across_sessions);i.QSiL.push(a),console.log(i.xWbD)}else{if("didn't"===t.type){var s,u={trigger_key:t.trigger.details.name,no_kpi_array:null==t||null===(s=t.details)||void 0===s||null===(s=s.additional_info)||void 0===s?void 0:s.nkpi,condition_id:null==t?void 0:t._id,time_bounds:t.time_bounds.upper};i.fUOK=[].concat(l(i.fUOK),[u])}if(i.xWbD=new k,i.xWbD.initialize(t,i.BeKI,r,i.guGz,i.fUOK,i._across_sessions)){i.QSiL.push(i.xWbD);var v=(null==t?void 0:t.timeout)/(null==t?void 0:t.findinterval),c=(null==t?void 0:t.frameid)||"",d=null==t?void 0:t.url;window.location.href===d&&"view_visibility"===t.event_type&&!0===Q(t.view_id,c,null==t?void 0:t.enable_retry,null==t?void 0:t.findinterval,v)&&i.bRgM(!0),window.addEventListener("navigate",(function(e){var n=null==t?void 0:t.url;window.location.href===n&&"view_visibility"===t.event_type&&!0===Q(t.view_id,c,null==t?void 0:t.enable_retry,null==t?void 0:t.findinterval,v)&&i.bRgM(!0)}))}}},r=0;r<t;r++)n()})),s(this,"bIky",(function(){if(i._across_sessions&&"ordered"===i.guGz){var t=!1;console.log("across_sesions_case");var n=e.getController().getFromStorage("apx_nokpi_triggerdetails");if(null!=(n=JSON.parse(n))&&null!=n)for(var r=function(e){var r,o,a;if(null!==(r=i.QSiL[e])&&void 0!==r&&null!==(r=r.TFNm)&&void 0!==r&&r._timeEnabled&&void 0===i.QSiL[e].length){if("didn't"===i.QSiL[e].TFNm.MlBK){var s=i.QSiL[e].TFNm._id,l=i.NCVy(s,n);if(l)if(Date.now()>l.finishTime)i.QSiL[e].acHb=!0,i.QSiL[e].QyhA=l.satisfiedCount,t=!0;else{var u=l.finishTime-Date.now(),v=i.QSiL[e].TFNm._eventCategory?i.QSiL[e].TFNm._eventCategory:"specific_event",c=new ve;"specific_event"===v?(c.registerForEvent(y(i.QSiL[e].TFNm.ULQC)+"___"+i.QSiL[e].TFNm.nhYn.qlFS,i.iquQ),i.kKei=i.QSiL[e]):i.SiVA(v),setTimeout((function(){e!==i.QSiL.length-1||i.JQHh||(i.QSiL[e].acHb=!0,i.QSiL[e].QyhA=l.satisfiedCount,t=!0,"specific_event"===v?c.unregisterFromEvent(y(i.QSiL[e].TFNm.ULQC)+"___"+i.QSiL[e].TFNm.nhYn.qlFS,i.iquQ):i.VjgE(i.QSiL[e]),i.bRgM())}),u)}}if("did"===i.QSiL[e].TFNm.MlBK){var d=i.QSiL[e].TFNm._id,h=i.NCVy(d,n);if(h)if(null==h.satisfiedCount){if(Date.now()<h.finishTime){console.log("time is left will add set time out again"),i.TWIc=h,i.CzWe=e;var g=h.finishTime-Date.now(),f=i.QSiL[e].TFNm._eventCategory?i.QSiL[e].TFNm._eventCategory:"specific_event",_=new ve;"specific_event"===f?_.registerForEvent(y(i.QSiL[e].TFNm.ULQC)+"___"+i.QSiL[e].TFNm.nhYn.qlFS,i.yvcJ):i.SiVA(f),setTimeout((function(){"specific_event"===f?_.unregisterFromEvent(y(i.QSiL[e].TFNm.ULQC)+"___"+i.QSiL[e].TFNm.nhYn.qlFS,i.yvcJ):i.VjgE(i.QSiL[e])}),g)}}else i.QSiL[e].QyhA=h.satisfiedCount,i.QSiL[e].acHb=!0}}else t=i.mpoS(e,n);t&&(null===(o=i.QSiL[e])||void 0===o||null===(o=o.TFNm)||void 0===o||!o._timeEnabled||(null===(a=i.QSiL[e])||void 0===a?void 0:a.length)>1)?e===i.QSiL.length-1&&i.bRgM():t||void 0===!i.QSiL[e].length&&i.QSiL[e].BSyW()},o=0;o<i.QSiL.length;o++)r(o)}else if(i._across_sessions&&"unordered"===i.guGz){var a=e.getController().getFromStorage("apx_nokpi_triggerdetails");if(null!=(a=JSON.parse(a))&&null!=a)for(var s=0;s<i.QSiL.length;s++)i.mpoS(s,a)}})),s(this,"mpoS",(function(e,t){if(void 0===i.QSiL[e].length||1===i.QSiL[e].length){var n=i.QSiL[e].TFNm._id,r=!1,o=i.NCVy(n,t);if(o)i.TeVR=o,r=(new k).Yyah(o.satisfiedCount,i.QSiL[e].TFNm.ODMj,i.QSiL[e].TFNm.GCXI),o&&(r?i.QSiL[e].acHb=!0:i.QSiL[e].QyhA=o.satisfiedCount);else i.QSiL[e].BSyW();return r}if(i.QSiL[e].length>=1){var a,s,l;if("ordered"===(s=null===(a=i.QSiL[e])||void 0===a?void 0:a.sequence_type)||"strictly_ordered"===s){for(var u=0;u<i.QSiL[e].length;u++){var v=i.QSiL[e][u],c=v.TFNm._id;l=!1;var d=i.NCVy(c,t);if(d){if(l=(new k).Yyah(d.satisfiedCount,v.TFNm.ODMj,v.TFNm.GCXI),d)if(l){i.QSiL[e][u].acHb=!0;var h=u+1;console.log("nested and then");var _=i.QSiL[e][u+1];void 0===_&&f(i.QSiL[e+1])&&(i.QSiL[e+1].BSyW(),l=!0),null!=_&&i.QSiL[e][u+1].BSyW(h)}else i.QSiL[e][u].QyhA=d.satisfiedCount}else(f(i.QSiL[e][u-1])&&!0===i.QSiL[e][u].acHb||g(i.QSiL[e][u-1]))&&i.QSiL[e][u].BSyW()}return l}for(var m,p=0;p<i.QSiL[e].length;p++){var y=i.QSiL[e][0].TFNm.mhaL;m="OR"!==y;var F=i.QSiL[e][p],S=F.TFNm._id;l=!1;var T=i.NCVy(S,t);if(T)l=(new k).Yyah(T.satisfiedCount,F.TFNm.ODMj,F.TFNm.GCXI),T&&(l?i.QSiL[e][p].acHb=!0:i.QSiL[e][p].QyhA=T.satisfiedCount);else F.BSyW();m="AND"===y?m&&l:m||l}return m}})),s(this,"NCVy",(function(e,t){return t.find((function(t){return t.id===e}))})),s(this,"TkUE",(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;console.log("coming to TkUE");var r=ve.getInstance();if(!(t<0)){var o=i.QSiL[t],a="unordered";if((null==o?void 0:o.length)>1&&(a=null==o?void 0:o.sequence_type),!0===i.guGz||"ordered"===i.guGz||"strictly_ordered"===i.guGz||"ordered"===a||"strictly_ordered"===a){console.log("respect sequence ordered"),i.kpiIndex=t+1;var s=i.QSiL[t];if((null==s?void 0:s.length)>0){if(f(s))if("unordered"===i.guGz&&"ordered"===a){var l=o[n-1];if(f(l))if(void 0===l.length||1==l.length){if(!l.acHb)return}else if(l.length>1&&!i.sLqk(l))return;var u,v=o[n+1];if(f(v)){if(v.BSyW(n+1),"strictly_ordered"===i.guGz){i._currentEventname=s[n].TFNm.nhYn.qlFS;var d=e.getController();d.registerForEvent("APP_EVENT",i.owED),d.registerForEvent("CLIENT_EVENT",i.owED)}}else if("strictly_ordered"===a)1!=i.pBsI&&i.bRgM();else(null===(u=o[n])||void 0===u?void 0:u.length)>0?i.sLqk(o)&&i.bRgM():i.bRgM()}else{var h,g=i.QSiL[t-1];if(f(g))if(void 0===g.length||1==g.length){if(!g.acHb)return}else if(g.length>1&&!i.sLqk(g))return;if(void 0===s.length||1===s.length?h=i.QSiL[t+1]:s.length>1&&("ordered"===a||"strictly_ordered"===a?h=n===s.length-1?i.QSiL[t+1]:i.QSiL[t][n+1]:i.sLqk(s)&&(h=i.QSiL[t+1])),f(h)){if(void 0===h.length||1===h.length)h.BSyW(n+1);else if(i.sLqk(s))if(void 0===h.length)h.BSyW();else if(h.length>1)if("unordered"===h.sequence_type)for(var _=0;_<h.length;_++)h[_].BSyW(_);else"ordered"!==h.sequence_type&&"strictly_ordered"!==h.sequence_type||h[0].BSyW(0);if("strictly_ordered"===i.guGz){i._currentEventname=s[n].TFNm.nhYn.qlFS;var m=e.getController();m.registerForEvent("APP_EVENT",i.owED),m.registerForEvent("CLIENT_EVENT",i.owED)}}else"strictly_ordered"===i.guGz?1!=i.pBsI&&i.bRgM():i.sLqk(s)&&i.bRgM()}}else if(f(s)&&s.acHb){s.CXCt[s.TFNm.nhYn.qlFS]=Date.now();var p=i.QSiL[t-1];if(f(p))if(void 0===p.length||1==p.length){if(!p.acHb)return}else if(p.length>1&&!i.sLqk(p))return;var F=i.QSiL[t+1];if(f(F)){var S,N;if(null!=F&&null!==(S=F.TFNm)&&void 0!==S&&S._timeEnabled){if("session"!=(null===(N=F.TFNm)||void 0===N?void 0:N._time.unit)){var E,L,Q=T(F.TFNm._time.unit,F.TFNm._time.value);if("didn't"==(null===(E=F.TFNm)||void 0===E?void 0:E.MlBK)){if(i.EHqb=setTimeout((function(){if(!i.JQHh){if(F.acHb=!0,F.acHb){F.QyhA+=1;var e=new k;if(F.acHb=e.Yyah(F.QyhA,F.TFNm.ODMj,F.TFNm.GCXI),console.log("expected here"),F.acHb){F.TFNm.VYYC=Date.now();var n=t+1,o=i.QSiL[n+1];f(o)?(console.log("registering next condition"),o.BSyW()):i.bRgM()}}r.unregisterFromEvent(y(F.TFNm.ULQC)+"___"+F.TFNm.nhYn.qlFS,i.iquQ),F.VXMj=!1}}),Q),console.log("expected here"),i._across_sessions){var b=T(F.TFNm._time.unit,F.TFNm._time.value),C=F.TFNm._timeEnabled,w=F.TFNm._id,I=new k;I.aagZ(F.TFNm.MlBK,F.TFNm.nhYn.qlFS,Date.now(),F.TFNm.nhYn.ZCve,b,C,w)}console.log(F.TFNm._timeEnabled),"specific_event"===F.TFNm._eventCategory?(r.registerForEvent(y(F.TFNm.ULQC)+"___"+F.TFNm.nhYn.qlFS,i.iquQ),i.kKei=F):i.SiVA(F)}else if("did"==(null===(L=F.TFNm)||void 0===L?void 0:L.MlBK)&&(i.JQHh=!1,i.cBEe=F,f(i.QSiL[t+2])&&i._across_sessions&&(i.Qpjh=i.QSiL[t+2]),i.pCXV=setTimeout((function(){i.JQHh||(i.JQHh=!1,r.unregisterFromEvent(y(F.TFNm.ULQC)+"___"+F.TFNm.nhYn.qlFS,i.PYOW))}),Q),i.FLeE=s,i.timeForKPI=Q,r.registerForEvent(y(F.TFNm.ULQC)+"___"+F.TFNm.nhYn.qlFS,i.PYOW),i.mDBU=F,console.log("error check"),i._across_sessions)){var O=T(F.TFNm._time.unit,F.TFNm._time.value),Y=F.TFNm._timeEnabled,x=F.TFNm._id,A=new k;A.aagZ(F.TFNm.MlBK,F.TFNm.nhYn.qlFS,Date.now(),F.TFNm.nhYn.ZCve,O,Y,x)}}}else if(F.length>0)if("ordered"===F.sequence_type||"strictly_ordered"===F.sequence_type)F[0].BSyW(n+1);else{var D,q=c(F);try{for(q.s();!(D=q.n()).done;){var B=D.value;B.BSyW()}}catch(e){q.e(e)}finally{q.f()}}else F.BSyW();if(console.log("validating second condition"),"strictly_ordered"===i.guGz){i._currentEventname=s.TFNm.nhYn.qlFS;var K=e.getController();K.registerForEvent("APP_EVENT",i.owED),K.registerForEvent("CLIENT_EVENT",i.owED)}}else"strictly_ordered"===i.guGz?1!=i.pBsI&&i.bRgM():i.bRgM()}}else i.emAl(),console.log(i.QSiL),i.bRgM()}})),s(this,"owED",(function(e){e&&e.name!=i._currentEventname&&(i.pBsI=!0)})),s(this,"SiVA",(function(e){var t=new ve,n=e.TFNm._eventCategory;"apxor_event"===n?t.registerForEvent("apxor_event",i.iquQ):"customer_event"===n?t.registerForEvent("customer_event",i.iquQ):"any_event"===n?t.registerForEvent("any_event",i.iquQ):"campaign_event"===n?t.registerForEvent("campaign_event",i.iquQ):"survey_event"===n&&t.registerForEvent("survey_event",i.iquQ)})),s(this,"VjgE",(function(e){var t=new ve,n=e.TFNm._eventCategory;"apxor_event"===n?t.unregisterFromEvent("apxor_event",i.iquQ):"customer_event"===n?t.unregisterFromEvent("customer_event",i.iquQ):"any_event"===n?t.unregisterFromEvent("any_event",i.iquQ):"campaign_event"===n?t.unregisterFromEvent("campaign_event",i.iquQ):"survey_event"===n&&t.unregisterFromEvent("survey_event",i.iquQ)})),s(this,"iquQ",(function(){var e,t;console.log("received event of nkpi"),i.EHqb&&clearTimeout(i.EHqb);var n=new ve;i.JQHh=!0,i._across_sessions&&null!==localStorage.getItem("apx_nokpi_triggerdetails")&&localStorage.removeItem("apx_nokpi_triggerdetails"),n.unregisterFromEvent(y(null===(e=i.kKei)||void 0===e||null===(e=e.TFNm)||void 0===e?void 0:e.ULQC)+"___"+(null===(t=i.kKei)||void 0===t||null===(t=t.TFNm)||void 0===t||null===(t=t.nhYn)||void 0===t?void 0:t.qlFS),i.iquQ)})),s(this,"PYOW",(function(){var t,n,r,o=new ve;console.log("configitem kpi check"),i.JQHh=!0,i.pCXV&&clearTimeout(i.pCXV);var a=new k;if(i.cBEe.QyhA+=1,i.cBEe.acHb=a.Yyah(i.cBEe.QyhA,i.cBEe.TFNm.ODMj,i.cBEe.TFNm.GCXI),o.unregisterFromEvent(y(null===(t=i.mDBU)||void 0===t||null===(t=t.TFNm)||void 0===t?void 0:t.ULQC)+"___"+(null===(n=i.mDBU)||void 0===n||null===(n=n.TFNm)||void 0===n?void 0:n.nhYn.qlFS),i.PYOW),i._across_sessions&&null!==(r=i.Qpjh)&&void 0!==r&&r.TFNm._timeBased){var s,l,u,v=e.getController().getFromStorage("apx_nokpi_triggerdetails");v=null==v?[]:JSON.parse(v);for(var c=0;c<v.length;c++)if(i.no_KPI_TriggerDetails[c].id===i.Qpjh.TFNm._id){s=!0,l=v[c];break}if(s)l.satisfiedCount+=1;else{var d=i.cBEe.TFNm._id,h=i.cBEe.TFNm.MlBK,g=i.cBEe.TFNm.nhYn.qlFS,_=i.cBEe.TFNm.nhYn.ZCve;u={id:d,type:h,time:Date.now(),name:g,additionalInfo:_,satisfiedCount:i.cBEe.TFNm._timeEnabled,timeBased:i.cBEe.TFNm._timeEnabled},i.no_KPI_TriggerDetails.push(u)}}if(i.cBEe.acHb){var m=i.QSiL[i.kpiIndex+1];f(m)?m.BSyW():i.bRgM()}})),s(this,"yvcJ",(function(){if(i.CzWe===i.QSiL.length-1){i.KruR=!0;i.QSiL[i.CzWe]&&(i.QSiL[i.CzWe].QyhA=i.TWIc.satisfiedCount,i.QSiL[i.CzWe].acHb=!0,i.bRgM())}else{var t,n,r=e.getController().getFromStorage("apx_nokpi_triggerdetails");r=null==r?[]:JSON.parse(r);for(var o=0;o<r.length;o++)if(r[o].id===i.CzWe){n=!0,t=r[o];break}if(n&&(t.satisfiedCount=1),e.getController().persistToStorage("apx_nokpi_triggerdetails",JSON.stringify(r)),i.QSiL[i.CzWe].QyhA=i.TWIc.satisfiedCount,i.QSiL[i.CzWe].acHb=!0,i.QSiL[i.CzWe+1].TFNm._timeEnabled){var a=T(i.QSiL[i.CzWe+1].TFNm._time.unit,i.QSiL[i.CzWe+1].TFNm._time.value),s=i.QSiL[i.CzWe+1].TFNm._timeEnabled,l=i.QSiL[i.CzWe+1].TFNm._id,u=i.QSiL[i.CzWe+1].QyhA,v=i.QSiL[i.CzWe+1].TFNm.nhYn.qlFS,c=i.QSiL[i.CzWe+1].nhYn.ZCve;(new k).aagZ(i.TFNm.MlBK,v,Date.now(),c,a,s,l,u)}}})),s(this,"emAl",(function(){if(i._across_sessions&&i.utLZ){var t,n,r,o="single",a=!1,s=e.getController().getFromStorage("apx_nokpi_triggerdetails");if(s=JSON.parse(s),console.log(s),s.length>0){var l,u=c(s);try{var v=function(){var e=l.value;console.log(e);var s=e.id,u=e.satisfiedCount;if(t=i.QSiL.find((function(e,t){if(1===(null==e?void 0:e.length)||void 0===(null==e?void 0:e.length)){if(e.TFNm._id===s)return o="single",n=t,!0}else if(e.length>0){var i=e.findIndex((function(e){return e.TFNm._id===s}));if(-1!==i)return console.log("Matching Condition Index:",t),n=t,console.log("Nested Condition Index:",i),r=i,o="group",!0}return!1})),"single"===o&&t){var v=new k;a=v.Yyah(u,t.TFNm.ODMj,t.TFNm.GCXI);var c=i.QSiL.findIndex((function(e){var t;return(null==e||null===(t=e.TFNm)||void 0===t?void 0:t._id)===s}));void 0===c&&(c=n),a&&(i.QSiL[c].acHb=!0)}else if("group"===o&&t){var d=new k;(a=d.Yyah(u,t[r].TFNm.ODMj,t[r].TFNm.GCXI))&&(i.QSiL[n][r].acHb=!0,console.log(i.QSiL))}};for(u.s();!(l=u.n()).done;)v()}catch(e){u.e(e)}finally{u.f()}}}})),s(this,"JYzr",(function(e){e<0||i.CLws()})),s(this,"bRgM",(function(){var t,r,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.getController().getUserAttributes(),s=e.getController().getSessionAttributes();if(null!==(t=window.ApxorRTM)&&void 0!==t&&t.isBadgePresent&&null!==(r=window.ApxorRTM)&&void 0!==r&&r.badgesLists.includes(i.BeKI)&&e.getController().isBadgeTriggerSatisfied(i.BeKI)||null==e||e.logEvent("apx_trigger_satisfied",{apx_nudge_type:"SURVEY"===i.vWdp.MlBK?"survey":"campaign",apx_nudge_id:i.BeKI,apx_nudge_name:i.vWdp.qlFS,apx_variant_code:i.vWdp._isExperiment||i.vWdp._only_context?i.vWdp._attr.apx_variant_code:"TG"}),!(i.LJTe.validate()&&i.yZRE.validate(a,s)&&i.ouJY.validate()&&i.yYHQ.validate())){i.vWdp.MlBK;return i.ouJY.retainedDaysValidated?i.ouJY.retainedSessionValidated?i.ouJY.eventDoneInLT?void i.HDNO("Event done in life time"):i.yZRE.userAttributesValidated?i.yZRE.sessionAttributeValidated?i.LJTe._not_in_specified_time?void i.HDNO("Time limits check failed"):i.LJTe._not_yet_active?void i.HDNO("not in the scheduled time"):i.LJTe._nudge_expired?void i.HDNO("nudge expired"):void 0:void i.HDNO("Session property filter not met"):void i.HDNO("User property filter not met"):void i.HDNO("User session criteria not met"):void i.HDNO("Retained day criteria not met")}var l=i.QSiL.length,u=l<1,v="";0===l&&(u=!0);for(var d=0;d<l;d++){var h=void 0,g=i.QSiL[d];if(g.length>1){var f=g[0].TFNm.mhaL;h="AND"===f;for(var _=0;_<g.length;_++){var m=g[0].TFNm.mhaL;h="AND"===m?h&&g[_].acHb:h||g[_].acHb}}else h=g.acHb;if(""===v.trim())u=h;else switch(v){case"AND":u=u&&h;break;case"OR":u=u||h}v=g.length>1?i.groupCombineOperator:g.mhaL}if(!0===o&&(u=!0),u){var p,y;if(console.debug("onCondition satisfied"),!i.kmjt.dPlE(i.BeKI)){if(console.warn("Maximum limit reached",i.BeKI),e.getController().isTestDevice()){Y("Maximum limit reached for campaign name ".concat(i.vWdp.qlFS));var F=document.getElementById("close-button"),S=function(){var e=document.getElementById("apx-container");null==e||e.remove()};null==F||F.addEventListener("click",S),window.setTimeout(S,2e4)}return}if(!(null!==(p=window.ApxorRTM)&&void 0!==p&&p.isBadgePresent&&null!==(y=window.ApxorRTM)&&void 0!==y&&y.badgesLists.includes(i.BeKI)&&e.getController().isBadgeTriggerSatisfied(i.BeKI))){var T="SURVEY"===i.vWdp.MlBK?"survey":"campaign";null==e||e.logEvent("apx_trigger_satisfied",{apx_nudge_type:"SURVEY"===i.vWdp.MlBK?"survey":"campaign",apx_nudge_id:i.BeKI,apx_nudge_name:i.vWdp.qlFS,apx_variant_code:i.vWdp._isExperiment||i.vWdp._only_context?i.vWdp._attr.apx_variant_code:"TG"},!1,"",T)}console.log("Dispatching event",i.vWdp.MlBK),i._across_sessions&&localStorage.removeItem("apx_nokpi_triggerdetails");var N,E=c(i.QSiL);try{for(E.s();!(N=E.n()).done;){var L=N.value;if(1===(null==L?void 0:L.length)||void 0===(null==L?void 0:L.length))L.acHb=!1,L.QyhA=0;else{var Q,b=c(L);try{for(b.s();!(Q=b.n()).done;){var C=Q.value;C.acHb=!1,C.QyhA=0}}catch(e){b.e(e)}finally{b.f()}}}}catch(e){E.e(e)}finally{E.f()}if(console.log("got cv well"),i.xWbD.HjEQ(i.QSiL),i.QSiL=[],i.jzsK(i.hsYf,i.Wbir),console.log(i.QSiL),!0===i.vWdp._only_context){var w="SURVEY"===i.vWdp.MlBK?"survey":"campaign";e.logEvent("apx_context_evaluated",n(n({},i.vWdp._attr),{},{message_name:i.vWdp.qlFS,id:i.BeKI}),!1,"",w)}e.getController().dispatchEvent(i.vWdp.MlBK,{name:i.vWdp.MlBK,additional_info:{uuid:i.BeKI,name:i.vWdp.qlFS}})}})),s(this,"CLws",(function(){for(var t=i.qzOV.length,r=t<1,o="",a=0;a<t;a++){var s=i.qzOV[a],l=s.acHb;if(""===o.trim())r=l;else switch(o){case"AND":r=r&&l;break;case"OR":r=r||l}o=s.dUev}if(r){if(console.log("Dispatching event",i.vWdp.MlBK),e.getController().persistTerminationInfoLocally(i.BeKI),!0===i.vWdp._only_context){var u="SURVEY"===i.vWdp.MlBK?"survey":"campaign";e.logEvent("apx_context_evaluated",n(n({},i.vWdp._attr),{},{message_name:i.vWdp.qlFS,id:i.BeKI}),!1,"apxor",u)}e.getController().dispatchEvent(i.vWdp.MlBK,{name:i.vWdp.MlBK,additional_info:{uuid:i.BeKI,name:i.vWdp.qlFS}})}})),s(this,"validateForTerminationAttributes",(function(){var t=e.getController().getUserAttributes(),n=e.getController().getSessionAttributes();return i.OSVc.validate(t,n)})),s(this,"cuGd",(function(){i.kmjt.cuGd()})),s(this,"getFrequencyCount",(function(){return i.kmjt.getFrequencyCount()})),s(this,"osQO",(function(){return i.kmjt.axUA()})),s(this,"sLqk",(function(e){var t;t="AND"===e[0].TFNm.mhaL;for(var n=0;n<e.length;n++){t="AND"===e[0].TFNm.mhaL?t&&e[n].acHb:t||e[n].acHb}return t})),s(this,"HDNO",(function(t){var n;null==e||e.logEvent("apx_non_eligible_user",{apx_nudge_type:"SURVEY"===i.vWdp.MlBK?"survey":"campaign",apx_nudge_id:i.BeKI,apx_nudge_name:i.vWdp.qlFS,apx_variant_code:i.vWdp._isExperiment||i.vWdp._only_context?null===(n=i.vWdp._attr)||void 0===n?void 0:n.apx_variant_code:"TG",apx_failure_type:"warn",apx_reason:t})}))})),ae=a((function e(){var t=this;r(this,e),s(this,"PtkT",{}),s(this,"parse",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{configs:[]};if(f(e)&&f(e.configs)){var n=e.configs;if(!Array.isArray(n))return;n.sort((function(e,t){var n,i;return(null!==(n=e.prio)&&void 0!==n?n:-1)-(null!==(i=t.prio)&&void 0!==i?i:-1)}));for(var i=0;i<n.length;i++){var r=n[i],o=r._id,a=new oe;a.parse(r)?t.PtkT[o]=a:console.warn("Failed to parse cfg",o)}}})),s(this,"validate",(function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t.PtkT[e]){var r=t.PtkT[e];r.TkUE(n,i)}})),s(this,"getVariantCode",(function(e){return t.PtkT[e]?t.PtkT[e]._variant_code:""})),s(this,"validateForTermination",(function(e,n){t.PtkT[e]&&t.PtkT[e].JYzr(n)})),s(this,"validateForTerminationAttributes",(function(e){return!!t.PtkT[e]&&t.PtkT[e].validateForTerminationAttributes()})),s(this,"cuGd",(function(e){t.PtkT[e].cuGd()})),s(this,"getFrequencyCount",(function(e){var n=t.PtkT[e];if(null!=n)return n.getFrequencyCount()})),s(this,"resetFrequencyCounts",(function(){var e=t.PtkT;for(var n in e)e[n].osQO()})),s(this,"aJkp",(function(e){try{if(t.PtkT){var n=t.PtkT[e];if(n&&n.vWdp)return n.vWdp}}catch(e){console.log("Error in getting the campaign meta ".concat(e))}return{}}))})),se=window.ApxorLogger,le=a((function t(){var n=this;r(this,t),s(this,"yRSh",{}),s(this,"fRRH",[]),s(this,"YXEy",!1),s(this,"initialize",(function(){var t=e.getController();t.registerForEvent("APP_EVENT",(function(e){return n.IAUX(e,"AE")})),t.registerForEvent("CLIENT_EVENT",(function(e){return n.IAUX(e,"CE")}))})),s(this,"ZTmF",(function(){for(var e in n.fRRH)n.eXGl(e.event,e.key,e.type);n.YXEy=!0})),s(this,"OSKI",(function(e,t){var i;(console.log("BSyW To Event"),"function"==typeof t)&&((i=n.yRSh[e]?n.yRSh[e]:[]).push(t),n.yRSh[e]=i,se.debug("Listeners list: ",n.yRSh))})),s(this,"unregisterFromEvent",(function(e,t){if(n.yRSh[e]){for(var i=n.yRSh[e],r=[],o=0;o<i.length;o++){var a=i[o];a!==t&&r.push(a)}n.yRSh[e]=r}})),s(this,"IAUX",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AE";n.eXGl(e,"any_event",t),"apxor"===(null==e?void 0:e.loggedBy)?(console.log("notifying apxor event listeners"),n.eXGl(e,"apxor_event",t)):"customer"===(null==e?void 0:e.loggedBy)&&n.eXGl(e,"customer_event",t),"campaign"===(null==e?void 0:e.apx_nudge_type)?n.eXGl(e,"campaign_event",t):"survey"===(null==e?void 0:e.apx_nudge_type)&&n.eXGl(e,"survey_event",t);var i=t+"___"+e.name;n.eXGl(e,i,t)})),s(this,"eXGl",(function(t,i,r){if(n.YXEy){if(se.debug("Notifying listeners for event: "+t+", "+i,n.yRSh),n.yRSh[i])for(var o=n.yRSh[i],a=e.getController().getSDKRunningTimeInSec(),s=0;s<o.length;s++){(0,o[s])(r,t.name,a,t.additional_info)}}else n.fRRH.push({event:t,key:i,type:r})}))})),ue=window.ApxorLogger,ve=function(){function t(){var n=this;return r(this,t),s(this,"jiVf",!1),s(this,"uUKr",null),s(this,"eFOv",E()),s(this,"wjCt",new le),s(this,"InlT",e.getSiteId()),s(this,"NOmf",{}),s(this,"getQeState",(function(){try{var t=e.getController().getFromStorage("qe_state");return t?JSON.parse(p(n.InlT,t)):(n.NOmf={},n.setQeState())}catch(e){return n.NOmf={},n.setQeState()}})),s(this,"setQeState",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{e.getController().persistToStorage("qe_state",n.NOmf,!0)}catch(i){""===t?n.NOmf={}:n.NOmf[t]={SESSION:0,OVERALL:0,DATES:{}},e.getController().persistToStorage("qe_state",n.NOmf,!0)}return n.NOmf})),s(this,"initialize",(function(){n.jiVf||(n.jiVf=!0,n.uUKr=new ae,n.wjCt.initialize(),n.NOmf=n.getQeState(),ue.info("QE Initialized.."))})),s(this,"parse",(function(e){n.BHZN()?(n.uUKr.parse(e),n.wjCt.ZTmF()):ue.warn("Must call init first. Unable to proceed")})),s(this,"validate",(function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;n.BHZN()&&n.uUKr.validate(e,t,i)})),s(this,"getVariantCode",(function(e){return n.uUKr.getVariantCode(e)})),s(this,"validateForTermination",(function(e,t){n.BHZN()&&n.uUKr.validateForTermination(e,t)})),s(this,"validateForTerminationAttributes",(function(e,t){return n.uUKr.validateForTerminationAttributes(e,t)})),s(this,"updateCount",(function(e){try{f(n.NOmf[e])||n.createObjConfig(e),n.incrementFrequencies(e),n.setQeState(e),n.uUKr.cuGd(e)}catch(e){console.log("Could not update the count config:".concat(e))}})),s(this,"resetFrequencyCounts",(function(){n.uUKr.resetFrequencyCounts()})),s(this,"getFrequencyCount",(function(e){return n.uUKr.getFrequencyCount(e)})),s(this,"registerForEvent",(function(e,t){console.log("registered event",e),n.wjCt.OSKI(e,t)})),s(this,"unregisterFromEvent",(function(e,t){console.log("in unregister"),n.wjCt.unregisterFromEvent(e,t)})),s(this,"notifyEventListener",(function(e){n.wjCt.IAUX(e)})),s(this,"fetch",(function(t,n,i,r){e.getController().fetchConfiguration(t,n,i,r)})),s(this,"BHZN",(function(){return n.jiVf})),s(this,"getCampaignMetaFromQueryEngine",(function(e){return n.uUKr.aJkp(e)})),s(this,"cEjo",(function(){return n.eFOv})),t.instance||(t.instance=this),t.instance}return a(t,[{key:"createObjConfig",value:function(e){try{this.NOmf=this.getQeState(),f(this.NOmf[e])||(this.NOmf[e]={SESSION:0,OVERALL:0,DATES:{}},this.eFOv&&(this.NOmf[e].DATES[this.eFOv]=0),this.setQeState(e))}catch(e){ue.error("Can not create the frequency count object:"+e)}}},{key:"incrementFrequencies",value:function(e){this.NOmf=this.getQeState();var t=this.NOmf[e];t.SESSION=t.SESSION+1,t.OVERALL=t.OVERALL+1;var n=E();n===this.eFOv&&t.DATES&&t.DATES[n]||(this.eFOv=n,t.DATES={},t.DATES[this.eFOv]=0),t.DATES[this.eFOv]=t.DATES[this.eFOv]+1}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}]),t}();s(ve,"instance",void 0),window.ceVersion=170;try{void 0===exports&&null===exports||(exports.default=ve,module.exports=exports.default)}catch(e){}return ve}));
